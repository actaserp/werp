<!DOCTYPE html>
<html lang="ko">

<head th:replace="layouts/XRegister/head :: headFragment" />
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>유지보수센터</title>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>

    
    <!-- <script> 
function chk(){ 
            var btn_obj = document.getElementById('menu01_btn');
            btn_obj.addEventListener("click",function(){  
                //TB_FPLAN_WORK TB_FPLAN_W010  SAVE    
                var ls_actuseridz   = document.getElementById('actuseridz').value; 
                var ls_actusernamez = document.getElementById('actusernamez').value;  
                var ls_actcltcdz = document.getElementById('actcltcdz').value;  
                var ls_actdbnmz = document.getElementById('actdbnmz').value;    
                var ls_actflagz = document.getElementById('actflagz').value;  
                var ls_uri = "actuseridz=" + ls_actuseridz +"&actusernamez=" + ls_actusernamez + "&actcltcdz=" + ls_actcltcdz + "&actdbnmz=" + ls_actdbnmz + "&actflagz=" + ls_actflagz;
                var win = window.open("/app01/ktcall?" + ls_uri, "_blank", "toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=500,width=400,height=400"); 
    
        }) 
       
  </script>       -->
     
</head>

<form class="row gy-2 gx-4 align-items-center" role="form" th:object="${userFormDto}" th:action="@{/appcom01/update}" method="post" enctype="multipart/form-data"></form>

<body style="background: #f5f9fa;">
<input type="hidden"  name="actuseridz" id="actuseridz" th:value="${userFormDto.userid}" >
<header>

</header>
<div class="content flex">
    <div class="header">
        <div class="left">
            <div class="ham">
                <button type="button"><img src="/images/ham.png" alt=""></button>
            </div>
            <div class="nav_bg"></div>
            <!-- ################################ -->
            <!-- ## Left navigator include -->
            <th:block th:include="layouts/APPHeader/appLeftNav" />
        </div>
        <div class="right">
        </div>
    </div>
    <div class="con">
        <div class="header_top">
            <ul class="left">
                <li>
                    <div class="logo">
                        <a th:href="@{/auth/emmsdashboard}">
                            <img src="/images/logo.png" alt="">
                        </a>
                    </div>
                </li>
                <li class="home on">
                    <a><img src="/images/i_home.png" alt=""></a>
                    <a><img src="/images/i_home_on.png" alt=""></a>
                </li>
                <li>
                    고객상담센터
                </li>
                <li>
                    고장접수관제현황
                </li>
            </ul>
            <ul class="mid">
                <li>
                    <i><img src="/images/i_circle1.png" alt=""></i>
                    <p>계약현장 <span>50</span></p>
                </li>
                <li>
                    <i><img src="/images/i_circle2.png" alt=""></i>
                    <p>계약관리대수 <span>50</span></p>
                </li>
                <li>
                    <i><img src="/images/i_circle3.png" alt=""></i>
                    <p>당월고장접수 <span>50</span></p>
                </li>
                <li>
                    <i><img src="/images/i_circle4.png" alt=""></i>
                    <p>금일고장접수 <span>50</span></p>
                </li>
            </ul>
            <ul class="right">
                <li>
                    <a href="">
                        <img src="/images/i_call.png" alt="">
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="/images/i_bell.png" alt="">
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="/images/i_menu.png" alt="">
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="/images/i_que.png" alt="">
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="/images/i_user.png" alt="">
                    </a>
                </li>
            </ul>
        </div>
        <div class="section section1">

            <div class="sec_con" style="width: 40%;">
                <div class="calender box_wrap">
                    <div class="cal_top">
                        <div class="pager">
                            <button type="button"><img src="/images/arrow_left.png" alt=""></button>
                            <p>2022.10</p>
                            <button type="button"><img src="/images/arrow_right.png" alt=""></button>
                        </div>
                        <div class="add_cal">
                            <button>+일정추가</button>
                        </div>
                    </div>
                    <div class="cal_bottom">
                        <div class="cal_table_box">
                            <table class="cal_table">
                                <tr>
                                    <th>Sun</th>
                                    <th>Mon</th>
                                    <th>Tue</th>
                                    <th>Wed</th>
                                    <th>Thu</th>
                                    <th>Fri</th>
                                    <th>Set</th>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><p>1</p></td>
                                </tr>
                                <tr>
                                    <td><p>2</p></td>
                                    <td><p>3</p></td>
                                    <td><p>4</p></td>
                                    <td><p>5</p></td>
                                    <td class="on"><!-- 클래스 on 활성화 -->
                                        <p>6</p>
                                        <div class="todo">
                                            <h5><i><img src="/images/i_dot.png" alt=""></i>10시 AM 일정</h5>
                                            <h5><i><img src="/images/i_dot.png" alt=""></i>3시 PM 일정</h5>
                                        </div>
                                    </td>
                                    <td><p>7</p></td>
                                    <td><p>8</p></td>
                                </tr>
                                <tr>
                                    <td><p>9</p></td>
                                    <td><p>10</p></td>
                                    <td><p>11</p></td>
                                    <td>
                                        <p>12</p>
                                        <div class="todo">
                                            <h5><i><img src="/images/i_dot.png" alt=""></i>10시 AM 일정</h5>
                                            <h5><i><img src="/images/i_dot.png" alt=""></i>3시 PM 일정</h5>
                                        </div>
                                    </td>
                                    <td><p>13</p></td>
                                    <td><p>14</p></td>
                                    <td><p>15</p></td>
                                </tr>
                                <tr>
                                    <td><p>16</p></td>
                                    <td><p>17</p></td>
                                    <td><p>18</p></td>
                                    <td><p>19</p></td>
                                    <td><p>20</p></td>
                                    <td><p>21</p></td>
                                    <td><p>22</p></td>
                                </tr>
                                <tr>
                                    <td><p>23</p></td>
                                    <td><p>24</p></td>
                                    <td><p>25</p></td>
                                    <td><p>26</p></td>
                                    <td><p>27</p></td>
                                    <td><p>28</p></td>
                                    <td><p>29</p></td>
                                </tr>
                                <tr>
                                    <td><p>30</p></td>
                                    <td><p>31</p></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                            </table>

                        </div>
                    </div>
                </div>

            </div>
            <div class="sec_con" style="width: 20%;">
                <div class="sec_con_tit">
                    <span>11.7일</span> 계약 기간 만료 현장
                </div>
                <div class="box_wrap with_tit">
                    <div id="wtab01Grid_div" ></div>
                    <div id="tab01Pager"></div>
                </div>
            </div>
            <div class="sec_con" style="width: 20%;">
                <div class="sec_con_tit">
                    <span>11.7일</span> 계약 기간 예정 현장
                </div>
                <div class="box_wrap with_tit">
                    <div id="wtab02Grid_div" ></div>
                    <div id="tab02Pager"></div>
                </div>
            </div>
            <div class="sec_con" style="width: 20%;">
                <div class="sec_con_tit">
                    금일 점검 직원
                </div>
                <div class="box_wrap with_tit">
                    <ul class="employee scrollbar" style="overflow-y: scroll; height: 360px;">
                        <li>
                            <div class="left">
                                <div class="user_icon" style="background: url(/images/user1.png) no-repeat center center;">
                                </div>
                                <div class="txt">
                                    <h5>홍길동</h5>
                                    <p>금천 자이 아파트</p>
                                </div>
                            </div>
                            <div class="state">
                                점검
                            </div>
                        </li>
                        <li>
                            <div class="left">
                                <div class="user_icon" style="background: url(/images/user2.png) no-repeat center center;">
                                </div>
                                <div class="txt">
                                    <h5>홍길동</h5>
                                    <p>금천 자이 아파트</p>
                                </div>
                            </div>
                            <div class="state">
                                결근
                            </div>
                        </li>
                        <li>
                            <div class="left">
                                <div class="user_icon" style="background: url(/images/user3.png) no-repeat center center;">
                                </div>
                                <div class="txt">
                                    <h5>홍길동</h5>
                                    <p>금천 자이 아파트</p>
                                </div>
                            </div>
                            <div class="state">
                                이동
                            </div>
                        </li>
                        <li>
                            <div class="left">
                                <div class="user_icon" style="background: url(/images/user4.png) no-repeat center center;">
                                </div>
                                <div class="txt">
                                    <h5>홍길동</h5>
                                    <p>금천 자이 아파트금천 자이 아파트</p>
                                </div>
                            </div>
                            <div class="state">
                                접수
                            </div>
                        </li>
                        <li>
                            <div class="left">
                                <div class="user_icon" style="background: url(/images/user5.png) no-repeat center center;">
                                </div>
                                <div class="txt">
                                    <h5>홍길동</h5>
                                    <p>금천 자이 아파트</p>
                                </div>
                            </div>
                            <div class="state">
                                완료
                            </div>
                        </li>
                    </ul>
                </div>
            </div>



        </div>
        <div class="section section2">
            <div class="sec_con" style="width: 33.3333%;">
                <div class="sec_con_tit">
                    <span>2022</span> 월별 신규계약 현황
                </div>
                <div class="box_wrap with_tit">
                    <div id="wtab03Grid_div" ></div>
                    <div id="tab03Pager"></div>
                </div>
            </div>
            <div class="sec_con" style="width: 33.3333%;">
                <div class="sec_con_tit">
                    <span>2022</span> 월별 관리대수 현황
                </div>
                <div class="box_wrap with_tit">
                    <div id="wtab04Grid_div" ></div>
                    <div id="tab04Pager"></div>
                </div>
            </div>
            <div class="sec_con" style="width: 33.3333%;">
                <div class="sec_con_tit">
                    <span>직전 1개월</span> 고장 다발 현장
                </div>
                <div class="box_wrap with_tit">
                    <div id="wtab05Grid_div" ></div>
                    <div id="tab05Pager"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- modal -->
<!-- class="modal_step_open" modal_step="1" -->

<div class="modal modal modal_step modal_step1 hidden">
    <div class="modal_overlay">
    </div>
    <div class="modal_content modal_sm scrollbar">
        <div class="layoutCont">
            <div class="modalContWrap">
                <!-- <div class="modal_close cancerButton">
                  <img src="/images/modal_close.png" alt="모달 닫기버튼">
                </div>                       -->
                <div class="modal_head">
                </div>
                <div class="modal_con scrollbar">
                    모든 정보를 입력하세요.
                </div>

            </div>
            <div class="modal_btn">
                <button class="cancerButton " type="button">확인</button>
            </div>
            <!-- <div class="modal_btn flex">
                <button class="cancerButton " type="button">확인</button>
                <button class="cancerButton " type="button">확인</button>
            </div> -->
        </div>
    </div>
</div>

</body>
</form>
<script>
        function menu01_btn(){ 
                    var ls_actuseridz   =  jQuery('#actuseridz').val(); //document.getElementById('actuseridz').value; 
                    var ls_actusernamez =  jQuery('#actusernamez').val(); //document.getElementById('actusernamez').value;  
                    var ls_actcltcdz =   jQuery('#actcltcdz').val();  //document.getElementById('actcltcdz').value;  
                    ls_actcltcdz =    ls_actcltcdz + "";
                    var ls_actdbnmz =  jQuery('#actdbnmz').val();   //document.getElementById('actdbnmz').value;    
                    var ls_actflagz =  jQuery('#actflagz').val();   //document.getElementById('actflagz').value;  
                    var ls_actcalluseridz =  jQuery('#actcalluseridz').val();   
                    var ls_actcalluserpwz =  jQuery('#actcalluserpwz').val();   

                    var ls_uri          = "actuseridz=" + ls_actuseridz +"&actusernamez=" + ls_actusernamez + "&actcltcdz=" + ls_actcltcdz ;
                        ls_uri = ls_uri +  "&actdbnmz=" + ls_actdbnmz + "&actflagz=" + ls_actflagz + "&actcalluseridz=" + ls_actcalluseridz;
                        ls_uri = ls_uri +  "&actcalluserpwz=" + ls_actcalluserpwz;
                    var win = window.open("/app01/ktcall?" + ls_uri,   "fullscreen=yes"); 
            } 
    </script>

    <script type="text/javascript" th:inline="javascript">
        var wtab01Grid;
        var wtab02Grid;
        var wtab03Grid;
        var wtab04Grid;
        var wtab05Grid;

        window.onload = function() {
            localStorage.setItem("setpage", "mainframe001");
            //tab01검색 popup list
            view_p01tab01page = new wijmo.collections.CollectionView(getData_tab01(), {
                pageSize: 12
            });
            // tab01검색 페이지 이동
            new wijmo.input.CollectionViewNavigator('#tab01Pager', {
                byPage: true,
                headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
                cv: view_p01tab01page
            });
            wtab01Grid = new wijmo.grid.FlexGrid('#wtab01Grid_div', {
                autoGenerateColumns: false,
                showMarquee: true,
                isReadOnly: false,
                // selectionMode: 'RowRange',
                allowSorting: 'MultiColumn',
                alternatingRowStep: 0,
                columns: [

                    { binding: 'actnm', header: '현장명', align: "center", width: '*' },
                    { binding: 'compdate', header: '계약기간', align: "center", width: '*' }
                    ],
                itemsSource: view_p01tab01page
            });

            function getData_tab01(){
                var wactnm_data = [];
                var cnt = 1;
                for (var i = 0; i < 12; i++) {
                    wactnm_data.push({
                        id: i,
                        index: cnt,
                        recedate: "",
                        recetime: "",
                        actnm: "",
                        equpnm: "",
                        actpernm: "",
                        pernm: "",
                        equpnm: "",
                        contnm: "",
                        contremark: ""
                    });
                    cnt++;
                }
                return wactnm_data;
            }

            view_p02tab02page = new wijmo.collections.CollectionView(getData_tab02(), {
                pageSize: 12
            });
            // tab02검색 페이지 이동
            new wijmo.input.CollectionViewNavigator('#tab02Pager', {
                byPage: true,
                headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
                cv: view_p02tab02page
            });
            wtab02Grid = new wijmo.grid.FlexGrid('#wtab02Grid_div', {
                autoGenerateColumns: false,
                showMarquee: true,
                isReadOnly: false,
                // selectionMode: 'RowRange',
                allowSorting: 'MultiColumn',
                alternatingRowStep: 0,
                columns: [
                    
                    { binding: 'actnm', header: '현장명', align: "center", width: '*' },
                    { binding: 'compdate', header: '계약기간', align: "center", width: '*' }
                    ],
                itemsSource: view_p02tab02page
            });

            function getData_tab02(){
                var wactnm_data = [];
                var cnt = 1;
                for (var i = 0; i < 12; i++) {
                    wactnm_data.push({
                        id: i,
                        index: cnt,
                        recedate: "",
                        recetime: "",
                        actnm: "",
                        equpnm: "",
                        actpernm: "",
                        pernm: "",
                        equpnm: "",
                        contnm: "",
                        contremark: ""
                    });
                    cnt++;
                }
                return wactnm_data;
            }

            view_p03tab03page = new wijmo.collections.CollectionView(getData_tab03(), {
                pageSize: 12
            });
            // tab03검색 페이지 이동
            new wijmo.input.CollectionViewNavigator('#tab03Pager', {
                byPage: true,
                headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
                cv: view_p03tab03page
            });
            wtab03Grid = new wijmo.grid.FlexGrid('#wtab03Grid_div', {
                autoGenerateColumns: false,
                showMarquee: true,
                isReadOnly: false,
                // selectionMode: 'RowRange',
                allowSorting: 'MultiColumn',
                alternatingRowStep: 0,
                columns: [
                    
                    { binding: 'actnm', header: '현장명', align: "center", width: '*' },
                    { binding: 'compdate', header: '계약기간', align: "center", width: '*' }
                    ],
                itemsSource: view_p03tab03page
            });

            function getData_tab03(){
                var wactnm_data = [];
                var cnt = 1;
                for (var i = 0; i < 12; i++) {
                    wactnm_data.push({
                        id: i,
                        index: cnt,
                        recedate: "",
                        recetime: "",
                        actnm: "",
                        equpnm: "",
                        actpernm: "",
                        pernm: "",
                        equpnm: "",
                        contnm: "",
                        contremark: ""
                    });
                    cnt++;
                }
                return wactnm_data;
            }

            view_p04tab04page = new wijmo.collections.CollectionView(getData_tab04(), {
                pageSize: 12
            });
            // tab04검색 페이지 이동
            new wijmo.input.CollectionViewNavigator('#tab04Pager', {
                byPage: true,
                headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
                cv: view_p04tab04page
            });
            wtab04Grid = new wijmo.grid.FlexGrid('#wtab04Grid_div', {
                autoGenerateColumns: false,
                showMarquee: true,
                isReadOnly: false,
                // selectionMode: 'RowRange',
                allowSorting: 'MultiColumn',
                alternatingRowStep: 0,
                columns: [
                    
                    { binding: 'actnm', header: '현장명', align: "center", width: '*' },
                    { binding: 'compdate', header: '관리대수', align: "center", width: '*' }
                    ],
                itemsSource: view_p04tab04page
            });

            function getData_tab04(){
                var wactnm_data = [];
                var cnt = 1;
                for (var i = 0; i < 12; i++) {
                    wactnm_data.push({
                        id: i,
                        index: cnt,
                        recedate: "",
                        recetime: "",
                        actnm: "",
                        equpnm: "",
                        actpernm: "",
                        pernm: "",
                        equpnm: "",
                        contnm: "",
                        contremark: ""
                    });
                    cnt++;
                }
                return wactnm_data;
            }

            view_p05tab05page = new wijmo.collections.CollectionView(getData_tab05(), {
                pageSize: 12
            });
            // tab05검색 페이지 이동
            new wijmo.input.CollectionViewNavigator('#tab05Pager', {
                byPage: true,
                headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
                cv: view_p05tab05page
            });
            wtab05Grid = new wijmo.grid.FlexGrid('#wtab05Grid_div', {
                autoGenerateColumns: false,
                showMarquee: true,
                isReadOnly: false,
                // selectionMode: 'RowRange',
                allowSorting: 'MultiColumn',
                alternatingRowStep: 0,
                columns: [
                    
                    { binding: 'actnm', header: '현장명', align: "center", width: '*' },
                    { binding: 'compdate', header: '고장건수', align: "center", width: '*' }
                    ],
                itemsSource: view_p05tab05page
            });

            function getData_tab05(){
                var wactnm_data = [];
                var cnt = 1;
                for (var i = 0; i < 12; i++) {
                    wactnm_data.push({
                        id: i,
                        index: cnt,
                        recedate: "",
                        recetime: "",
                        actnm: "",
                        equpnm: "",
                        actpernm: "",
                        pernm: "",
                        equpnm: "",
                        contnm: "",
                        contremark: ""
                    });
                    cnt++;
                }
                return wactnm_data;
            }
        }

        class FlexGridContextMenu {
            constructor(grid) {
                let host = grid.hostElement, menu = this._buildMenu(grid);
                host.addEventListener('contextmenu', (e) => {
                    // 클릭된 셀/열 선택
                    let sel = grid.selection, ht = grid.hitTest(e), row = ht.getRow();

                    switch (ht.panel) {
                        case grid.cells:
                        let colIndex = ht.col;
                        // 만약 그룹 헤더이면, 그룹 열 선택
                        if (row instanceof wijmo.grid.GroupRow && row.dataItem instanceof wijmo.collections.CollectionViewGroup) {
                            let gd = row.dataItem.groupDescription;
                            if (gd instanceof wijmo.collections.PropertyGroupDescription) {
                            let col = grid.getColumn(gd.propertyName);
                            if (col && col.index > -1) {
                                colIndex = col.index;
                            }
                            }
                        }
                        grid.select(ht.row, colIndex);
                        break;
                        case grid.columnHeaders:
                        grid.select(sel.row, ht.col);
                        break;
                        case grid.rowHeaders:
                        grid.select(ht.row, sel.col);
                        break;
                        default:
                        return; // 유효하지 않는 패널
                    }
                    // 현재 열에 대한 메뉴 표시
                    if (grid.selection.col > -1) {
                        e.preventDefault(); // 브라우저의 기본 메뉴 취소
                        menu.show(e); // Wijmo 메뉴 표시
                    }
                }, true);
            }
            _buildMenu(grid) {
                let menu = new wijmo.input.Menu(document.createElement('div'), {
                owner: grid.hostElement,
                displayMemberPath: 'header',
                subItemsPath: 'items',
                commandParameterPath: 'cmd',
                dropDownCssClass: 'ctx-menu',
                openOnHover: true,
                closeOnLeave: true,
                itemsSource: [
                    {
                    header: '정렬', items: [
                        { header: 'Ascending', cmd: 'SRT_ASC' },
                        { header: 'Descending', cmd: 'SRT_DESC' },
                        { header: 'No Sort', cmd: 'SRT_NONE' },
                        { header: '-' },
                        { header: 'Clear All Sorts', cmd: 'SRT_CLR' }
                    ]
                    },
                    { header: '-' },
                    { header: 'Pin/Unpin', cmd: 'PIN' },
                    { header: '-' },
                    { header: 'AutoSize', cmd: 'ASZ' },
                    { header: 'AutoSize All', cmd: 'ASZ_ALL' },
                    { header: '-' },
                    { header: 'Group/Ungroup', cmd: 'GRP' },
                    { header: 'Clear All Groups', cmd: 'GRP_CLR' },
                    { header: '-' },
                    {
                    header: '내려받기', items: [
                        { header: 'CSV', cmd: 'X_CSV' },
                        { header: 'XLSX', cmd: 'X_XLSX' },
                        { header: 'PDF', cmd: 'X_PDF' },
                    ]
                    }
                ],
                command: {
                    // 메뉴 명령 활성화/비활성화
                    canExecuteCommand: (cmd) => {
                    let view = grid.collectionView, col = grid.columns[grid.selection.col];
                    switch (cmd) {
                        case 'SRT_ASC':
                        return col.currentSort != '+';
                        case 'SRT_DESC':
                        return col.currentSort != '-';
                        case 'SRT_NONE':
                        return col.currentSort != null;
                        case 'SRT_CLR':
                        return view.sortDescriptions.length > 0;
                        case 'PIN':
                        return true; // toggle pin
                        case 'ASZ':
                        case 'ASZ_ALL':
                        return true;
                        case 'GRP':
                        return col.dataType != wijmo.DataType.Number; // don't group numbers
                        case 'GRP_CLR':
                        return view.groupDescriptions.length > 0;
                    }
                    return true;
                    },
                    // 메뉴 명령 실행
                    executeCommand: (cmd) => {
                        let view = grid.collectionView, cols = grid.columns, col = cols[grid.selection.col], sd = view.sortDescriptions, gd = view.groupDescriptions;
                        switch (cmd) {
                            case 'SRT_ASC':
                            case 'SRT_DESC':
                            case 'SRT_NONE':
                            if (grid.allowSorting != wijmo.grid.AllowSorting.MultiColumn) {
                                sd.clear();
                            }
                            else {
                                for (let i = 0; i < sd.length; i++) {
                                if (sd[i].property == col.binding) {
                                    sd.removeAt(i);
                                    break;
                                }
                                }
                            }
                            if (cmd != 'SRT_NONE') {
                                sd.push(new wijmo.collections.SortDescription(col.binding, cmd == 'SRT_ASC'));
                            }
                                break;
                            case 'SRT_CLR':
                                sd.clear();
                                break;
                            case 'PIN':
                                let fCols = grid.frozenColumns;
                                if (col.index >= fCols) { // pinning
                                    cols.moveElement(col.index, fCols, false);
                                    cols.frozen++;
                                }
                                else { // unpinning
                                    cols.moveElement(col.index, fCols - 1, false);
                                    cols.frozen--;
                                }
                                break;
                            case 'ASZ':
                                grid.autoSizeColumn(col.index);
                                break;
                            case 'ASZ_ALL':
                                grid.autoSizeColumns(0, grid.columns.length - 1);
                                break;
                            case 'GRP':
                            // 그룹 삭제
                                for (let i = 0; i < gd.length; i++) {
                                    if (gd[i].propertyName == col.binding) {
                                    gd.removeAt(i);
                                    return; // we're done
                                    }
                                }
                                // 그룹 추가
                                gd.push(new wijmo.collections.PropertyGroupDescription(col.binding));
                                break;
                            case 'GRP_CLR':
                                gd.clear();
                                break;
                            // 내보내기
                            case 'X_CSV':
                                let rng = new wijmo.grid.CellRange(0, 0, grid.rows.length - 1, grid.columns.length - 1), csv = grid.getClipString(rng, wijmo.grid.ClipStringOptions.CSV, true, false);
                                wijmo.saveFile(csv, 'FlexGrid.csv');
                                break;
                            case 'X_XLSX':
                                wijmo.grid.xlsx.FlexGridXlsxConverter.saveAsync(grid, null, 'FlexGrid.xlsx');
                                break;
                            case 'X_PDF':
                                wijmo.grid.pdf.FlexGridPdfConverter.export(grid, 'FlexGrid.pdf', {
                                    maxPages: 10,
                                    scaleMode: wijmo.grid.pdf.ScaleMode.PageWidth,
                                    documentOptions: {
                                    compress: true,
                                    header: { declarative: { text: '\t&[Page] of &[Pages]' } },
                                    footer: { declarative: { text: '\t&[Page] of &[Pages]' } },
                                    info: { author: 'GrapeCity', title: 'FlexGrid' }
                                    },
                                    styles: {
                                    cellStyle: { backgroundColor: '#ffffff', borderColor: '#c6c6c6' },
                                    altCellStyle: { backgroundColor: '#f9f9f9' },
                                    groupCellStyle: { backgroundColor: '#dddddd' },
                                    headerCellStyle: { backgroundColor: '#eaeaea' }
                                    }
                                });
                                break;
                        }
                        // 활성화 그리드 셀에 포커스 복원
                        grid.refresh();
                        let sel = grid.selection, cell = grid.cells.getCellElement(sel.row, sel.col);
                        if (cell) {
                            cell.focus();
                        }
                    }
                }
                });
                // 완료
                return menu;
            }
        }

    </script>

<footer>

</footer>

</html>