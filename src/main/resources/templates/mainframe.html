<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head th:replace="layouts/APPHeader/apphead :: headFragment" />
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>유지보수센터</title>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>

    
    <!-- <script> 
function chk(){ 
            var btn_obj = document.getElementById('menu01_btn');
            btn_obj.addEventListener("click",function(){  
                //TB_FPLAN_WORK TB_FPLAN_W010  SAVE    
                var ls_actuseridz   = document.getElementById('actuseridz').value; 
                var ls_actusernamez = document.getElementById('actusernamez').value;  
                var ls_actcltcdz = document.getElementById('actcltcdz').value;  
                var ls_actdbnmz = document.getElementById('actdbnmz').value;    
                var ls_actflagz = document.getElementById('actflagz').value;  
                var ls_uri = "actuseridz=" + ls_actuseridz +"&actusernamez=" + ls_actusernamez + "&actcltcdz=" + ls_actcltcdz + "&actdbnmz=" + ls_actdbnmz + "&actflagz=" + ls_actflagz;
                var win = window.open("/app01/ktcall?" + ls_uri, "_blank", "toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=500,width=400,height=400"); 
    
        }) 
       
  </script>       -->
     
</head>

<form class="row gy-2 gx-4 align-items-center" role="form" th:object="${userFormDto}" th:action="@{/appcom01/update}" method="post" enctype="multipart/form-data"></form>

<body style="background: #f5f9fa;">
<input type="hidden"  name="actuseridz" id="actuseridz" th:value="${userFormDto.userid}" >
<header>

</header>
<div class="content flex">
    <div class="header on">
        <div class="left">
            <div class="ham">
                <button type="button"><img src="/images/ham.png" alt=""></button>
            </div>
            <div class="nav_bg"></div>
            <!-- ################################ -->
            <!-- ## Left navigator include -->
            <th:block th:include="layouts/APPHeader/appLeftNav" />
        </div>
        <div class="right">
        </div>
    </div>
    <div class="con">
        <div class="header_top">
            <ul class="left">
                <li>
                    <div class="logo">
                        <a th:href="@{/auth/emmsdashboard}">
                            <img src="/images/logo.png" alt="">
                        </a>
                    </div>
                </li>
                <li class="home on">
                    <a><img src="/images/i_home.png" alt=""></a>
                    <a><img src="/images/i_home_on.png" alt=""></a>
                </li>
                <li>
                    고객상담센터
                </li>
                <li>
                    고장접수관제현황
                </li>
            </ul>
            <ul class="mid">
                <li>
                    <i><img src="/images/i_circle1.png" alt=""></i>
                    <p>계약현장 <span>50</span></p>
                </li>
                <li>
                    <i><img src="/images/i_circle2.png" alt=""></i>
                    <p>계약관리대수 <span>50</span></p>
                </li>
                <li>
                    <i><img src="/images/i_circle3.png" alt=""></i>
                    <p>당월고장접수 <span>50</span></p>
                </li>
                <li>
                    <i><img src="/images/i_circle4.png" alt=""></i>
                    <p>금일고장접수 <span>50</span></p>
                </li>
            </ul>
            <ul class="right">

                <li>
                    <a th:href="@{/}">
                        <img src="/images/in2.png" alt="">
                    </a>
                </li>
                <li >
                    <button id="userinfo">
                        <img src="/images/i_user.png" alt="">
                    </button>
                </li>
            </ul>
        </div>
        <div class="infor_bar type2">
            <ul class="right">
                <li>
                    <button   type="button" visible="false" data-bs-toggle="modal" data-bs-target="#staticBackdrop" id="listmodal_btn" onclick="clear_rtn(this)" > </button>
                    <button   type="button" visible="false" data-bs-toggle="modal" data-bs-target="#fileBackdrop" id="filemodal_btn" onclick="clear_rtn(this)" ></button>
                </li>
            </ul>

        </div>
        <div class="section section1">

            <div class="sec_con" style="width: 40%;">
                <div class="calender box_wrap">
                    <div class="cal_top">
                        <div class="pager">
                            <button type="button"><img src="/images/arrow_left.png" alt=""></button>
                            <p>2022.10</p>
                            <button type="button"><img src="/images/arrow_right.png" alt=""></button>
                        </div>
                        <div class="add_cal">
                            <button>+일정추가</button>
                        </div>
                    </div>
                    <div class="cal_bottom">
                        <div class="cal_table_box">
                            <table class="cal_table">
                                <tr>
                                    <th>Sun</th>
                                    <th>Mon</th>
                                    <th>Tue</th>
                                    <th>Wed</th>
                                    <th>Thu</th>
                                    <th>Fri</th>
                                    <th>Set</th>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><p>1</p></td>
                                </tr>
                                <tr>
                                    <td><p>2</p></td>
                                    <td><p>3</p></td>
                                    <td><p>4</p></td>
                                    <td><p>5</p></td>
                                    <td class="on"><!-- 클래스 on 활성화 -->
                                        <p>6</p>
                                        <div class="todo">
                                            <h5><i><img src="/images/i_dot.png" alt=""></i>10시 AM 일정</h5>
                                            <h5><i><img src="/images/i_dot.png" alt=""></i>3시 PM 일정</h5>
                                        </div>
                                    </td>
                                    <td><p>7</p></td>
                                    <td><p>8</p></td>
                                </tr>
                                <tr>
                                    <td><p>9</p></td>
                                    <td><p>10</p></td>
                                    <td><p>11</p></td>
                                    <td>
                                        <p>12</p>
                                        <div class="todo">
                                            <h5><i><img src="/images/i_dot.png" alt=""></i>10시 AM 일정</h5>
                                            <h5><i><img src="/images/i_dot.png" alt=""></i>3시 PM 일정</h5>
                                        </div>
                                    </td>
                                    <td><p>13</p></td>
                                    <td><p>14</p></td>
                                    <td><p>15</p></td>
                                </tr>
                                <tr>
                                    <td><p>16</p></td>
                                    <td><p>17</p></td>
                                    <td><p>18</p></td>
                                    <td><p>19</p></td>
                                    <td><p>20</p></td>
                                    <td><p>21</p></td>
                                    <td><p>22</p></td>
                                </tr>
                                <tr>
                                    <td><p>23</p></td>
                                    <td><p>24</p></td>
                                    <td><p>25</p></td>
                                    <td><p>26</p></td>
                                    <td><p>27</p></td>
                                    <td><p>28</p></td>
                                    <td><p>29</p></td>
                                </tr>
                                <tr>
                                    <td><p>30</p></td>
                                    <td><p>31</p></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                            </table>

                        </div>
                    </div>
                </div>

            </div>
            <div class="sec_con" style="width: 30%;">
                <div class="sec_con_tit">
                    <span>당월점검현황</span>
                </div>
                <div class="box_wrap with_tit" style="padding: 0px;">
                    <div class="container-fluid" style="padding: 0px;">
                        <div id="wtab01Grid_div" ></div>
                        <div id="tab01Pager"></div>
                    </div>
                </div>
            </div>
            <div class="sec_con" style="width: 30%;">
                <div class="sec_con_tit">
                    <span>공지사항</span>
                </div>
                <div class="box_wrap with_tit" style="padding: 0px;">
                    <div class="container-fluid" style="padding: 0px;">
                        <div id="mGrid_div" ></div>
                        <div id="tabPager01"></div>
                    </div>
                </div>
            </div>
            <!--<div class="sec_con" style="width: 20%;">
                <div class="sec_con_tit">
                    금일 점검 직원
                </div>
                <div class="box_wrap with_tit">
                    <ul class="employee scrollbar" style="overflow-y: scroll; height: 360px;">
                        <li>
                            <div class="left">
                                <div class="user_icon" style="background: url(/images/user1.png) no-repeat center center;">
                                </div>
                                <div class="txt">
                                    <h5>홍길동</h5>
                                    <p>금천 자이 아파트</p>
                                </div>
                            </div>
                            <div class="state">
                                점검
                            </div>
                        </li>
                        <li>
                            <div class="left">
                                <div class="user_icon" style="background: url(/images/user2.png) no-repeat center center;">
                                </div>
                                <div class="txt">
                                    <h5>홍길동</h5>
                                    <p>금천 자이 아파트</p>
                                </div>
                            </div>
                            <div class="state">
                                결근
                            </div>
                        </li>
                        <li>
                            <div class="left">
                                <div class="user_icon" style="background: url(/images/user3.png) no-repeat center center;">
                                </div>
                                <div class="txt">
                                    <h5>홍길동</h5>
                                    <p>금천 자이 아파트</p>
                                </div>
                            </div>
                            <div class="state">
                                이동
                            </div>
                        </li>
                        <li>
                            <div class="left">
                                <div class="user_icon" style="background: url(/images/user4.png) no-repeat center center;">
                                </div>
                                <div class="txt">
                                    <h5>홍길동</h5>
                                    <p>금천 자이 아파트금천 자이 아파트</p>
                                </div>
                            </div>
                            <div class="state">
                                접수
                            </div>
                        </li>
                        <li>
                            <div class="left">
                                <div class="user_icon" style="background: url(/images/user5.png) no-repeat center center;">
                                </div>
                                <div class="txt">
                                    <h5>홍길동</h5>
                                    <p>금천 자이 아파트</p>
                                </div>
                            </div>
                            <div class="state">
                                완료
                            </div>
                        </li>
                    </ul>
                </div>
            </div>-->



        </div>
        <div class="section section2">
            <div class="sec_con" style="width: 33.3333%;">
                <div class="sec_con_tit">
                    <span>당일계약만료현장</span>
                </div>
                <div class="box_wrap with_tit" style="padding: 0px;">
                    <div class="container-fluid" style="padding: 0px;">
                        <div id="nGrid_div" ></div>
                        <div id="tabPager02"></div>
                    </div>
                </div>
            </div>
            <div class="sec_con" style="width: 33.3333%;">
                <div class="sec_con_tit">
                    <span>30일후 계약만료현장</span>
                </div>
                <div class="box_wrap with_tit" style="padding: 0px;">
                    <div class="container-fluid" style="padding: 0px;">
                        <div id="bGrid_div" ></div>
                        <div id="tabPager03"></div>
                    </div>
                </div>
            </div>
            <div class="sec_con" style="width: 33.3333%;">
                <div class="sec_con_tit">
                    <span>당월 현장별/호기별 고장접수 현황</span>
                </div>
                <div class="box_wrap with_tit" style="padding: 0px;">
                    <div class="container-fluid" style="padding: 0px;">
                        <div id="vGrid_div" ></div>
                        <div id="tabPager04"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <input class="form-control form-control-sm"  type="hidden" id="userinfobtn" data-bs-toggle="modal" data-bs-target="#userinfomodal"  />
    <!-- ###########  공지등록 #############################################################-->
    <!--------------------------------------------------------------------------------------->

    <form   id="form" name="form"  role="form"   method="post"  enctype="multipart/form-data">
        <div class="modal fade" id="staticBackdrop" data-bs-keyboard="false"
             data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
             aria-hidden="true">
            <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
                 style="max-width: 900px">
                <div class="modal-content border-0">
                    <div class="modal-body p-0" >
                        <div class="bg-light rounded-top-lg py-3 ps-4 pe-6">
                            <h4 class="mb-1" id="staticBackdropLabel">공지등록</h4>
                        </div>
                        <div class="section ">

                            <div class="sec_con" style="width: 100%;">
                                <div class="box_wrap">
                                    <div class="reference_tit">
                                        <div class="title">
                                            제목
                                        </div>
                                        <div class="input_wrap">
                                            <input type="text" name="actnsubjectz" id="actnsubjectz" >
                                            <input type="hidden" name="actnseqz" id="actnseqz" >
                                        </div>
                                        <div class="title" >
                                            작성일자
                                        </div>
                                        <div class="input_wrap date" style="max-width: 235px">
                                            <input type="text"  class="form-control datetimepicker" id="actninputdatez" autocomplete="off"  placeholder="Y-m-d"     >
                                        </div>
                                    </div>
                                    <div class="table table_style3">
                                        <table>
                                            <tr>
                                                <th style="width: 7%;">분류</th>
                                                <td style="width: 24%">
                                                    <div class="input_wrap" style="max-width: 235px;">
                                                        <select th:field="*{com750Dto}" name="actngroupcdz" id="actngroupcdz">
                                                            <option value="">선택</option>
                                                            <option th:each="val : ${com750Dto}" th:value="${val.code}" th:text="${val.cnam}">
                                                        </select>
                                                    </div>
                                                </td>
                                                <th style="width: 10%;">작성자</th>
                                                <td style="width: 23%">
                                                    <input type="text" name="actnpernmz" id="actnpernmz" >
                                                </td>
                                                <th style="width: 13%;">회원사공유</th>
                                                <td style="width: 23%">
                                                    <input type="checkbox" id="actnflagz" value="Y" checked>
                                                    <label for="actnflagz" class="check_style1 no_txt"></label>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>내용</th>
                                                <td colspan="5">
                                                    <textarea  id="actnmemoz"></textarea>
                                                </td>
                                            </tr>
                                            <div data-name="fileDiv" class="form-group filebox bs3-primary">

                                            </div>

                                        </table>
                                        <div id="btnDiv" class="btn_wrap">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                    <div class="modal-footer">
                        <div class="row g-1">
                            <div class="col-auto">
                                <button class="badge-soft-primary dropdown-item rounded-1"
                                        type="button" id="CloseBtn"  data-bs-dismiss="modal">Close</button>
                            </div>
                            <!-- <div class="col-auto">
                                <button class="badge-soft-info dropdown-item rounded-1"
                                    type="submit">저장 </button>
                            </div> -->
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </form>
    <!-- ###########  첨부파일 미리보기######################################################-->
    <!--------------------------------------------------------------------------------------->

    <form   id="form" name="form"  role="form"   method="post"  enctype="multipart/form-data">
        <div class="modal fade" id="fileBackdrop" data-bs-keyboard="false"
             data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
             aria-hidden="true">
            <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm02"
                 style="max-width: 900px">
                <div class="modal-content border-0">
                    <div class="modal-body p-0" >
                        <div class="bg-light rounded-top-lg py-3 ps-4 pe-6">
                            <h4 class="mb-1" id="staticBackdropLabel">파일다운로드</h4>
                        </div>
                        <div class="section ">

                            <div class="sec_con" style="width: 100%;">
                                <div class="box_wrap">
                                    <table>
                                        <tr>
                                            <th style="width: 10%;">파일목록</th>
                                        </tr>
                                        <tr>
                                            <td style="width: 90%">
                                                <div data-name="filelistDiv" id="filelistDiv" class="table table_style3"></div>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div class="row g-1">
                            <div class="col-auto">
                                <button class="badge-soft-primary dropdown-item rounded-1"
                                        type="button" id="CloseFileBtn"  data-bs-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </form>

</div>
<!--------------------------------------------------------------------------------------->


<!--------------------------------------------------------------------------------------->
<!-- 마이페이지 MODAL FROM  -->
<div class="modal fade" id="userinfomodal" data-bs-keyboard="false"
     data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
         style="max-width: 500px">
        <div class="modal-content border-0">
            <div class="modal-body p-0" >
                <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
                    <!-- <h4 class="mb-1" id="modalExampleDemoLabel">현장검색</h4>  -->
                    <label>비밀번호</label>
                    <input class="form-control form-control-sm" type="text"  th:value="${userFormDto.passwd1}" id="actpasswdz" onchange="check_pw()">
                    <label>이름</label>
                    <input class="form-control form-control-sm" type="text"  th:value="${userFormDto.username}" id="actnamez">
                    <label>핸드폰번호</label>
                    <input class="form-control form-control-sm" type="text"  th:value="${userFormDto.phone}" id="actphonez">
                    <!--<input class="form-control form-control-sm" type="text"  th:value="${userFormDto.userid}">-->


                </div>

            </div>

            <div class="modal-footer">
                <div class="row g-1">
                    <div class="col-auto">
                        <button class="badge-soft-primary dropdown-item rounded-1"
                                type="button"  id="wpernmmodal_btn2" data-bs-dismiss="modal" onclick="save_btn()">수정</button>
                    </div>
                    <div class="col-auto">
                        <button class="badge-soft-primary dropdown-item rounded-1"
                                type="button"  id="wpernmmodal_btn" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<!--------------------------------------------------------------------------------------->
<!-- modal -->
<!-- class="modal_step_open" modal_step="1" -->


<script type="text/javascript" th:inline="javascript">

    let formData = new FormData();
    function clear_rtn(elem){
        console.log("clear rtn");
        document.getElementById('actnseqz').value= "";
        document.getElementById('actnsubjectz').value= "";
        document.getElementById('actnpernmz').value= "";
        // document.getElementById('actnfilenamez').value= "";
        document.getElementById('actninputdatez').value= "";
        document.getElementById('actngroupcdz').value= "";
        document.getElementById('actnmemoz').value= "";
        document.getElementById('actnflagz').value= "";
        const target = $(elem).parents('div[data-name="fileDiv"]');
        fileIdx = 0;
        const fileDivs = $('div[data-name="fileDiv"]');
        fileDivs.remove();
        getToday()
    }


    var view_p01tab01page;
    var view_p01tab02page;
    var view_p01tab03page;
    var view_p01tab04page;
    var wtab01Grid;



    window.onload = function () {


        document.getElementById("filemodal_btn").style.display="none";
        <!--고장다발현장-->
        view_p01tab04page = new wijmo.collections.CollectionView(getData_tab04(), {
            pageSize: 12
        });

        new wijmo.input.CollectionViewNavigator('#tabPager04', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_p01tab04page
        });
        wtab01Grid = new wijmo.grid.FlexGrid('#vGrid_div', {
            autoGenerateColumns: false,
            showMarquee: true,
            isReadOnly: false,
            allowSorting: 'MultiColumn',
            alternatingRowStep: 0,
            columns: [
                { binding: 'actcd', header: '현장코드', align: "center", width: 100 },
                { binding: 'actnm', header: '현장명', align: "center", width: 120 },
                { binding: 'equpcd', header: '호기코드', align: "center", width: 100},
                { binding: 'equpnm', header: '호기명', align: "center", width: 100 },
                { binding: 'pernm', header: '담당자', align: "center", width: 100 },
                { binding: 'contnm', header: '고장내용', align: "center", width: 100 },
                { binding: 'contents', header: '고장상세내용', align: "center", width: 100 },
                { binding: 'stdate', header: '담당자', align: "center", width: 100 },
                { binding: 'enddate', header: '담당자', align: "center", width: 100 },
                {binding:  'qty', header: '건수', align: "center", width: 100}


            ],
            itemsSource: view_p01tab04page
        });

        // tab01검색 데이터 수집
        function getData_tab04(){
            var mapp15Dto = [[${app15DtoList4}]];
            var wactnm_data = [];
            var cnt = 1;
            for (var i = 0; i < mapp15Dto.length; i++) {
                wactnm_data.push({
                    id: i,
                    index: cnt,
                    actcd: mapp15Dto[i]["actcd"],
                    actnm: mapp15Dto[i]["actnm"],
                    equpcd: mapp15Dto[i]["equpcd"],
                    equpnm: mapp15Dto[i]["equpnm"],
                    pernm: mapp15Dto[i]["pernm"],
                    contnm: mapp15Dto[i]["contnm"],
                    contents: mapp15Dto[i]["contents"],
                    stdate: mapp15Dto[i]["stdate"],
                    enddate: mapp15Dto[i]["enddate"],
                    qty: mapp15Dto[i]["qty"],


                });
                cnt++;
            }
            return wactnm_data;
        }
        <!--고장다발현장 끝-->



        <!--30일후 계약만료현장-->
        view_p01tab03page = new wijmo.collections.CollectionView(getData_tab03(), {
            pageSize: 12
        });

        new wijmo.input.CollectionViewNavigator('#tabPager03', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_p01tab03page
        });
        wtab01Grid = new wijmo.grid.FlexGrid('#bGrid_div', {
            autoGenerateColumns: false,
            showMarquee: true,
            isReadOnly: false,
            allowSorting: 'MultiColumn',
            alternatingRowStep: 0,
            columns: [
                { binding: 'actcd', header: '현장코드', align: "center", width: 100 },
                { binding: 'actnm', header: '현장명', align: "center", width: 170 },
                { binding: 'contdate', header: '계약일자', align: "center", width: 100},
                { binding: 'stdate', header: '시작일자', align: "center", width: 100 },
                { binding: 'enddate', header: '만료일자', align: "center", width: 100 },

            ],
            itemsSource: view_p01tab03page
        });

        // tab01검색 데이터 수집
        function getData_tab03(){
            var mapp15Dto = [[${app15DtoList3}]];
            var wactnm_data = [];
            var cnt = 1;
            for (var i = 0; i < mapp15Dto.length; i++) {
                wactnm_data.push({
                    id: i,
                    index: cnt,
                    actcd: mapp15Dto[i]["actcd"],
                    actnm: mapp15Dto[i]["actnm"],
                    contdate: mapp15Dto[i]["contdate"],
                    stdate: mapp15Dto[i]["stdate"],
                    enddate: mapp15Dto[i]["enddate"],
                });
                cnt++;
            }
            return wactnm_data;
        }
        <!--30일후 계약만료현장-->

        <!--당일계약만료현장 시작-->
        view_p01tab02page = new wijmo.collections.CollectionView(getData_tab02(), {
            pageSize: 12
        });

        new wijmo.input.CollectionViewNavigator('#tabPager02', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_p01tab02page
        });
        wtab01Grid = new wijmo.grid.FlexGrid('#nGrid_div', {
            autoGenerateColumns: false,
            showMarquee: true,
            isReadOnly: false,
            allowSorting: 'MultiColumn',
            alternatingRowStep: 0,
            columns: [
                { binding: 'actcd', header: '현장코드', align: "center", width: 100 },
                { binding: 'actnm', header: '현장명', align: "center", width: 170 },
                { binding: 'contdate', header: '계약일자', align: "center", width: 100},
                { binding: 'stdate', header: '시작일자', align: "center", width: 100 },
                { binding: 'enddate', header: '만료일자', align: "center", width: 100 },

            ],
            itemsSource: view_p01tab02page
        });

        // tab01검색 데이터 수집
        function getData_tab02(){
            var mapp15Dto = [[${app15DtoList2}]];
            var wactnm_data = [];
            var cnt = 1;
            for (var i = 0; i < mapp15Dto.length; i++) {
                wactnm_data.push({
                    id: i,
                    index: cnt,
                    actcd: mapp15Dto[i]["actcd"],
                    actnm: mapp15Dto[i]["actnm"],
                    contdate: mapp15Dto[i]["contdate"],
                    stdate: mapp15Dto[i]["stdate"],
                    enddate: mapp15Dto[i]["enddate"],
              });
                cnt++;
            }
            return wactnm_data;
        }
        <!--당일계약만료현장 시작-->

        <!--당월 점검현황 시작-->
        view_p01tab01page = new wijmo.collections.CollectionView(getData_tab01(), {
            pageSize: 12
        });

        new wijmo.input.CollectionViewNavigator('#tab01Pager', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_p01tab01page
        });
        wtab01Grid = new wijmo.grid.FlexGrid('#wtab01Grid_div', {
            autoGenerateColumns: false,
            showMarquee: true,
            isReadOnly: false,
            // selectionMode: 'RowRange',
            allowSorting: 'MultiColumn',
            alternatingRowStep: 0,
            columns: [
                { binding: 'plandate', header: '점검일자', align: "center", width: 100 },
                { binding: 'plantime', header: '점검시간', align: "center", width: 100 },
                { binding: 'actnm', header: '현장명', align: "center", width: 120},
                { binding: 'equpnm', header: '호기명', align: "center", width: 100 },
                { binding: 'gubun', header: '구분', align: "center", width: 100 },
                { binding: 'kcpernm', header: '검사자', align: "center", width: 100 },
                { binding: 'qty', header: '대수', align: "center", width: 100 },
                { binding: 'remark', header: '기타호기', align: "center", width: 100 },
                { binding: 'kcspnm', header: '검사기관', align: "center", width: 100 }

            ],
            itemsSource: view_p01tab01page
        });

        // tab01검색 데이터 수집
        function getData_tab01(){
            var mapp15Dto = [[${app15DtoList}]];
            var wactnm_data = [];
            var cnt = 1;
            for (var i = 0; i < mapp15Dto.length; i++) {
                wactnm_data.push({
                    id: i,
                    index: cnt,
                    plandate: mapp15Dto[i]["plandate"],
                    plantime: mapp15Dto[i]["plantime"],
                    actnm: mapp15Dto[i]["actnm"],
                    equpnm: mapp15Dto[i]["equpnm"],
                    gubun: mapp15Dto[i]["gubun"],
                    kcpernm: mapp15Dto[i]["kcpernm"],
                    qty: mapp15Dto[i]["qty"],
                    remark: mapp15Dto[i]["remark"],
                    kcspnm: mapp15Dto[i]["kcspnm"],
                });
                cnt++;
            }
            return wactnm_data;
        }
        <!--당월점검현황 끝-->


        <!--공지사항 -->
        var view_Mnoticepage = new wijmo.collections.CollectionView(getData_wlist(), {
            pageSize: 12
        });

        new wijmo.input.CollectionViewNavigator('#tabPager01', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_Mnoticepage
        });
        wapp05Grid = new wijmo.grid.FlexGrid('#mGrid_div', {
            autoGenerateColumns: false,
            selectionMode: 'RowRange',
            alternatingRowStep: 0,
            columns: [

                { binding: 'nseq', header: '번호', width: 100, format: '*' , align:"center", isReadOnly: true},
                { binding: 'cnam', header: '분류', width: 100, format: '*', align:"center", isReadOnly: true },
                { binding: 'nsubject',width: 100, header: '제목', align:"left", format: '*' ,
                    cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({
                        text: '<b>${item.nsubject}</b>',
                        click: (e, ctx) => {
                            viewPage(ctx.item.nseq, ctx.item.cnam, ctx.item.nsubject, ctx.item.npernm, ctx.item.nfilename, ctx.item.ninputdate , ctx.item.ngourpcd , ctx.item.nmemo, ctx.item.nflag );
                        }
                    })
                },
                { binding: 'npernm', header: '작성자', width: 100,   align:"center", isReadOnly: true } ,
                { binding: 'attcnt', header: '첨부파일건수', width: 100, format: 'n0',  align:"center", isReadOnly: true,
                    cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({
                        text: '<b>${item.attcnt}건 보기</b>',
                        click: (e, ctx) => {
                            viewFilePage(ctx.item.nseq);
                        }
                    })
                     } ,
                { binding: 'ninputdate', header: '등록일자', width: 100,   align:"center",  isReadOnly: true }

            ],
            itemsSource: view_Mnoticepage
        });
        wapp05Grid.hostElement.addEventListener("click",function(e){
            var ht = wapp05Grid.hitTest(e);
            if(ht.cellType === wijmo.grid.CellType.Cell){
                console.log(ht._p._rows );
                //  data = ht.RowCollection(ht.row); // e.getCellData(ht.row, 0, false);
                // console.log(data);

            }
        })
        // 설비메뉴얼 데이터 수집
        function getData_wlist(){

            var mapp05Dto = [[${App05Dto}]];
            var data01 = [];
            var cnt = 1;

            console.log(mapp05Dto);
            for (var i = 0; i < mapp05Dto.length; i++) {
                data01.push({
                    id: i,
                    index: cnt,
                    nseq:     mapp05Dto[i]["nseq"],
                    cnam:     mapp05Dto[i]["cnam"],
                    nsubject: mapp05Dto[i]["nsubject"],
                    npernm:   mapp05Dto[i]["npernm"],
                    attcnt : mapp05Dto[i]["attcnt"] ,
                    ninputdate : mapp05Dto[i]["ninputdate"].substr(0,4) + "-" + mapp05Dto[i]["ninputdate"].substr(4,2)+"-"+mapp05Dto[i]["ninputdate"].substr(6,2),
                    ngourpcd : mapp05Dto[i]["ngourpcd"]     ,
                    nmemo : mapp05Dto[i]["nmemo"]     ,
                    nflag : mapp05Dto[i]["nflag"]
                });
                cnt++;
            }
            console.log(data01);
            return data01
        }

        <!--공지사항 끝-->

    } ////////////////////////////////////////////////////////////////////////////////////////////////////////////onload 끝

    //공지사항 파일 미리보기
    // 첨부파일 보기 modal 호출
    function viewFilePage(arg1 ){
        $("#filemodal_btn").trigger("click");

        var wfile_data = [];
        const fileHtml = '';
        $.ajax({
            url: '/app05mod/flist',
            type:"POST",
            data: {
                "actnseqz"     : arg1,
                "actnflagz"     : "NN",
            },
            async:false,
            success:function(data){
                var wfileDto  = data;
                var cnt = 0;

                const filelistDiv = $('div[data-name="filelistDiv"]');
                filelistDiv.empty();
                console.log(data);
                if(wfileDto.length > 0){
                    for (var i = 0; i < wfileDto.length; i++) {
                        var  id = i;
                        var  idx = wfileDto[i]["idx"];
                        var  boardIdx = wfileDto[i]["boardIdx"];
                        var  originalName = wfileDto[i]["originalName"];
                        console.log(id, idx, boardIdx, originalName);

                        const fileHtml = `
                                    <div data-name="filelistDiv" class="form-group filebox bs3-primary">
                                        <a href="/nappx/download?actidxz=${idx}&actboardz=${boardIdx}&actflagz=NN" target="_blank" > ${originalName} 다운로드 </a>
                                    </div>
                                    `;
                        console.log(fileHtml);
                        $('#filelistDiv').after(fileHtml);
                        $('#btnDiv02').before(fileHtml);

                        cnt++;
                    }
                } else{
                    // const fileHtml = `  `;
                    // $('#filelistDiv').after(fileHtml);
                }
            },error:function(e){

            }
        }).done(function(fragment){

        })

    }

    // 첨부파일 다운로드 호출  get 방식으로만 가능함.
    function fileDownload(arg1, arg2 ){
        $.ajax({
            url: '/nappx/download',
            type:"GET",
            data: {
                "actidxz"     : arg1,
                "actboardz"    : arg2,
                "actflagz"     : "NN",
            },
            async:false,
            success:function(data){
                // console.log("result : " + data)
            },error:function(e){

            }
        }).done(function(fragment){

        })

    }



    //공지사항 자세히 보기
    function viewPage(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9) {
        $("#listmodal_btn").trigger("click");
        document.getElementById('actnseqz').value= arg1;
        document.getElementById('actnsubjectz').value= arg3;
        document.getElementById('actnpernmz').value= arg4;
        // document.getElementById('actnfilenamez').value= arg5;
        arg6 = arg6.substr(0,4) +  arg6.substr(4, 2) + arg6.substr(6,9);
        document.getElementById('actninputdatez').value= arg6;
        document.getElementById('actngroupcdz').value= arg7;
        document.getElementById('actnmemoz').value= arg8;
        document.getElementById('actnflagz').value= arg9;

        var wfile_data = [];
        $.ajax({
            url: '/app05mod/flist',
            type:"POST",
            data: {
                "actnseqz"     : arg1,
                "actnflagz"     : "NN",
            },
            async:false,
            success:function(data){
                var wfileDto  = data;
                var cnt = 0;
                if(wfileDto.length > 0){
                    for (var i = 0; i < wfileDto.length; i++) {
                        // wfile_data.push({
                        //     id: i,
                        //     index: cnt,
                        //     idx: wfileDto[i]["idx"],
                        //     boardIdx: wfileDto[i]["boardIdx"],
                        //     originalName: wfileDto[i]["originalName"],
                        // });
                        var  id = i;
                        var  idx = wfileDto[i]["idx"];
                        var  boardIdx = wfileDto[i]["boardIdx"];
                        var  originalName = wfileDto[i]["originalName"];

                        const fileHtml = `
                                    <div data-name="fileDiv" class="form-group filebox bs3-primary">
                                        <div class="table table_style3">
                                            <table>
                                                <tr>
                                                    <th style="width: 7%;">첨부파일</th>
                                                    <td colspan="5">
                                                        <div class="col-sm-15">
                                                            <input type="hidden" name="fileIdxs" value="${idx}" />
                                                            <input type="text" class="upload-name" value="${originalName}" readonly />

                                                            <button type="button" onclick="deleteFile(this, ${idx},  ${boardIdx})" class="btn btn-bordered btn-xs visible-xs-inline visible-sm-inline visible-md-inline visible-lg-inline">
                                                                <i class="fa fa-minus" aria-hidden="true"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                    `;
                        $('#btnDiv').before(fileHtml);

                        cnt++;
                    }
                } else{
                    const fileHtml = `  `;
                    $('#btnDiv').before(fileHtml);
                }
            },error:function(e){

            }
        }).done(function(fragment){

        })
    }

    $(document).ready(function() {
        getToday()
        $('datetimepicker').datetimepicker({

        });

        $("#actninputdatez").change(function(e){
            // console.log("달력클릭");
            // console.log(convert_time(e.timestamp));
        })

    })


    function getToday(){
        let today = new Date();

        let year = today.getFullYear(); // 년도
        let month = today.getMonth() + 1;  // 월
        let date = today.getDate();  // 날짜
        let day = today.getDay();  // 요일
        if(month > 0 && month < 10) {month = "0" + month};
        if(date > 0 && date < 10) {date = "0" + date};
        let ls_today = year + '-' + month + '-' + date
        document.getElementById('actninputdatez').value = ls_today;
    }

    function convert_time(timestamp){
        //현재시간
        var date = new Date(timestamp);
        var year = date.getFullYear();
        var month = ("0" + (1 + date.getMonth())).slice(-2);
        var day = ("0" + date.getDate()).slice(-2);
        var hh = date.getHours();
        var min = ('0' + date.getMinutes()).slice(-2)
        time = year +  month +  day   ;
        return time;
    }

  //마이페이지 모달 호출
    document.getElementById("userinfo").addEventListener("click",function(){
        document.getElementById("userinfobtn").click();




    });

    function save_btn(){
        var ls_passwd = document.getElementById('actpasswdz').value;
        var ls_name = document.getElementById('actnamez').value;
        var ls_phone = document.getElementById('actphonez').value;
        var ls_userid = document.getElementById('actuseridz').value;

        if(!ls_passwd){
            alert("공백은 불가합니다.")
            return
        }
        if(!ls_name){
            alert("공백은 불가합니다.")
            return
        }
        if(!ls_phone){
            alert("공백은 불가합니다.")
            return
        }

        $.ajax({
            url: '/authcrud/update',
            type: "POST",
            data: {
                "passwd1" : ls_passwd,
                "passwd2" : ls_passwd,
                "phone" : ls_phone,
                "username" : ls_name,
                "userid" : ls_userid
            },
            async: false,
            success:function (data) {
                alert("성공")
            },error:function (e) {
                alert("오류발생");
                console.log('error', e)
            }
        }).done(function(fragment){

        })


    }

    function check_pw(){
        var pw = document.getElementById('actpasswdz').value;

        const pattern_pwd = /(?=.*\d{1,20})(?=.*[~`!@#$%\^&*()-+=]{1,20})(?=.*[a-zA-Z]{1,20}).{8,20}$/;

        if(!(pattern_pwd.test(pw))){
            window.alert('영문+숫자+특수문자 조합으로 8자리 이상 비밀번호를 입력해주세요.');
            document.getElementById('actpasswdz').value="";
            document.getElementById('actpasswdz').focus();
        }
    }


</script>
<footer th:replace="layouts/APPHeader/appfooter :: footerFragment"></footer>

</body>
<script>
        function menu01_btn(){ 
                    var ls_actuseridz   =  jQuery('#actuseridz').val(); //document.getElementById('actuseridz').value; 
                    var ls_actusernamez =  jQuery('#actusernamez').val(); //document.getElementById('actusernamez').value;  
                    var ls_actcltcdz =   jQuery('#actcltcdz').val();  //document.getElementById('actcltcdz').value;  
                    ls_actcltcdz =    ls_actcltcdz + "";
                    var ls_actdbnmz =  jQuery('#actdbnmz').val();   //document.getElementById('actdbnmz').value;    
                    var ls_actflagz =  jQuery('#actflagz').val();   //document.getElementById('actflagz').value;  
                    var ls_actcalluseridz =  jQuery('#actcalluseridz').val();   
                    var ls_actcalluserpwz =  jQuery('#actcalluserpwz').val();   

                    var ls_uri          = "actuseridz=" + ls_actuseridz +"&actusernamez=" + ls_actusernamez + "&actcltcdz=" + ls_actcltcdz ;
                        ls_uri = ls_uri +  "&actdbnmz=" + ls_actdbnmz + "&actflagz=" + ls_actflagz + "&actcalluseridz=" + ls_actcalluseridz;
                        ls_uri = ls_uri +  "&actcalluserpwz=" + ls_actcalluserpwz;
                    var win = window.open("/app01/ktcall?" + ls_uri,   "fullscreen=yes"); 
            }


    </script>



</html>