<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="layouts/XRegister/head :: headFragment" />

<body>
  <!-- ===============================================-->
  <!--    Main Content-->
  <!-- ===============================================-->
  <main class="main" id="top">
    <div class="container-fluid">
      <div class="row min-vh-100 flex-center g-0">
        <div class="col-lg-8 col-xxl-5 py-3 position-relative">
          
          <div class="card overflow-hidden z-index-1">
            <div class="card-body p-0">
              <div class="row g-0 h-100">
                <div class="col-md-5 text-center bg-card-gradient">
                  <div class="position-relative p-4 pt-md-5 pb-md-7 light">
                    
                    <!--/.bg-holder-->

                    <div class="z-index-1 position-relative"><a
                        class="link-light mb-4 font-sans-serif fs-4 d-inline-block fw-bolder" th:href="@{/}">Actas
                        ERP</a> 
                    </div>
                  </div>
                  <div class="mt-3 mb-4 mt-md-4 mb-md-5 light">
                    <p class="text-white">계정이 없으신가요?<br><a class="text-decoration-underline link-light"
                        th:href="@{/auth/cltcdnew}">보수업체사용자등록</a>
                        <a class="text-decoration-underline link-light"
                        th:href="@{/auth/actcdnew}">고객사용자등록</a>                        
                    </p>                           
                  </div>
                </div>
                <div class="col-md-7 d-flex flex-center">
                  <div class="p-4 p-md-5 flex-grow-1">
                    <div class="row flex-between-center">
                      <div class="col-auto">
                        <h3>Login</h3>
                      </div>
                    </div>
                    <form  action="/login" method="POST">
                      <div class="mb-3">
                        <label class="form-label" for="card-email">User ID</label>
                        <input class="form-control" name="loginid" id="loginid" type="text" />
                      </div>
                      <div class="mb-3">
                        <div class="d-flex justify-content-between">
                          <label class="form-label" for="card-password">Password</label>
                        </div>
                        <input class="form-control" name="logpass" id="logpass" type="password" />
                      </div>
                      <div class="row flex-between-center">
                        <div class="col-auto">
                          <div class="form-check mb-0">
                            <input class="form-check-input" type="checkbox" id="card-checkbox" checked="checked" />
                            <label class="form-check-label mb-0" for="card-checkbox">Remember me</label>
                          </div>
                        </div>
                        <!-- <div class="col-auto"><a class="fs--1"
                            href="../../../pages/authentication/card/forgot-password.html">Forgot Password?</a></div> -->
                      </div>
                      <div class="mb-3">
                        <button class="btn btn-primary d-block w-100 mt-3" type="button" name="login_btn" id="login_btn" >로그인</button>   
                      </div>
                      <div class="mb-3">
                        <div th:if="${loginErrorMsg}" class="alert alert-warning border-2 d-flex align-items-center"
                          role="alert">
                          <div class="bg-warning me-3 icon-item"><span
                              class="fas fa-exclamation-circle text-white fs-3"></span></div>
                          <p class="mb-0 flex-1" th:text="${loginErrorMsg}">Incorrent data</p>
                        </div>
                      </div>
                       <!-- <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"></input> -->
                    </form>
                    <!-- <div th:if="${param.error}">
                                <div class="alert alert-danger" role="alert">
                                    <b>사용자 아이디 또는 암호를 확인하세요.</b>
                                </div>
                            </div>
                            <div th:if="${param.logout}">
                                <div class="alert alert-danger" role="alert">
                                    <b>로그아웃 되었습니다.</b>
                                </div>        
                            </div>                               -->
                    <!-- <div class="position-relative mt-4">
                              <hr class="bg-300" />
                              <div class="divider-content-center">or log in with</div>
                            </div> -->
                    <!-- <div class="row g-2 mt-2">
                              <div class="col-sm-6"><a class="btn btn-outline-google-plus btn-sm d-block w-100" href="#"><span class="fab fa-google-plus-g me-2" data-fa-transform="grow-8"></span> google</a></div>
                              <div class="col-sm-6"><a class="btn btn-outline-facebook btn-sm d-block w-100" href="#"><span class="fab fa-facebook-square me-2" data-fa-transform="grow-8"></span> facebook</a></div>
                            </div> -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>



    <script>
      var btn_obj = document.getElementById('login_btn');
      btn_obj.addEventListener("click",function(){ 
        alert("login");
          //TB_FPLAN_WORK TB_FPLAN_W010  SAVE    
          var ls_loginid   = document.getElementById('loginid').value; 
          var ls_logpass = document.getElementById('logpass').value;  
          
          $.ajax({
              url: '/authcrud/login',   
              type:"POST", 
              data: {
                  "loginid"    : ls_loginid ,
                  "logpass"  : ls_logpass, 
              },
              async:false,
              success:function(userFormDto){ 
                
                var ListDto = userFormDto;   
                var ls_userid = userFormDto["userid"]
                var ls_username = userFormDto["username"]
                var ls_cltcd= userFormDto["cltcd"]
                var ls_dbnm = userFormDto["dbnm"] 
                var ls_flag = userFormDto["flag"]  
                var ls_url = 'userid=' + ls_userid +'&username=' + ls_username +'&cltcd=' + ls_cltcd +'&dbnm=' + ls_dbnm +'&flag=' + ls_flag;  
                window.location.href = '/auth/emmsdashboard?' + ls_url;                          
                  // if(data == "success"){
                  //     alert("등록 되었습니다.");
                  //     var ls_text = "<div style='color:red'><span class='badge badge-soft-danger'>가입되었습니다.</span></div>";                                        
                  // }else{
                  //     alert("등록오류");
                  //     var ls_text = "<div style='color:red'><span class='badge badge-soft-info'>가입실패</span></div>";                                        
                  // } 
                  // statusdis_div.innerHTML  = ls_text;   

                
              },error:function(e){
                  console.log('error',e);
              }
          }).done(function(fragment){           

          }) 

     })
     
</script>    
  </main>
  <!-- ===============================================-->
  <!--    End of Main Content-->
  <!-- ===============================================-->

  <footer th:replace="layouts/XRegister/footer :: footerFragment"></footer>
</body>

</html>