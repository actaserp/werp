<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head th:replace="layouts/APPHeader/appheadcontroll :: headFragment" />

<body style="background: #f5f9fa;">
    <header>

    </header>
    <div class="content flex">
        
            <div class="header on">
                <div class="left">
                    <div class="ham">
                        <button type="button"><img th:src="@{/assets/images/ham.png}"   alt=""></button>
                    </div>
                    <div class="nav_bg"></div>
              
                        <!-- ################################ -->
                        <!-- ## Left navigator include -->
                        <th:block th:include="layouts/APPHeader/appLeftNav" />
                </div>
                <div class="right">           
                </div>
            </div> 
            <div class="con" style="padding-top: 103px;">
                <div class="header_top">
                    <ul class="left">
                        <li>
                            <div class="logo">
                                <a href="">
                                    <img th:src="@{/assets/images/logo.png}" alt="">
                                </a>
                            </div>
                        </li>
                        <li class="home">
                            <a href=""><img th:src="@{/assets/images/i_home.png}" alt=""></a>
                            <a href=""><img th:src="@{/assets/images/i_home_on.png}" alt=""></a>
                        </li>
                        <li>
                            고객상담센터
                        </li>
                        <li class="on">
                            고장접수관제현황
                        </li>
                    </ul>
                    <ul class="right">
                        <li>
                            <a href="">
                                <img th:src="@{/assets/images/i_call.png}" alt="">
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <img th:src="@{/assets/images/i_bell.png}" alt="">
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <img th:src="@{/assets/images/i_menu.png}" alt="">
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <img th:src="@{/assets/images/i_que.png}" alt="">
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <img th:src="@{/assets/images/i_user.png}" alt="">
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="infor_bar except">
                    <ul class="left">
                        <li>
                            <i><img th:src="@{/assets/images/i_circle1.png}" alt=""></i>
                            금일수신 <span><div data-countup='{"endValue":50}'>0</div></span>
                        </li>
                        <li>
                            <i><img th:src="@{/assets/images/i_circle2.png}" alt=""></i>
                            고장접수 <span><div data-countup='{"endValue":85}'>0</div></span>
                        </li>
                        <li>
                            <i><img th:src="@{/assets/images/i_circle3.png}" alt=""></i>
                            콜백예약 <span><div data-countup='{"endValue":20}'>0</div></span>
                        </li>
                        <li>
                            <i><img th:src="@{/assets/images/i_circle4.png}" alt=""></i>
                            당일처리 <span><div data-countup='{"endValue":77}'>0</div></span>
                        </li>
                    </ul>
                    <ul class="right">
                        <li>
                            <button type="button" class="color1">
                                금일접수현황
                            </button>
                        </li>
                        <li>
                            <button type="button" class="color2">
                                접수현황 모두보기
                            </button>
                        </li>
                        <li>
                            <button type="button" class="color3">
                                기사현황 모두보기
                            </button>
                        </li>
                    </ul>
    
                </div>
                <div class="section control">
    
                    <div class="sec_con" style="width: 20%;">
                        <div class="date_wrap">
                            <input type="text"  class="form-control datetimepicker" id="frdate" autocomplete="off"  placeholder="Y-m-d"     >
                            <!-- <span>-</span> -->
                            <input type="text"  class="form-control datetimepicker" id="todate" autocomplete="off"  placeholder="Y-m-d"     >
                        </div>
                        <div class="box_wrap in_tit"   >
                            <div class="tit">접수현황 LIST</div>
                            <div class="search">
                                <div class="input_wrap">
                                    <input type="text" placeholder="현장명" id="actnmz" name="actnmz">
                                </div>
                                <button type="button" onclick="search_rtn()">
                                    <img th:src="@{/assets/images/i_search.png}" alt="">
                                </button>
                            </div>     
                            <div id="retrieveDiv">
                                <ul class="check_list scrollbar" style="overflow-y: scroll; height: 610px; width: 370px;" >  
                                    
                                    <li class="receipt" th:each="formdata: ${app03DtoList}" >
                                        <div class="left">
                                            <div class="img">
                                                <i><img th:src="@{/assets/images/status1.png}" alt=""></i>
                                                <div class="badge bg-info" th:text="${formdata.recedate} ">접수일자</div>
                                                <div class="badge bg-primary" th:text="${formdata.recetime}">접수시간</div>
                                                <!-- <h9 th:text="${formdata.recedate}">고장접수</h9>&nbsp;<span th:text="${formdata.recetime}"></span> -->
                                            </div>
                                            <div class="number">
                                                <h9 th:text="${formdata.actnm}">삼성리더스타워</h9><br>
                                                <h10 th:text="${formdata.tel}">02-6959-5020</h10>
                                            </div>
                                        </div>
                                        <div class="name" th:text="${formdata.actpernm}">홍길동</div> 
                                    </li>    
                                    
                                </ul> 
                            </div>
                         </div> 
                         <!-- <input type="hidden" id="tempDiv"  > -->
                    </div>      
                    <div class="sec_con" style="width: 60%;">
                        <div class="box_wrap" style="padding: 0; position: relative;">
                            <div class="map_info" style="position:absolute; left: 20px; top: 20px; z-index: 2;">
                                <div class="top">
                                    <a href="">                                    
                                        <h5>삼성리더스타워</h5>
                                        <div class="arrow"><img th:src="@{/assets/images/arrow.png}" alt=""></div>
                                    </a>
                                </div>
                                <div class="mid" th:style="'background: url(/assets/images/map_img1.png) no-repeat center center;'">
                                    <div class="state">
                                        접수<br/>완료
                                    </div>
                                </div>
                                <div class="bottom">
                                    <div id="map" style="width:100%;height:550px;"></div>
                                    <div id="clickLatlng"></div>
                                </div>    
                                <script>
                                    var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
                                    mapOption = {    
                                            center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표     
                                            level: 3 // 지도의 확대 레벨   
                                    }; 
                                    // 지도를 표시할 div와  지도 옵션으로  지도를 생성합니다
                                    var map = new kakao.maps.Map(mapContainer, mapOption);
                                    // 일반 지도와 스카이뷰로 지도 타입을 전환할 수 있는 지도타입 컨트롤을 생성합니다
                                    var mapTypeControl = new kakao.maps.MapTypeControl();
                                    // 지도에 컨트롤을 추가해야 지도위에 표시됩니다
                                    // kakao.maps.ControlPosition은 컨트롤이 표시될 위치를 정의하는데 TOPRIGHT는 오른쪽 위를 의미합니다
                                    map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);
                            
                                    // 지도 확대 축소를 제어할 수 있는  줌 컨트롤을 생성합니다
                                    var zoomControl = new kakao.maps.ZoomControl();
                                    map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
                                    
                            
                                    
                                    
                                    //////////////////////// 여러개 마커 표시 //////////////////////////////
                                    
                                    // 마커를 표시할 위치와 title 객체 배열입니다 
                                    var positions = [
                                        {
                                            title: '카카오', 
                                            latlng: new kakao.maps.LatLng(33.450705, 126.570677)
                                        },
                                        {
                                            title: '생태연못', 
                                            latlng: new kakao.maps.LatLng(33.450936, 126.569477)
                                        },
                                        {
                                            title: '텃밭', 
                                            latlng: new kakao.maps.LatLng(33.450879, 126.569940)
                                        },
                                        {
                                            title: '근린공원',
                                            latlng: new kakao.maps.LatLng(33.451393, 126.570738)
                                        }
                                    ];
                            
                                    // 마커 이미지의 이미지 주소입니다
                                    var imageSrc = "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png"; 
                                        
                                    for (var i = 0; i < positions.length; i ++) {
                                        
                                        // 마커 이미지의 이미지 크기 입니다
                                        var imageSize = new kakao.maps.Size(24, 35); 
                                        
                                        // 마커 이미지를 생성합니다    
                                        var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize); 
                                        
                                        // 마커를 생성합니다
                                        var marker = new kakao.maps.Marker({
                                            map: map, // 마커를 표시할 지도
                                            position: positions[i].latlng, // 마커를 표시할 위치
                                            title : positions[i].title, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시됩니다
                                            image : markerImage // 마커 이미지 
                                        });
                                    }
                                    
                                    ////////////////////////커스텀 오버레이 //////////////////////////////
                                    
                                    // 커스텀 오버레이에 표시할 내용입니다     
                                    // HTML 문자열 또는 Dom Element 입니다 
                                    var content = '<div class="overlaybox">' +
                                        '    <div class="boxtitle">삼성리더스타워</div>' +
                                        '    <div class="first">' +
                                        '        <div class="triangle text">1</div>' +
                                        '        <div class="movietitle text">접수완료</div>' +
                                        '    </div>' +
                                        '    <ul>' +
                                        '        <li class="up">' +
                                        '            <span class="number">접수시간:10:00</span>' + 
                                        '            <span class="count">2</span>' +
                                        '        </li>' +
                                        '        <li>' +
                                        '            <span class="number">*</span>' +
                                        '            <span class="title">홍길동</span>' + 
                                        '            <span class="count">6</span>' +
                                        '        </li>' +
                                        '        <li>' +
                                        '            <span class="number">*</span>' +
                                        '            <span class="title">김길동</span>' + 
                                        '            <span class="count">6</span>' +
                                        '        </li>' +
                                        '        <li>' +
                                        '            <span class="number">갑자기 멈추는 현상발생</span>' + 
                                        '        </li>' + 
                                        '    </ul>' +
                                        '</div>';
                            
                                        
                                    // 커스텀 오버레이가 표시될 위치입니다 
                                    var position = new kakao.maps.LatLng(33.44943197104797, 126.57399084621109);  
                            
                                    // 커스텀 오버레이를 생성합니다
                                    var customOverlay = new kakao.maps.CustomOverlay({
                                        position: position,
                                        content: content,
                                        xAnchor: 0.3,
                                        yAnchor: 0.91
                                    });
                            
                                    // 커스텀 오버레이를 지도에 표시합니다
                                    customOverlay.setMap(map);
                                    
                                    
                                    
                                    
                                    ////////////////////////  지도에 마커표시 ////////////////////////////// 
                                    
                                    // 지도를 클릭한 위치에 표출할 마커입니다
                                    var marker = new kakao.maps.Marker({ 
                                        // 지도 중심좌표에 마커를 생성합니다 
                                        position: map.getCenter() 
                                    }); 
                                    // 지도에 마커를 표시합니다
                                    marker.setMap(map);
                            
                                    // 지도에 클릭 이벤트를 등록합니다
                                    // 지도를 클릭하면 마지막 파라미터로 넘어온 함수를 호출합니다
                                    kakao.maps.event.addListener(map, 'click', function(mouseEvent) {        
                                        
                                        // 클릭한 위도, 경도 정보를 가져옵니다 
                                        var latlng = mouseEvent.latLng; 
                                        
                                        // 마커 위치를 클릭한 위치로 옮깁니다
                                        marker.setPosition(latlng);
                                        
                                        var message = '클릭한 위치의 위도는 ' + latlng.getLat() + ' 이고, ';
                                        message += '경도는 ' + latlng.getLng() + ' 입니다';
                                        
                                        var resultDiv = document.getElementById('clickLatlng'); 
                                        resultDiv.innerHTML = message;
                                        
                                    });
                                </script>                                
                                <!-- <div class="bottom">
                                    <ul>
                                        <li>
                                            <div class="left">
                                                접수시간 10:00
                                            </div>
                                            <div class="right">
                                                2
                                            </div>
                                        </li>
                                        <li class="employee">
                                            <div class="left">
                                                홍길동
                                            </div>
                                            <div class="right">
                                                6
                                            </div>
                                        </li>
                                        <li class="employee">
                                            <div class="left">
                                                김길동
                                            </div>
                                            <div class="right">
                                                6
                                            </div>
                                        </li>
                                        <li>
                                            갑자기 멈추는 현상발생
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="map_pin" style="position:absolute; left: 400px; top: 400px; z-index: 1;">
                                <img th:src="@{/assets/images/map_pin.png}" alt="">
                            </div> -->
                        </div>
                    </div>
                    <div class="sec_con" style="width: 20%;">
                        <div class="box_wrap in_tit" style="background: #f4f4f4;">
                            <div class="tit">수리기사LIST</div>
                            <ul class="check_list scrollbar" style="overflow-y: scroll; height: 710px;">
                                <li>
                                    <div class="left">
                                        <h5>금천 자이 아파트</h5>
                                        <p>2022.10.15</p>
                                    </div>
                                    <div class="right">
                                        홍길동
                                    </div>
                                </li>
                                <li>
                                    <div class="left">
                                        <h5>금천 자이 아파트</h5>
                                        <p>2022.10.15</p>
                                    </div>
                                    <div class="right">
                                        홍길동
                                    </div>
                                </li>
                                <li>
                                    <div class="left">
                                        <h5>금천 자이 아파트</h5>
                                        <p>2022.10.15</p>
                                    </div>
                                    <div class="right">
                                        홍길동
                                    </div>
                                </li>
                                <li>
                                    <div class="left">
                                        <h5>금천 자이 아파트</h5>
                                        <p>2022.10.15</p>
                                    </div>
                                    <div class="right">
                                        홍길동
                                    </div>
                                </li>
                                <li>
                                    <div class="left">
                                        <h5>금천 자이 아파트</h5>
                                        <p>2022.10.15</p>
                                    </div>
                                    <div class="right">
                                        홍길동
                                    </div>
                                </li>
                                <li>
                                    <div class="left">
                                        <h5>금천 자이 아파트</h5>
                                        <p>2022.10.15</p>
                                    </div>
                                    <div class="right">
                                        홍길동
                                    </div>
                                </li>
                                <li>
                                    <div class="left">
                                        <h5>금천 자이 아파트</h5>
                                        <p>2022.10.15</p>
                                    </div>
                                    <div class="right">
                                        홍길동
                                    </div>
                                </li>
                                <li>
                                    <div class="left">
                                        <h5>금천 자이 아파트</h5>
                                        <p>2022.10.15</p>
                                    </div>
                                    <div class="right">
                                        홍길동
                                    </div>
                                </li>
                                <li>
                                    <div class="left">
                                        <h5>금천 자이 아파트</h5>
                                        <p>2022.10.15</p>
                                    </div>
                                    <div class="right">
                                        홍길동
                                    </div>
                                </li>
                                <li>
                                    <div class="left">
                                        <h5>금천 자이 아파트</h5>
                                        <p>2022.10.15</p>
                                    </div>
                                    <div class="right">
                                        홍길동
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

    </div>




                <!--------------------------------------------------------------------------------------->
                <!-- ###########  자료등록 #############################################################-->
                <!--------------------------------------------------------------------------------------->
                 

                <!--------------------------------------------------------------------------------------->
                <!-- ###########  첨부파일 미리보기######################################################-->
                <!--------------------------------------------------------------------------------------->
                
                 
    </div>


    <script type="text/javascript" th:inline="javascript">
        
    function search_rtn(){
        var ls_actnmz = document.getElementById('actnmz').value; 
        let ls_frdate = document.getElementById('frdate').value; 
        let ls_todate = document.getElementById('todate').value; 
        if(ls_actnmz == null || ls_actnmz.length == 0 || ls_actnmz == "" || ls_actnmz == "%"){ 
            ls_actnmz = "%";
        }  
        if(ls_frdate == null || ls_frdate.length == 0 || ls_frdate == "" || ls_frdate == "%"){ 
            alert("시작 일자를 입력하세요")
            return 
        }  
        if(ls_todate == null || ls_todate.length == 0 || ls_todate == "" || ls_todate == "%"){ 
            alert("종료 일자를 입력하세요")
            return 
        }  
        $.ajax({
                url: '/app01mod/emconlist',  
                type:"POST",
                data: { 
                    "frdate"      : ls_frdate,  
                    "todate"      : ls_todate ,  
                    "actnmz"      : ls_actnmz 
                }, 
                async:false,
                success:function(data){   
                    $("#retrieveDiv").replaceWith(data);  
                },error:function(e){
                    console.log("error"); 
                }
            }).done(function(fragment){           

            })       
    }     
    function listUp(){ 
        window.location.href = '/app01/emcontrol';          
        }
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


    $(document).ready(function() { 
            getToday()
            fn_egov_init_date()
            $('datetimepicker').datetimepicker({
                
            }); 

            $("#frdate").change(function(e){ 
                // console.log("달력클릭");
                // console.log(convert_time(e.timestamp));
            })
            $("#todate").change(function(e){ 
                // console.log("달력클릭");
                // console.log(convert_time(e.timestamp));
            })
        })

        function test_rtn(arg1){
            console.log(arg1);
            const disHtml = `
                <div class="tab-pane fade show active" id=${arg1} role="tabpanel" aria-labelledby="profile-tab">${arg1}</div>`
            $('#btnDiv02').before(disHtml);
        }


        function getToday(){
            let today = new Date();   

            let year = today.getFullYear(); // 년도
            let month = today.getMonth() + 1;  // 월
            let date = today.getDate();  // 날짜
            let day = today.getDay();  // 요일
            if(date > 0 && date < 10) {date = "0" + date};
            let ls_frday = year + '-' + month + '-' + date 
            let ls_today = year + '-' + month + '-' + date 
            document.getElementById('frdate').value = ls_frday;
            document.getElementById('todate').value = ls_today;
        }

        function convert_time(timestamp){ 
            //현재시간
            var date = new Date(timestamp); 
            var year = date.getFullYear();
            var month = ("0" + (1 + date.getMonth())).slice(-2);
            var day = ("0" + date.getDate()).slice(-2); 
            var hh = date.getHours();  
            var min = ('0' + date.getMinutes()).slice(-2) 
            time = year +  month +  day   ;
            return time;  
        }

        function fn_egov_init_date(){
            var $frdate = $('#frdate');
            var $todate = $('#todate');
            $frdate.datetimepicker({
                timepicker: false,
                lang: 'ko',
                format: 'Y-m-d',
                scrollMonth: false,
                scrollInput: false,
                onShow: function (ct) {                                    
                    this.setOptions({
                        // maxDate: $frdate.val() ? $frdate.val() : false
                    })
                },
            });

            $todate.datetimepicker({
                timepicker: false,
                lang: 'ko',
                format: 'Y-m-d',    //'Y-m-d H:i',
                scrollMonth: false,
                scrollInput: false,
                onShow: function (ct) {
                    this.setOptions({
                        // minDate: $todate.val() ? $todate.val() : false
                    })
                }
            });

        }

    </script>

    <!------footer ------>
    <footer th:replace="layouts/APPHeader/appfooter :: footerFragment"></footer> 


    <!-- modal -->
    <!-- class="modal_step_open" modal_step="1" -->
    
    <div class="modal modal modal_step modal_step1 hidden">
        <div class="modal_overlay">
        </div>
        <div class="modal_content modal_sm scrollbar">
            <div class="layoutCont">  
                <div class="modalContWrap">
                    <!-- <div class="modal_close cancerButton">
                      <img th:src="@{/assets/images/modal_close.png}" alt="모달 닫기버튼">
                    </div>                       -->
                    <div class="modal_head">
                    </div>
                    <div class="modal_con scrollbar">
                      모든 정보를 입력하세요.                          
                    </div>

                </div>
                <div class="modal_btn">
                    <button class="cancerButton " type="button">확인</button>
                </div>
                <!-- <div class="modal_btn flex">
                    <button class="cancerButton " type="button">확인</button>
                    <button class="cancerButton " type="button">확인</button>                        
                </div> -->
            </div>
        </div>
    </div>
    
</body>
</html>