<html lang="ko">
<head>
    <!-- css -->
    <link rel="stylesheet" th:href="@{/assets/css/reset.css}"  >
    <link rel="stylesheet" th:href="@{/assets/css/common.css}" >
    <link rel="stylesheet" th:href="@{/assets/css/sub.css}"  >

    <!-- script -->
    <script  th:src="@{/assets/scripts/jquery-3.1.1.min.js}"  ></script>
    <script  th:src="@{/assets/scripts/script.js}"  ></script>
    
    
    <style>
        #Fom1 {
            position: fixed;
            top: 6%;
            left: 2.2%;
            width: 100%;
            height: 100%;
            display: flex;
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        #Fom2{
            background-color: rgba(0, 0, 0, 0.5);
            width: 98%;
            height: 100%;
            position: absolute;
            z-index: 24;
        }
        #Fom3{

            width: 98%;
            height: 100%;
            overflow: hidden;
            background: #f5f9fa;
            border-radius: 0px;
            box-shadow: 0.125rem 0.125rem 1.25rem 0.25rem rgb(0 0 0 / 1%);
        }

    </style>
</head>
<head th:replace="layouts/APPHeader/apphead :: headFragment" />
<body style="background: #f5f9fa;"> 
<div class="content flex">
    <div class="header">
        <div class="left">
            <div class="ham">
                <button type="button"><img th:src="@{/assets/images/ham.png}" alt=""></button>

            </div>
            <div class="nav_bg"></div>
        
            <!-- ################################ -->
            <!-- ## Left navigator include -->
            <th:block th:include="layouts/APPHeader/appLeftNav" />
        </div>
        <div class="right">
        </div>
    </div>
    <div class="con">
        <div class="header_top">
            <ul class="left">
                <li>
                    <div class="logo">                              
                        <a th:href="@{/auth/emmsdashboard}">
                            <img th:src="@{/assets/images/logo.png}" alt="">
                        </a>
                    </div>
                </li>
                <li class="home on">
                    <a> <img th:src="@{/assets/images/i_home.png}" alt=""></a>
                    <a><img th:src="@{/assets/images/i_home_on.png}" alt=""></a>

                </li>
                <li th:text="${userformDto.pagetree01}"></li>
                <li class="on" th:text="${userformDto.pagenm}"></li> 
                <!-- <li>
                    고장접수관제현황
                </li> -->
            </ul>
            <ul class="mid">
                <li>
                    <i><img th:src="@{/assets/images/i_circle1.png}" alt=""></i>

                    <p>계약현장 <span>50</span></p>
                </li>
                <li>
                    <i><img th:src="@{/assets/images/i_circle2.png}" alt=""></i>
                    <p>계약관리대수 <span>50</span></p>
                </li>
                <li>
                    <i><img th:src="@{/assets/images/i_circle3.png}" alt=""></i>
                    <p>당월고장접수 <span>50</span></p>
                </li>
                <li>
                    <i><img th:src="@{/assets/images/i_circle4.png}" alt=""></i>
                    <p>금일고장접수 <span>50</span></p>
                </li>
            </ul>
            <ul class="right">
                <li>
                    <a href="">
                        <img th:src="@{/assets/images/i_call.png}" alt="">
                    </a>
                </li>
                <li>
                    <a href="">
                        <img th:src="@{/assets/images/i_bell.png}" alt="">
                    </a>
                </li>
                <li>
                    <a href="">
                        <img th:src="@{/assets/images/i_menu.png}" alt="">
                    </a>
                </li>
                <li>
                    <a href="">
                        <img th:src="@{/assets/images/i_que.png}" alt="">
                    </a>
                </li>
                <li>
                    <a href="">
                        <img th:src="@{/assets/images/i_user.png}" alt="">
                    </a>
                </li>
            </ul>
        </div>

        <!-- modal -->
        <!-- class="modal_step_open" modal_step="1" -->
        <!-- 기획서와 디자인을 봐도 해당 모달이 어디로 부터 나오는지 알 수 없어서 페이지를 따로 만듬 -->
        <div class="modal modal modal_step modal_stepKt " id="Fom1"> <!-- 클래스 hidden으로 감추고 생성 -->
            <div class="modal_overlay" id="Fom2">
            </div>
            <div class="modal_content modal_wd scrollbar" id="Fom3">
                <div class="layoutCont">
                    <div class="modalContWrap">
                        <!-- <div class="modal_close cancerButton">
                          <img src="./assets/images/modal_close.png" alt="모달 닫기버튼">
                        </div>                       -->
                        <div class="modal_head">
                            <div class="infor_bar">
                                <ul class="left">
                                    <li>
                                        <i><img th:src="@{/assets/images/i_circle1.png}" alt=""></i>

                                        <p>금일수신 <span th:text="${app03DtoList03[0].callcount}"></span> </p>
                                    </li>
                                    <li>
                                        <i><img th:src="@{/assets/images/i_circle2.png}" alt=""></i>
                                        <p>고장접수 <span th:text="${app03DtoList03[0].rececnt}"></span></p>
                                    </li>
                                    <li>
                                        <i><img th:src="@{/assets/images/i_circle3.png}" alt=""></i>
                                        <p>콜백예약 <span th:text="${app03DtoList03[0].callback}"> </span>  </p>
                                    </li>
                                    <li>
                                        <i><img th:src="@{/assets/images/i_circle4.png}" alt=""></i>
                                        <p>당일처리 <span th:text="${app03DtoList03[0].compcnt}"></span></p>
                                    </li>
                                </ul>
                                <ul class="mid">
                                    <li>
                                        <button type="button" class="color2">
                                            승강기번호조회
                                        </button>
                                    </li>
                                    <li>
                                        <div class="input_wrap">
                                            <input type="text" id="elvnum" name="elvnum">
                                        </div>
                                        <button onclick="getElvnum();">
                                            <img th:src="@{/assets/images/call.png}" alt="">
                                        </button>
                                    </li>
                                </ul>
                                <div class="right">
                                    <div class="input_wrap">
                                        <h5>콜 API ID</h5>
                                        <input type="text" id="calluserid" th:value="${userformDto.calluserid}"  disabled>
                                    </div>
                                    <div class="input_wrap">
                                        <h5>PW</h5>
                                        <input type="password" id="calluserpw" th:value="${userformDto.calluserpw}" disabled>
                                    </div>
                                    <!-- <div class="button button1"><button onclick="menu01_btn();"><img th:src="@{/assets/images/in1.png}" alt=""></button></div> -->
                                    <div class="button button2"><button><img th:src="@{/assets/images/in2.png}" alt="로그아웃하시겠습니까?" onclick="logout()"></button></div>
                                    <!-- <div class="modal_close cancerButton"><button><img th:src="@{/assets/images/modal_close.png}" alt=""></button></div> -->

                                </div>

                            </div>
                        </div>
                        <div class="modal_con scrollbar auto_height" style="overflow-y: scroll; height: 86%;">
                            <div class="board">
                                <div class="part1" style="width: 65%;">
                                    <ul class="btn_list">
                                        <li>
                                            <button class="type1 color1 modal_step_open2" type="button" id="wcallbackBtn">콜백리스트</button>
                                        </li>
                                        <li>
                                            <button class="type1" type="button" id="wphonebookBtn">전화번호부</button>
                                        </li>
                                        <li>
                                            <button class="type1 color1 modal_step_open2" modal_step="Inquiry" type="button"  id="wactcdlistBtn">보수현장조회</button>
                                        </li>
                                    </ul>

                                    <div class="part1_top ">
                                        <div class="left modal_box"  >
                                            <div class="title">
                                                고장접수현황
                                            </div>
                                            <div class="con_wrap">
                                                <div>
                                                    <table>
                                                        <tbody>
                                                        <tr>
                                                            <td>
                                                                <div class="input_wrap date">
                                                                    <input type="text"  class="form-control datetimepicker" id="frdate" autocomplete="off"  placeholder="Y-m-d"  style="background: url(/assets/images/i_cal.png) no-repeat #fff 98% 50%/15px auto;"   >
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <div class="input_wrap date">
                                                                    <input type="text"  class="form-control datetimepicker" id="todate" autocomplete="off"  placeholder="Y-m-d"   style="background: url(/assets/images/i_cal.png) no-repeat #fff 98% 50%/15px auto;"   >
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <div class="search">
                                                                    <div class="input_wrap">
                                                                        <input type="text" placeholder="현장명" id="searchactnmz" name="searchactnmz">
                                                                    </div>
                                                                    <button onclick="search_rtn()">
                                                                        <img th:src="@{/assets/images/i_search.png}" alt="">
                                                                    </button>
                                                                </div>    
                                                            </td>
                                                        </tr>
                                                        
                                                        </tbody>
                                                    </table>   
                                                </div>
                                                <div id="ktretrieveDiv">
                                                    <ul class="status_list scrollbar" style="overflow-y: scroll; height: 380px;"> 
                                                        <li class="receipt" th:each="formdata: ${app03DtoList}" >
                                                            <div class="left">
                                                                <div class="img">
                                                                    <i><img th:src="@{/assets/images/status1.png}" alt=""></i> 
                                                                    <p>고장접수</p>
                                                                </div>
                                                                <div class="number">
                                                                    <span th:text="${formdata.recedate}">23.01.01</span>(<span th:text="${formdata.recetime}">00:00</span>)&nbsp;&nbsp;
                                                                    <a href="#" th:id="${formdata.actnm}" th:onclick="mod_fnc([[${formdata.recedateyear}]],[[${formdata.recenum}]],[[${formdata.recetime}]],[[${formdata.hitchdate}]],[[${formdata.hitchhour}]],[[${formdata.actcd}]],[[${formdata.actnm}]],[[${formdata.equpcd}]],[[${formdata.equpnm}]],[[${formdata.reperid}]],[[${formdata.repernm}]],[[${formdata.perid}]],[[${formdata.pernm}]],[[${formdata.contcd}]],[[${formdata.contnm}]],[[${formdata.contents}]],[[${formdata.remark}]],[[${formdata.handphone}]])" th:text="${formdata.actnm}"><h4 th:text="${formdata.actnm} ">삼성리더스타워</h4></a><br>
                                                                    <span th:text="${formdata.contnm}">고장내용</span><br>
                                                                    <span th:text="${formdata.contents}">고장내용</span>
                                                                </div>
                                                            </div>
                                                            <div class="name"><span th:text="${formdata.tel}">02-6959-5020</span></div>
                                                        </li> 
                                                      
                                                    </ul>
                                                </div>
                                                <!-- <div class="inquiry_btn">
                                                    <button class="type1 color2">조회</button>
                                                </div> -->
                                            </div>
                                        </div>
                                        <div class="right modal_box"  >
                                            <div class="title">
                                                고장 접수 
                                            </div>
                                            <form action="">
                                                <div class="table table_style1">
                                                    <table>
                                                        <tbody>
                                                        <tr>
                                                            <th>접수일자</th>
                                                            <td>
                                                                <div class="input_wrap date">
                                                                    <input type="text"  class="form-control datetimepicker"  name="actrecedatez" id="actrecedatez" autocomplete="off"  placeholder="Y-m-d"  style="background: url(/assets/images/i_cal.png) no-repeat #fff 98% 50%/15px auto;"   >
                                                                    <input type="hidden" id="actrecenumz" name="actrecenumz">
                                                                </div>
                                                            </td>
                                                            <th>접수시간</th>
                                                            <td>
                                                                <div class="input_wrap date">
                                                                    <input type="time"  id="actrecetimez" autocomplete="off" >
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th>고장일자</th>
                                                            <td>
                                                                <div class="input_wrap date">
                                                                    <input type="text"  class="form-control datetimepicker"  name="acthitchdatez" id="acthitchdatez" autocomplete="off"  placeholder="Y-m-d"  style="background: url(/assets/images/i_cal.png) no-repeat #fff 98% 50%/15px auto;"   >                                                                    
                                                                </div>
                                                            </td>
                                                            <th>고장시간</th>
                                                            <td>
                                                                <div class="input_wrap date"> 
                                                                    <input type="time"  id="acthitchhourz" autocomplete="off"  >
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th>현장명</th>
                                                            <td>
                                                                <div class="input_wrap table_search">
                                                                    <input type="text" id="actactnmz" name="actactnmz">
                                                                    <input type="hidden" id="actactcdz" name="actactcdz">
                                                                    <button class="btn1" type="button" id="wactnmBtn"><img th:src="@{/assets/images/i_search2.png}" alt=""></button>

                                                                </div>
                                                            </td>
                                                            <th>호기명</th>
                                                            <td>
                                                                <div class="input_wrap table_search">
                                                                    <input type="text" id="actequpnmz" name="actequpnmz">
                                                                    <input type="hidden" id="actequpcdz" name="actequpcdz">
                                                                    <button class="btn1" type="button"  id="wequpnmBtn"><img th:src="@{/assets/images/i_search2.png}" alt=""></button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th>접수자</th>
                                                            <td>
                                                                <div class="input_wrap table_search">
                                                                    <input type="text" id="actrepernmz" name="actrepernmz">
                                                                    <input type="hidden" id="actreperidz" name="actreperidz">
                                                                    <button class="btn1" type="button"   id="wrepernmBtn"><img th:src="@{/assets/images/i_search2.png}" alt=""></button>
                                                                </div>
                                                            </td>
                                                            <th>통보자<br/>(담당기사)</th>
                                                            <td>
                                                                <div class="input_wrap table_search">
                                                                    <input type="text" id="actpernmz" name="actpernmz">
                                                                    <input type="hidden" id="actperidz" name="actperidz">
                                                                    <button class="btn1" type="button"  id="wpernmBtn"><img th:src="@{/assets/images/i_search2.png}" alt=""></button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th>고장내용</th>
                                                            <td colspan="3">
                                                                <div class="input_wrap table_search">
                                                                    <input type="text" id="actcontnmz" name="actcontnmz">
                                                                    <input type="hidden" id="actcontcdz" name="actcontcdz">
                                                                    <button class="btn1" type="button"  id="wcontnmBtn"><img th:src="@{/assets/images/i_search2.png}" alt=""></button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th>고장<br>상세내용</th>
                                                            <td colspan="3">
                                                                <div class="input_wrap">
                                                                    <input type="text" id="actcontentsz" name="actcontentsz">
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th>비고</th>
                                                            <td colspan="3">
                                                                <div class="input_wrap">
                                                                    <input type="text" id="actremarkz" name="actremarkz">
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                    <div>
                                                        <div class="btns">                                                        
                                                                <!-- <button class="type1 color3 modal_step_open2" modal_step="Message"  style="min-width: 90px;" type="button">문자전송</button> -->
                                                                <!-- <button class="type1 color2" style="min-width: 90px;"  onclick="new_rtn()">신규</button> -->
                                                                <button class="btn btn-outline-secondary me-1 mb-1"  id="wsmsBtn" type="button"  >문자전송</button> 
                                                                <button class="btn btn-outline-danger me-1 mb-1"  type="button" onclick="delE401_rtn()">삭&nbsp;&nbsp;제<span class="fas fa-trash ms-1" data-fa-transform="shrink-3"></span></button>
                                                                <button class="btn btn-outline-info me-1 mb-1"  type="button" onclick="new_rtn()"><span class="fas fa-plus me-1" data-fa-transform="shrink-3"></span>신&nbsp;&nbsp;규</button>                                                                
                                                                <button class="btn btn-outline-warning me-1 mb-1"  type="button" onclick="saveE401_rtn()">저&nbsp;&nbsp;장</button>
                                                                <!-- <button class="type1 color4" style="min-width: 90px;" >저장</button>         -->
                                                                
                                                                
                                                        </div>
                                                    </div>    
                                                </div>

                                            </form>
                                        </div>
                                    </div>
                                    <!-- <div class="part1_bottom">
                                        <div class="modal_box">
                                            <div class="title toggle" style="cursor: pointer;">
                                                <h5>KT CTI</h5>
                                                <button><img th:src="@{/assets/images/toggle.png}" alt=""></button>
                                            </div>
                                            <div class="con_wrap toggle_box" style="display: none;">
                                                <div class="left">
                                                    <ul class="font_title">
                                                        <li class="color1" style="height: 31px;">통화내역리스트</li>
                                                        <li style="height: 64px;">문자전송</li>
                                                        <li style="height: 31px;">착신전환</li>
                                                    </ul>
                                                </div>
                                                <div class="mid" style="width: 43%">
                                                    <div class="input_wrap">
                                                        <h5>통화내역종류</h5>
                                                        <select name="" id="">
                                                            <option value="">
                                                                정상통화
                                                            </option>
                                                        </select>
                                                        <h5 style="width: 80px;">통화건수</h5>
                                                        <input type="text">
                                                        <div class="btns">
                                                            <button class="type1 color3" style="height: 31px;">부재중리스트</button>
                                                        </div>
                                                    </div>
                                                    <div class="input_wrap">
                                                        <h5>발신번호</h5>
                                                        <input type="text">
                                                    </div>
                                                    <div class="input_wrap">
                                                        <h5>문자메세지</h5>
                                                        <input type="text">
                                                    </div>
                                                    <div class="input_wrap">
                                                        <h5>변경할회선</h5>
                                                        <input type="text">
                                                        <select name="" id="" style="margin-left: 10px">
                                                            <option value="">
                                                                정상통화
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="right" style="width: 43%">
                                                    <div class="input_wrap">
                                                        <h5>통화내역종류</h5>
                                                        <select name="" id="">
                                                            <option value="">
                                                                전체
                                                            </option>
                                                        </select>
                                                        <h5 style="width: 80px;">통화건수</h5>
                                                        <input type="text">
                                                    </div>
                                                    <div class="input_wrap">
                                                        <h5>예약시간</h5>
                                                        <input type="text">
                                                        <div class="btns">
                                                            <button class="type1 color3" style="height: 31px;">예약전송</button>
                                                            <button class="type1 color2" style="height: 31px;">예약취소</button>
                                                        </div>
                                                    </div>
                                                    <div class="input_wrap">
                                                        <h5>회신번호</h5>
                                                        <input type="text">
                                                        <div class="btns">
                                                            <button class="type1 color3" style="height: 31px;">문자전송</button>
                                                        </div>
                                                    </div>
                                                    <div class="input_wrap">
                                                        <h5>착신번호</h5>
                                                        <input type="text">
                                                        <select name="" id="" style="margin-left: 10px">
                                                            <option value="">
                                                                정상통화
                                                            </option>
                                                        </select>
                                                        <div class="btns">
                                                            <button class="type1 color3" style="height: 31px;">착신전환</button>
                                                        </div>
                                                    </div>

                                                </div>

                                            </div>
                                        </div>
                                    </div> -->
                                    <div class="part_hide_grid">
                                        <div class="modal_box">
                                            <div class="title">
                                                <div class="btns"> 
                                                    <button class="type1 color4" style="min-width: 90px;"  type="button"  onclick="searchwSMS_rtn()">문자전송내역</button>
                                                </div>        
                                            </div>  
                                        
                                            <div class="box_wrap with_tit" style="padding: 0px;">
                                                <div class="container-fluid" style="padding: 0px;">
                                                    <div id="wsmsGrid_div" ></div>
                                                    <div id="tabPager01"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="part2" style="width: 33%;">
                                    <div class="modal_box">
                                        <div class="title">
                                            고객 통화 메모
                                        </div>
                                        <div class="form">
                                            <form action="">
                                                <div class="date_wrap">
                                                    <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">수신일자</span>                                                        
                                                        <input type="text"  class="form-control datetimepicker"  name="actcalldatez" id="actcalldatez" autocomplete="off"  placeholder="Y-m-d"  style="background: url(/assets/images/i_cal.png) no-repeat #fff 98% 50%/15px auto;"   > 
                                                    </div>
                                                    <!-- <h5>수신일자</h5> 
                                                    <div class="input_wrap date">
                                                        <input type="text"  class="form-control datetimepicker"  name="actcalldatez" id="actcalldatez" autocomplete="off"  placeholder="Y-m-d"  style="background: url(/assets/images/i_cal.png) no-repeat #fff 98% 50%/15px auto;"   >                                                                    
                                                    </div>  -->
                                                    <!-- <div class="input_wrap date"> 
                                                        <input type="time"  id="actcalltimez" autocomplete="off"  >
                                                        <input type="hidden"  id="actseqz"   >
                                                    </div>   -->
                                                    <!-- <div>
                                                        <div class="btns"> 
                                                            <button class="type1 color4" style="min-width: 90px;"  type="button"  onclick="delCall_rtn()">삭제</button>
                                                        </div>
                                                    </div>   
                                                    <div>
                                                        <div class="btns">
                                                            <button class="type1 color3" style="min-width: 90px;"  type="button"  onclick="newcall_rtn()">신규</button> 
                                                        </div>
                                                    </div>   
                                                    <div>
                                                        <div class="btns"> 
                                                            <button class="type1 color4" style="min-width: 90px;"  type="button"  onclick="saveCall_rtn()">등록</button>
                                                        </div>
                                                    </div> -->
                                                </div> 
                                                <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">수신시간</span>
                                                    <input type="time" class="form-control"  id="actcalltimez" autocomplete="off"  >
                                                    <input type="hidden"  id="actseqz"   >                                                        
                                                </div> 
                                                <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">고객명</span> 
                                                    <input type="text" class="form-control" name="actcallnmz" id="actcallnmz">                                                    
                                                </div> 
                                                <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">전화번호</span> 
                                                    <input type="text" class="form-control"  name="actcallnumz" id="actcallnumz">                                               
                                                </div> 
                                                <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">콜백예약</span> 
                                                    <input type="checkbox" id="callbackflag" value="1">  
                                                    <label for="callbackflag" class="check_style1 no_txt"></label>                   
                                                </div>   
                                                <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">예약시간</span>
                                                    <input type="time" class="form-control" id="actcallbacktimez" autocomplete="off"  >
                                                </div> 
                                                <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">콜백메모</span> 
                                                    <input type="text" class="form-control"  name="actcallbackmemoz" id="actcallbackmemoz">                                               
                                                </div> 
                                                <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">메모내용</span>  
                                                    <textarea class="form-control" id="actcallmemoz" rows="3"></textarea>                                              
                                                </div>   
                                                <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">처리내용</span> 
                                                    <input type="text" class="form-control"  name="actcallendmemoz" id="actcallendmemoz">                                               
                                                </div>  
                                                <div class="input_wrap"  > 
                                                    <div>
                                                        <div class="btns"> 
                                                            <button class="type1 color2" style="min-width: 90px;"  type="button"  onclick="delCall_rtn()">삭제</button>
                                                        </div>
                                                    </div>   
                                                    <div>
                                                        <div class="btns">
                                                            <button class="type1 color3" style="min-width: 90px;"  type="button"  onclick="newcall_rtn()">신규</button> 
                                                        </div>
                                                    </div>   
                                                    <div>
                                                        <div class="btns"> 
                                                            <button class="type1 color4" style="min-width: 90px;"  type="button"  onclick="saveCall_rtn()">등록</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <!-- <div class="call_box">
                                            고객통화메모현황
                                        </div> -->
                                        <div class="message_list">
                                            <div class="top">
                                                <div>
                                                    <table>
                                                        <tbody>
                                                        <tr>
                                                            <td>
                                                                <div class="input_wrap date">
                                                                    <input type="text"  class="form-control datetimepicker" id="callfrdate" autocomplete="off"  placeholder="Y-m-d"  style="background: url(/assets/images/i_cal.png) no-repeat #fff 98% 50%/15px auto;"   >
                                                                </div>
                                                            </td> 
                                                            <td>
                                                                <div class="search">
                                                                    <div class="input_wrap">
                                                                        <input type="text" placeholder="고객명" id="searchcallnmz" name="searchcallnmz">
                                                                    </div> 
                                                                </div>    
                                                            </td>
                                                            <td>

                                                                <div class="btns">
                                                                    <button class="type1 color2" type="button" onclick="searchtel_rtn()">조회</button>
                                                                </div>
                                                            </td>
                                                        </tr> 
                                                        </tbody>
                                                    </table>   
                                                </div>

                                            </div>  
                                            <div id="ktretrieveDiv02">
                                                <ul class="client scrollbar" style="overflow-y: scroll; height: 257px;">
                                                    <li  th:each="formdata: ${app03TelList}" >
                                                        <div class="left">
                                                            <div class="user_icon" style="background: url(/assets/images/user.png) no-repeat center center;">
                                                            </div>
                                                            <div class="txt">
                                                                <!-- <h5><a href="#"  th:onclick="modtel_fnc([[${formdata.seq}]],[[${formdata.calldate}]],[[${formdata.calltime}]],[[${formdata.callnum}]],[[${formdata.callnm}]],[[${formdata.callmemo}]],[[${formdata.callbackflag}]],[[${formdata.callbacktime}]],[[${formdata.callbackmemo}]])" th:text="${formdata.callnm}">                                                                    
                                                                    부천프루지</a></h5><h5 th:text="${formdata.subcalltime}">12:00</h5>
                                                                <br><h5 th:text="${formdata.callmemo}">통화내용나오는곳 통화내용나오는곳  통화내용나오는곳  통화내용나오는곳  </h5> -->
                                                            </div> 
                                                        </div>
                                                        <div class="state">
                                                            <!-- <h5 th:text="${formdata.callnum}"> 02-1234-5678 </h5> -->
                                                        </div> 
                                                    </li> 
                                                </ul>
                                            </div> 

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <!-- 모달 문자전송 --><!-- 클래스 hidden으로 감추고 생성 -->
        <!-- <div class="modal modal modal_step modal_stepMessage hidden"> 
            <div class="modal_overlay">
            </div>
            <div class="modal_content modal_sm scrollbar">
                <div class="layoutCont">
                    <div class="modalContWrap">
                        <div class="modal_close2 cancerButton">
                            <img th:src="@{/assets/images/modal_close.png}" alt="">

                        </div>
                        <div class="modal_head">
                            문자전송
                        </div>
                        <div class="modal_con scrollbar auto_height" style="overflow-y: scroll;">
                            <div class="message_form">
                                <div class="input_wrap">
                                    <h5>발신번호</h5>
                                    <select name="" id="">
                                        <option value="">
                                            전체
                                        </option>
                                    </select>
                                </div>
                                <div class="input_wrap">
                                    <h5>수신번호</h5>
                                    <input type="text">
                                </div>
                                <div class="date_wrap input_wrap">
                                    <h5>예약전송</h5>
                                    <input type="text">
                                    <h5 style="width: 45px;">구분</h5>
                                    <select name="" id="">
                                        <option value="">단문</option>
                                    </select>
                                </div>
                                <div class="input_wrap">
                                    <h5>제목</h5>
                                    <input type="text">
                                </div>
                                <div class="input_wrap">
                                    <h5>부서</h5>
                                    <select name="" id="" >
                                        <option value="">

                                        </option>
                                    </select>
                                    <div class="btns">
                                        <button class="type1 color3" style="height: 31px;">선택</button>
                                    </div>
                                </div>
                                <div class="empoyee_location">
                                    부서별 직원 리스트 위치
                                </div>
                                <div class="button">
                                    <button>전송</button>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div> -->


        <!-- 모달 보수현장 조회 -->
        <div class="modal modal modal_step modal_stepInquiry hidden"> <!-- 클래스 hidden으로 감추고 생성 -->
            <div class="modal_overlay">
            </div>
            <div class="modal_content modal_md scrollbar">
                <div class="layoutCont">
                    <div class="modalContWrap">
                        <div class="modal_close2 cancerButton">
                            <img th:src="@{/assets/images/modal_close.png}" alt="">
                        </div>
                        <div class="modal_head">
                            보수현장조회
                        </div>
                        <div class="modal_con scrollbar auto_height" style="overflow-y: scroll;">
                            <div class="date_wrap">
                                <input type="text">
                                <span>-</span>
                                <input type="text">
                            </div>
                            <div class="input_wrap">
                                <select name="" id="">
                                    <option value=""></option>
                                </select>
                            </div>
                            <div class="chk_wrap">
                                <input type="checkbox" id="chk1">
                                <label for="chk1" class="check_style1">123</label>
                            </div>
                            <div class="radio_wrap">
                                <input type="radio" id="chk2">
                                <label for="chk2" class="radio_style1">123</label>
                            </div>
                            <!-- <div class="chk_wrap">
                                <input type="checkbox" id="chk1">
                                <label for="chk1" class="check_style1 no_txt"></label>
                            </div>
                            <div class="radio_wrap">
                                <input type="radio" id="chk2">
                                <label for="chk2" class="radio_style1 no_txt"></label>
                            </div> -->
                            <div class="btns">
                                <button class="type1 color5">검색</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <input class="form-control form-control-sm"  type="hidden" id="actnmbtn" data-bs-toggle="modal" data-bs-target="#actnmmodal"  />  
        <input class="form-control form-control-sm"  type="hidden" id="contnmbtn" data-bs-toggle="modal" data-bs-target="#actcontnmmodal"  /> 
        <input class="form-control form-control-sm"  type="hidden" id="repernmbtn" data-bs-toggle="modal" data-bs-target="#actrepernmmodal"  /> 
        <input class="form-control form-control-sm"  type="hidden" id="pernmbtn" data-bs-toggle="modal" data-bs-target="#actpernmmodal"  />                                 
        <input class="form-control form-control-sm"  type="hidden" id="equpnmbtn" data-bs-toggle="modal" data-bs-target="#actequpnmmodal"  />                               
        <input class="form-control form-control-sm"  type="hidden" id="elvnumbtn" data-bs-toggle="modal" data-bs-target="#actelvnummodal"  />                              
        <input class="form-control form-control-sm"  type="hidden" id="smsbtn" data-bs-toggle="modal" data-bs-target="#actsmsmodal01"  />                               
        <input class="form-control form-control-sm"  type="hidden" id="callbackbtn" data-bs-toggle="modal" data-bs-target="#actcallbackmodal"  /> 
        <input class="form-control form-control-sm"  type="hidden" id="phonebookbtn" data-bs-toggle="modal" data-bs-target="#actphonebookmodal"  /> 
        
        
        
    </div> 
</div>

    <!--------------------------------------------------------------------------------------->   
        <!-- 현장명 MODAL FROM  -->  
        <div class="modal fade" id="actnmmodal" data-bs-keyboard="false"
        data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
        aria-hidden="true">
            <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
                style="max-width: 800px">
                <div class="modal-content border-0">
                    <div class="modal-body p-0" > 
                        <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
                            <!-- <h4 class="mb-1" id="modalExampleDemoLabel">현장검색</h4>  -->
                            <div class="search">
                                <div class="input_wrap">
                                    <input class="form-control form-control-sm" id="searchwactnm" type="text"   onkeyup="if(window.event.keyCode==13){searchwactnm_rtn()}"
                                    placeholder="현장코드 / 현장명 "     />                                      
                                </div>
                                <button id="wactnmBtn">
                                    <img th:src="@{/assets/images/i_search.png}" alt="" onclick="searchwactnm_rtn()"> 
                                </button>
                            </div> 
                            <div  class="save_id" >
                                <input type="checkbox" id="conflag" value="1" checked>
                                <label for="conflag" class="check_style1">계약현장</label>
                            </div>
                        </div>   
                        <div class="container-fluid"> 
                            <div id="wactnmGrid_div" ></div>
                            <div id="thePager01"></div>
                        </div>   
                    </div>  

                    <div class="modal-footer">
                        <div class="row g-1">
                            <div class="col-auto">
                                <button class="badge-soft-primary dropdown-item rounded-1"
                                    type="button"  id="wactnmmodal_btn" data-bs-dismiss="modal">Close</button>
                            </div> 
                        </div>
                    </div>   

                </div>
            </div> 
        </div>  
<!--------------------------------------------------------------------------------------->     


<!--------------------------------------------------------------------------------------->   
        <!-- 고장내용 MODAL FROM  -->  
        <div class="modal fade" id="actcontnmmodal" data-bs-keyboard="false"
        data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
        aria-hidden="true">
            <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
                style="max-width: 500px">
                <div class="modal-content border-0">
                    <div class="modal-body p-0" > 
                        <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
                            <!-- <h4 class="mb-1" id="modalExampleDemoLabel">현장검색</h4>  -->
                            <div class="search">
                                <div class="input_wrap">
                                    <input class="form-control form-control-sm" id="searchwcontnm" type="text"   onkeyup="if(window.event.keyCode==13){searchwcontnm_rtn()}"
                                    placeholder="고장내용 "     />                                      
                                </div>
                                <button id="wcontnmBtn" onclick="searchwcontnm_rtn()">
                                    <img th:src="@{/assets/images/i_search.png}" alt="" > 
                                </button>
                            </div>  
                        </div>   
                        <div class="container-fluid"> 
                            <div id="wcontnmGrid_div" ></div>
                            <div id="thePager02"></div>
                        </div>   
                    </div>  

                    <div class="modal-footer">
                        <div class="row g-1">
                            <div class="col-auto">
                                <button class="badge-soft-primary dropdown-item rounded-1"
                                    type="button"  id="wcontnmmodal_btn" data-bs-dismiss="modal">Close</button>
                            </div> 
                        </div>
                    </div>   

                </div>
            </div> 
        </div>  
<!--------------------------------------------------------------------------------------->     

<!--------------------------------------------------------------------------------------->   
        <!-- 접수자 MODAL FROM  -->  
        <div class="modal fade" id="actrepernmmodal" data-bs-keyboard="false"
        data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
        aria-hidden="true">
            <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
                style="max-width: 500px">
                <div class="modal-content border-0">
                    <div class="modal-body p-0" > 
                        <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
                            <!-- <h4 class="mb-1" id="modalExampleDemoLabel">현장검색</h4>  -->
                            <div class="search">
                                <div class="input_wrap">
                                    <input class="form-control form-control-sm" id="searchwrepernm" type="text"   onkeyup="if(window.event.keyCode==13){searchwrepernm_rtn()}"
                                    placeholder="접수자 "     />                                      
                                </div>
                                <button id="wrepernmBtn" onclick="searchwrepernm_rtn()">
                                    <img th:src="@{/assets/images/i_search.png}" alt=""> 
                                </button>
                            </div>  
                        </div>   
                        <div class="container-fluid"> 
                            <div id="wrepernmGrid_div" ></div>
                            <div id="thePager03"></div>
                        </div>   
                    </div>  

                    <div class="modal-footer">
                        <div class="row g-1">
                            <div class="col-auto">
                                <button class="badge-soft-primary dropdown-item rounded-1"
                                    type="button"  id="wrepernmmodal_btn" data-bs-dismiss="modal">Close</button>
                            </div> 
                        </div>
                    </div>   

                </div>
            </div> 
        </div>  
<!--------------------------------------------------------------------------------------->     

<!--------------------------------------------------------------------------------------->   
        <!-- 통보자 MODAL FROM  -->  
        <div class="modal fade" id="actpernmmodal" data-bs-keyboard="false"
        data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
        aria-hidden="true">
            <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
                style="max-width: 500px">
                <div class="modal-content border-0">
                    <div class="modal-body p-0" > 
                        <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
                            <!-- <h4 class="mb-1" id="modalExampleDemoLabel">현장검색</h4>  -->
                            <div class="search">
                                <div class="input_wrap">
                                    <input class="form-control form-control-sm" id="searchwpernm" type="text"   onkeyup="if(window.event.keyCode==13){searchwpernm_rtn()}"
                                    placeholder="통보자 "     />                                      
                                </div>
                                <button id="wpernmBtn" onclick="searchwpernm_rtn()">
                                    <img th:src="@{/assets/images/i_search.png}" alt=""> 
                                </button>
                            </div>  
                        </div>   
                        <div class="container-fluid"> 
                            <div id="wpernmGrid_div" ></div>
                            <div id="thePager04"></div>
                        </div>   
                    </div>  

                    <div class="modal-footer">
                        <div class="row g-1">
                            <div class="col-auto">
                                <button class="badge-soft-primary dropdown-item rounded-1"
                                    type="button"  id="wpernmmodal_btn" data-bs-dismiss="modal">Close</button>
                            </div> 
                        </div>
                    </div>   

                </div>
            </div> 
        </div>  
<!--------------------------------------------------------------------------------------->     

<!--------------------------------------------------------------------------------------->   
        <!-- 호기 MODAL FROM  -->  
        <div class="modal fade" id="actequpnmmodal" data-bs-keyboard="false"
        data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
        aria-hidden="true">
            <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
                style="max-width: 500px">
                <div class="modal-content border-0">
                    <div class="modal-body p-0" > 
                        <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
                            <!-- <h4 class="mb-1" id="modalExampleDemoLabel">현장검색</h4>  -->
                            <div class="search">
                                <div class="input_wrap">
                                    <input class="form-control form-control-sm" id="searchwequpnm" type="text"   onkeyup="if(window.event.keyCode==13){searchwequpnm_rtn()}"
                                    placeholder="호기명 "     />                                      
                                </div>
                                <button id="wequpnmBtn" onclick="searchwequpnm_rtn()">
                                    <img th:src="@{/assets/images/i_search.png}" alt=""> 
                                </button>
                            </div>  
                        </div>   
                        <div class="container-fluid"> 
                            <div id="wequpnmGrid_div" ></div>
                            <div id="thePager05"></div>
                        </div>   
                    </div>  

                    <div class="modal-footer">
                        <div class="row g-1">
                            <div class="col-auto">
                                <button class="badge-soft-primary dropdown-item rounded-1"
                                    type="button"  id="wequpnmmodal_btn" data-bs-dismiss="modal">Close</button>
                            </div> 
                        </div>
                    </div>   

                </div>
            </div> 
        </div>  
<!--------------------------------------------------------------------------------------->  

<!--------------------------------------------------------------------------------------->   
        <!-- 승강기번호조회 MODAL FROM  -->  
        <div class="modal fade" id="actelvnummodal" data-bs-keyboard="false"
        data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
        aria-hidden="true">
            <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
                style="max-width: 500px">
                <div class="modal-content border-0">
                    <!-- <div class="modal-body p-0" >  
                        <div class="card overflow-hidden" style="width: 20rem;">
                            <div class="card-img-top"><img class="img-fluid" th:src="@{/assets/img/generic/3.jpg}" alt="Card image cap" /></div>
                            <div class="card-body">
                              <h5 class="card-title">Card title</h5>
                              <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                            </div>
                            <ul class="list-group list-group-flush">
                              <li class="list-group-item">Cras justo odio</li>
                              <li class="list-group-item">Dapibus ac facilisis in</li>
                              <li class="list-group-item">Vestibulum at eros</li>
                            </ul>
                            <div class="card-body"><a class="card-link" href="#!">Card link</a><a class="card-link" href="#!">Another link</a></div>
                          </div> 
                    </div>   -->
                    <div id="btnDiv" class="btn_wrap">
                    <div class="modal-footer">
                        <div class="row g-1">
                            <div class="col-auto">
                                <button class="badge-soft-primary dropdown-item rounded-1"
                                    type="button"  id="welvnummodal_btn" data-bs-dismiss="modal" >Close</button>
                            </div> 
                        </div>
                    </div>   

                </div>
            </div> 
        </div>  
     </div>   
<!--------------------------------------------------------------------------------------->  



    <!--------------------------------------------------------------------------------------->   
        <!--  SMS MODAL FROM  -->  
        <div class="modal fade" id="actsmsmodal01" data-bs-keyboard="false"
        data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
        aria-hidden="true">
            <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"  style="max-width: 570px">
                <div class="modal-content border-0"> 
                    <div class="modal_content modal_sm scrollbar" style="width:600px; height:800px">
                        <div class="layoutCont">
                            <div class="modalContWrap">
                                <!-- <div class="modal_close2 cancerButton">
                                    <img th:src="@{/assets/images/modal_close.png}" alt="닫기" data-bs-dismiss="modal"> 
                                </div>   -->
                                <div class="modal_head">
                                    문자전송
                                </div>
                                <div class="modal_con scrollbar auto_height" style="overflow-y: scroll;">
                                    <div class="message_form">
                                        <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">발신번호</span>
                                            <input class="form-control" type="text"   name="smscaller" id="smscaller"    th:value="${popsmsinfoDto.agnertel1}" disabled aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" />
                                        </div>


                                        <div class="container">
                                            <div class="row">
                                                <div class="col-8">
                                                    <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">수신번호</span>
                                                        <input class="form-control" type="text"  name="smstel" id="smstel"    aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" />
                                                    </div>              
                                                </div>
                                                <div class="col-4">
                                                    <button class="btn btn-falcon-warning me-1 mb-1" type="button" onclick="smsshot_rtn()">한건전송
                                                    </button>
                                                </div>
                                            </div>
                                        </div>      


                                        <div class="container">
                                            <div class="row">
                                                <div class="col-md-auto">
                                                    <select  name="smschk" id="smschk" class="form-select form-select-sm" aria-label=".form-select-sm example">
                                                        <!-- <option selected=""  >전송구분</option> -->
                                                        <option value="S" selected>단문</option>
                                                        <option value="M">장문</option>
                                                      </select> 
                                                </div>    
                                                <div class="col-4">
                                                    <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">발신자</span>
                                                        <input class="form-control" type="text"   name="smsrepernm" id="smsrepernm"      aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" />
                                                    </div>  
                                                </div>      
                                                <div class="col-4">
                                                    <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">수신자</span>
                                                        <input class="form-control" type="text"  name="smspernm" id="smspernm"  aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" />
                                                    </div>   
                                                </div>    
                                            </div>
                                        </div>
                                        <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">제목</span>
                                            <input class="form-control" type="text"  name="smssubject" id="smssubject"  aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" />
                                        </div>  
                                        <div class="input-group"><span class="input-group-text">전송내용</span>
                                            <textarea   name="smsmsg" id="smsmsg"  class="form-control" aria-label="With textarea" ></textarea>
                                        </div>   
                            
                                        <div class="input_wrap">
                                            <!-- <h5>부서</h5> -->
                                            <input type ="text" placeholder="부서를 선택하세요" name="" id=""  visible="false" disabled>
                                                
                                            </text>
                                            <div class="btns">
                                                <!-- <button class="type1 color3" style="height: 31px;">선택</button> -->
                                                <button> 단체전송</button>
                                            </div>
                                        </div>
                                        <div  class="container-fluid"> 
                                            <div class="col-auto">
                                                    <p> 현재 <b><span id="checked-count">0</span></b> 명이 선택되었습니다. </p>
                                                <!-- <div class="input-group">
                                                    <div class="input-group-text">작업자검색</div>
                                                    <input class="form-control form-control-sm" id="searchCode" type="text"  
                                                        placeholder="작업자명"     /> 
                                                    <button class="btn btn-falcon-warning me-1 mb-1" type="button" onclick="searchwperid_fnc()">검색
                                                    </button> 
                                                </div>  -->
                                            </div> 
                                        </div>                                         
                                        <div class="empoyee_location" style=" height:340px"> 
                                            <div id="theGrid"></div>
                                            <div class="container-fluid"> 
                                                <div id="wperidGrid_div" ></div> 
                                            </div>   
                                        </div> 
                                        <div class="button">
                                            <div class="col-auto"> 
                                                <button class="badge-soft-primary dropdown-item rounded-1"
                                                    type="button"  id="wsmsmodal_btn" data-bs-dismiss="modal" >Close</button>
                                            </div>       
                                        </div> 

                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div> 
            </div> 
        </div>  
<!--------------------------------------------------------------------------------------->     

 
<!--------------------------------------------------------------------------------------->   
    <!--  CALL BACK MODAL FROM  -->  
    <div class="modal fade" id="actcallbackmodal" data-bs-keyboard="false"
    data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
    aria-hidden="true">
        <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"  style="max-width: 750px">
            <div class="modal-content border-0"> 
               
                     
                        <div class="modalContWrap"> 
                            <div class="modal_con scrollbar auto_height" style="overflow-y: scroll;">
                                <div class="modal-body p-0" > 
                                    <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
                                        <!-- <h4 class="mb-1" id="modalExampleDemoLabel">현장검색</h4>  -->
                                        <div class="search">
                                            <div class="input_wrap">
                                                <select class="form-select form-select-sm" aria-label=".form-select-sm example" id="ddcallflag">                                                    
                                                    <option value="%">전체</option>
                                                    <option value="1" selected>콜백대기</option>
                                                    <option value="0">콜백처리</option>
                                                  </select>                        
                                            </div>
                                            <button id="wcallbkBtn"  >
                                                <img th:src="@{/assets/images/i_search.png}" alt=""> 
                                            </button>
                                        </div>  
                                    </div>   
                                    <div class="container-fluid"> 
                                        <div id="wcallbkGrid_div" ></div>
                                        <div id="thePager06"></div>
                                    </div>   
                                </div>  
            
                                <div class="modal-footer">
                                    <div class="row g-1">
                                        <div class="col-auto">
                                            <button class="badge-soft-primary dropdown-item rounded-1"
                                                type="button"  id="wcallbkmodal_btn" data-bs-dismiss="modal">Close</button>
                                        </div> 
                                    </div>
                                </div>   
                            </div>

                        </div>
                    
              
            </div> 
        </div> 
    </div>  
<!--------------------------------------------------------------------------------------->  



<!--------------------------------------------------------------------------------------->   
    <!--  전화번호부 MODAL FROM  -->  
    <div class="modal fade" id="actphonebookmodal" data-bs-keyboard="false"
    data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
    aria-hidden="true">
        <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"  style="max-width: 570px">
            <div class="modal-content border-0"> 
                        <div class="modalContWrap"> 
                            <div class="modal_con scrollbar auto_height" style="overflow-y: scroll;">
                                <div class="modal-body p-0" > 
                                    <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">                                        
                                        <div class="search">
                                            <div class="input_wrap">
                                                <input class="form-control form-control-sm" id="searchText" type="text"   onkeyup="if(window.event.keyCode==13){searchwphonebook_rtn()}"
                                                placeholder="고객명 / 전화번호 "     />                                      
                                            </div>                                        
                                            <button id="wphonebookBtn" onclick="searchwphonebook_rtn()">
                                                <img th:src="@{/assets/images/i_search.png}" alt=""> 
                                            </button>
                                        </div>  
                                    </div>   
                                    <div class="container-fluid"> 
                                        <div id="wphonebookGrid_div" ></div>
                                        <div id="thePager07"></div>
                                    </div>   
                                    <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">                                        
                                      
                                            <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">고객명</span>
                                                <input class="form-control" type="text" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" id="actactmailz"/>
                                                <input class="form-control" type="hidden" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" id="actactcdz"/>
                                                <input class="form-control" type="hidden" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" id="actseqz"/>
                                            </div>
                                            <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">전화번호</span>
                                                <input class="form-control" type="text" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" id="acttelz"/>
                                            </div>    
                                            <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">비고</span>
                                                <input class="form-control" type="text" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" id="actpbookremarkz"/>
                                            </div>    
                                            <button class="btn btn-falcon-danger me-1 mb-1" type="button" id="wphonebookDelBtn">삭제
                                            </button>   
                                            <button class="btn btn-falcon-info me-1 mb-1" type="button" id="wphonebookNewBtn">신규
                                            </button>                                       
                                            <button class="btn btn-falcon-primary  me-1 mb-1" type="button" id="wphonebookSaveBtn">저장
                                            </button>
                                        
                                    </div>   
                                </div>  
            
                                <div class="modal-footer">
                                    <div class="row g-1">
                                        <div class="col-auto">
                                            <button class="badge-soft-primary dropdown-item rounded-1"
                                                type="button"  id="wphonebookmodal_btn" data-bs-dismiss="modal">Close</button>
                                        </div> 
                                    </div>
                                </div>   
                            </div>

                        </div>
                     
                
            </div> 
        </div> 
    </div>  
<!--------------------------------------------------------------------------------------->  



    <!--------------------------------------------------------------------------------------->   
        <!--  보수현장조회 MODAL FROM  -->  
        <div class="modal fade" id="actactlistmodal" data-bs-keyboard="false"
        data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
        aria-hidden="true">
            <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"  style="max-width: 570px">
                <div class="modal-content border-0"> 
                    <div class="modal_content modal_sm scrollbar" style="width:600px; height:800px">
                        <div class="layoutCont">
                            <div class="modalContWrap">
                                <!-- <div class="modal_close2 cancerButton">
                                    <img th:src="@{/assets/images/modal_close.png}" alt="닫기" data-bs-dismiss="modal"> 
                                </div>   -->
                                <div class="modal_head">
                                    보수현장조회
                                </div>
                                <div class="modal_con scrollbar auto_height" style="overflow-y: scroll;">
                                    <div class="modal-body p-0" > 
                                        <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
                                            <!-- <h4 class="mb-1" id="modalExampleDemoLabel">현장검색</h4>  -->
                                            <div class="search">
                                                <div class="input_wrap">
                                                    <input class="form-control form-control-sm" id="searchwactlist" type="text"   onkeyup="if(window.event.keyCode==13){searchwactlist_rtn()}"
                                                    placeholder="호기명 "     />                                      
                                                </div>
                                                <button id="wactlistBtn" onclick="searchwactlist_rtn()">
                                                    <img th:src="@{/assets/images/i_search.png}" alt=""> 
                                                </button>
                                            </div>  
                                        </div>   
                                        <div class="container-fluid"> 
                                            <div id="wactlistGrid_div" ></div>
                                            <div id="thePager08"></div>
                                        </div>   
                                    </div>  
                
                                    <div class="modal-footer">
                                        <div class="row g-1">
                                            <div class="col-auto">
                                                <button class="badge-soft-primary dropdown-item rounded-1"
                                                    type="button"  id="wactlistmodal_btn" data-bs-dismiss="modal">Close</button>
                                            </div> 
                                        </div>
                                    </div>   
                                </div>

                            </div>
                        </div>
                    </div>
                </div> 
            </div> 
        </div>  
<!--------------------------------------------------------------------------------------->  

<script type="text/javascript" th:inline="javascript">
         
    var view_actnmpage;
    var view_contnmpage; 
    var view_repernmpage;
    var view_pernmpage;
    var view_equpnmpage;
    var view_wperidpage;
    var view_wsmspage;
    var view_callbackpage;
    var view_phonebookpage;
    let viewtest;
    var wactnmGrid;
    var wcontnmGrid; 
    var wrepernmGrid; 
    var wpernmGrid; 
    var wequpnmGrid; 
    var wsmsGrid; 
    var wcallbkGrid;
    var wphbookGrid;
    // var wperidGrid;
    let formData = new FormData(); 
    let formSMSData = new FormData();
   

    window.onload = function() {  
        
        //<!--문자전송내역  -->
        view_wsmspage = new wijmo.collections.CollectionView(getData_wlist("06"), {
            pageSize: 7
        });

        new wijmo.input.CollectionViewNavigator('#tabPager01', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_wsmspage
        });
        wsmsGrid = new wijmo.grid.FlexGrid('#wsmsGrid_div', {
            autoGenerateColumns: false,
            isReadOnly: true, 
            allowSorting: 'MultiColumn',
            selectionMode: 'RowRange',
            alternatingRowStep: 0,
            columns: [
                { binding: 'result', header: '결과',    align:"center",  isReadOnly: true,  width: '1*' }, 
                { binding: 'recedate', header: '일자', format: '*', align:"center", isReadOnly: true,  width: '1*' },
                { binding: 'recetime', header: '시간', align:"center",  isReadOnly: true ,  width: '1*'},
                { binding: 'pernm', header: '수신자명',   align:"center", isReadOnly: true , width: '1*'} ,
                { binding: 'sms_tel', header: '발신번호',    align:"center", isReadOnly: true,   width: '*'} ,
                { binding: 'flag', header: '수신확인',    align:"center", isReadOnly: true,  width: '1*' } ,                
                { binding: 'sms_text', header: '내용',    align:"left", isReadOnly: true,   width: '*'} ,
            ],
            itemsSource: view_wsmspage
        }); 

        //========================================================================================================





        //현장검색 popup list
        view_actnmpage = new wijmo.collections.CollectionView(getData_wlist("01"), {
            pageSize: 12
        });
        // 현장검색 페이지 이동
        new wijmo.input.CollectionViewNavigator('#thePager01', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_actnmpage
        });     
        wactnmGrid = new wijmo.grid.FlexGrid('#wactnmGrid_div', {  
            autoGenerateColumns: false,
            isReadOnly: false, 
            allowSorting: 'MultiColumn',
            selectionMode: 'RowRange',
            alternatingRowStep: 0,
            columns: [     
                { binding: 'actnm', header: '현장명', align: "center", width: '1*' }, 
                { binding: 'telno', header: '전화번호', align: "center", width: '1*' }, 
                { binding: 'addr', header: '주소', align: "center", width: '*' },  
            ], 
            itemsSource: view_actnmpage
        });  
        


        //고장내용검색 popup list
        view_contnmpage = new wijmo.collections.CollectionView(getData_wlist("02"), {
            pageSize: 12
        });
        // 고장내용검색 페이지 이동
        new wijmo.input.CollectionViewNavigator('#thePager02', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_contnmpage
        });     
        wcontnmGrid = new wijmo.grid.FlexGrid('#wcontnmGrid_div', {  
            autoGenerateColumns: false,
            isReadOnly: false, 
            selectionMode: 'RowRange',
            alternatingRowStep: 0,
            columns: [   
                { binding: 'contcd', header: '고장코드', align: "center", width: '1*' }, 
                { binding: 'contnm', header: '고장내용', align: "center", width: '1*' },  
            ], 
            itemsSource: view_contnmpage
        });   

        //접수자내용검색 popup list
        view_repernmpage = new wijmo.collections.CollectionView(getData_wlist("03"), {
            pageSize: 12
        });
        // 접수자검색 페이지 이동
        new wijmo.input.CollectionViewNavigator('#thePager03', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_repernmpage
        });     
        wrepernmGrid = new wijmo.grid.FlexGrid('#wrepernmGrid_div', {  
            autoGenerateColumns: false,
            isReadOnly: false, 
            selectionMode: 'RowRange',
            alternatingRowStep: 0,
            columns: [   
                { binding: 'reperid', header: '코드', align: "center", width: '1*' }, 
                { binding: 'repernm', header: '접수자', align: "center", width: '1*' },  
            ], 
            itemsSource: view_repernmpage
        });   

        //통보자내용검색 popup list
        view_pernmpage = new wijmo.collections.CollectionView(getData_wlist("04"), {
            pageSize: 12
        });
        //통보자검색 페이지 이동
        new wijmo.input.CollectionViewNavigator('#thePager04', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_pernmpage
        });     
        wpernmGrid = new wijmo.grid.FlexGrid('#wpernmGrid_div', {  
            autoGenerateColumns: false,
            isReadOnly: false, 
            selectionMode: 'RowRange',
            alternatingRowStep: 0,
            columns: [   
                { binding: 'perid', header: '코드', align: "center", width: '1*' }, 
                { binding: 'pernm', header: '통보자', align: "center", width: '1*' },  
            ], 
            itemsSource: view_pernmpage
        });  
 
        //호기내용검색 popup list
        view_equpnmpage = new wijmo.collections.CollectionView(getData_wlist("05"), {
            pageSize: 12
        });
        //호기검색 페이지 이동
        new wijmo.input.CollectionViewNavigator('#thePager05', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_equpnmpage
        });     
        wequpnmGrid = new wijmo.grid.FlexGrid('#wequpnmGrid_div', {  
            autoGenerateColumns: false,
            isReadOnly: false, 
            selectionMode: 'RowRange',
            alternatingRowStep: 0,
            columns: [   
                { binding: 'equpcd', header: '호기코드', align: "center", width: '1*' }, 
                { binding: 'equpnm', header: '호기명', align: "center", width: '1*' },  
            ], 
            itemsSource: view_equpnmpage
        });  



        //콜백리스트 popup list
        view_callbackpage = new wijmo.collections.CollectionView(getData_wlist("07"), {
            pageSize: 10
        });
        //콜백리스트 페이지 이동
        new wijmo.input.CollectionViewNavigator('#thePager06', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_callbackpage
        });     
        wcallbkGrid = new wijmo.grid.FlexGrid('#wcallbkGrid_div', {  
            autoGenerateColumns: false,
            isReadOnly: false, 
            selectionMode: 'RowRange',
            alternatingRowStep: 0,
            columns: [   
                { binding: 'callbackflag', header: '구분', align: "center", width: '1*' }, 
                { binding: 'callbacktime', header: '예약시간', align: "center", width: '1*' }, 
                { binding: 'callbackmemo', header: '콜백메모', align: "center", width: '1*' }, 
                { binding: 'callnm', header: '고객명', align: "center", width: '1*' }, 
                { binding: 'callnum', header: '연락처', align: "center", width: '1*' }, 
                { binding: 'calltime', header: '상담시간', align: "center", width: '1*' }, 
                { binding: 'callmemo', header: '상담내용', align: "center", width: '1*' }, 
            ], 
            itemsSource: view_callbackpage
        });  




        //전화번호부리스트 popup list
        view_phonebookpage = new wijmo.collections.CollectionView(getData_wlist("08"), {
            pageSize: 10
        });
        //전화번호부리스트 페이지 이동
        new wijmo.input.CollectionViewNavigator('#thePager07', {
            byPage: true,
            headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            cv: view_phonebookpage
        });     
        wphbookGrid = new wijmo.grid.FlexGrid('#wphonebookGrid_div', {  
            autoGenerateColumns: false,
            isReadOnly: false, 
            selectionMode: 'RowRange',
            alternatingRowStep: 0,
            columns: [   
                { binding: 'actcd', header: '코드', align: "center", width: '1*' }, 
                { binding: 'seq', header: '순번', align: "center", width: '1*' }, 
                { binding: 'actmail', header: '고객명', align: "center", width: '1*' }, 
                { binding: 'tel', header: '전화번호', align: "center", width: '1*' }, 
                { binding: 'remark', header: '비고', align: "center", width: '1*' },  
            ], 
            itemsSource: view_phonebookpage
        });          

        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
        //SMS 수리기사 검색 popup list
        let view_wperidpage = new wijmo.collections.CollectionView(getData_wperid()); 
        setGroups(true);
          let  wperidGrid = new wijmo.grid.FlexGrid('#wperidGrid_div', {
            deferResizing: true,
            showMarquee: true, 
            alternatingRowStep: 0,
            autoGenerateColumns: false, 
            columns: [    
                { binding: 'id', width: '1*', header: 'ID', width: '*', align:"center", format: '*' ,  isReadOnly: true },
                { binding: 'divinm', width: '1*', header: '부서', width: '*', align:"center", format: '*' ,  isReadOnly: true },  
                {
                    binding: 'wpernm',
                    width: '1*',
                    header: '작업자', 
                    align:"center",
                    cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({ 
                        text: '<b>${item.wpernm}</b>',
                        click: (e, ctx) => {
                            wperidChk(ctx.item.wperid, ctx.item.wpernm , ctx.item.handphone);
                        }
                    })
                }, 
                {
                    binding: 'handphone',
                    width: '2*',
                    header: '핸드폰', 
                    align:"center",
                    cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({ 
                        text: '<b>${item.handphone}</b>',
                        click: (e, ctx) => {
                            wperidChk(ctx.item.wperid, ctx.item.wpernm, ctx.item.handphone );
                        }
                    })
                } 

            ], 
            itemsSource: view_wperidpage
        });  
        // 선택기 생성
        let selector = new wijmo.grid.selector.Selector(wperidGrid, {
            itemChecked: () => {
                showCheckedCount();
            }
        }); 
        // console.log(selector)
        // 그룹 전환
        setGroups(true);
        // document.getElementById('groups').addEventListener('click', e => {
        //     setGroups(e.target.checked);
        // });
        function setGroups(groupsOn) {
            let groups = view_wperidpage.groupDescriptions;
            groups.clear();
            if (groupsOn) {
            groups.push(new wijmo.collections.PropertyGroupDescription('divinm'));
            }
        }
        // 헤더 열 전환
        setHeaderColumn(true);
        // document.getElementById('header').addEventListener('click', e => {
        //     setHeaderColumn(e.target.checked);
        // });
        function setHeaderColumn(headerOn) {            
            wperidGrid.headersVisibility = headerOn
            ? wijmo.grid.HeadersVisibility.All
            : wijmo.grid.HeadersVisibility.Column;
            selector.column = headerOn
            ? wperidGrid.rowHeaders.columns[0]
            : wperidGrid.columns[0];
        }
        // 체크된 항목 표시
        //showCheckedCount();
        function showCheckedCount() {
            let cnt = document.getElementById('checked-count'), sel = wperidGrid.rows.filter(r => r.isSelected);                                        
            // console.log("sel", sel) ;
            // var custcd = new Array();
            // var spjangcd = new Array(); 
            // var divicd = new Array();
            // var divinm = new Array();
            // var wperid = new Array();
            // var wpernm = new Array();
            // var handphone = new Array();
            // // e._p._rows[i]._data.qty
            // for (var i = 0; i < sel.length; i++) {
            //     custcd [i]   = sel[i]._data.custcd;
            //     spjangcd[i] = sel[i]._data.spjangcd; 
            //     divicd[i]  = sel[i]._data.divicd;
            //     divinm[i]  = sel[i]._data.divinm;
            //     wperid[i]   = sel[i]._data.wperid;
            //     wpernm [i]  = sel[i]._data.wpernm; 
            //     handphone [i]  = sel[i]._data.handphone; 
            //     // console.log('sel[i]._data.divicd', sel[i]._data.divicd);
            // }  
            // $.ajax({
            //     url: '/pop01/wpernm',  
            //     type:"post",
            //     data: {"custcd" : custcd,
            //             "spjangcd": spjangcd,
            //             "divicd" : divicd,
            //             "divinm" : divinm,
            //             "wperid" : wperid,
            //             "wpernm" : wpernm,
            //             "handphone" : handphone
            //             },
            //     contentType: "application/x-www-form-urlencoded; charset=UTF-8;",
            //     success:function(data){
            //         var result  = data;   
            //         console.log("result", result);
            //     },error:function(e){
            //         alert(data.code);
            //         alert(data.message);
            //     }
            // }).done(function(fragment){           

            // }) 



            //투입인원        
            cnt.textContent = sel.length.toString();
            console.log(sel.length.toString());
            // document.getElementById('inwinps').value = parseInt(sel.length.toString()); 
        }
        
        //지정된 레벨까지 collapse  특정 그룹에 대해서만 expand 
        wperidGrid.collapseGroupsToLevel(0);
        var count = 0;
        for (var j =0; j <  wperidGrid.rows.length - 1; j++) {
            if (wperidGrid.rows[j].hasChildren) { // 자식 행이 있는 경우
                if(wperidGrid.rows[j].level=== 1 && wperidGrid.rows[j].dataItem.name === "보수부"){ //계층 수준이 1이고 computer이면
                    wperidGrid.rows[j].isCollapsed = false;
                } 
            }
        }

        // 작업자 데이터 수집
        function getData_wperid(){

            var WperidDto = [[${wperidDto}]];   
            var data03 = [];
            var cnt = 1;
            for (var i = 0; i < WperidDto.length; i++) {
                data03.push({
                    id: i, 
                    index: cnt,
                    custcd:WperidDto[i]["custcd"], 
                    spjangcd:WperidDto[i]["spjangcd"], 
                    divicd:WperidDto[i]["divicd"],
                    divinm:WperidDto[i]["divinm"], 
                    wperid:WperidDto[i]["wperid"],  
                    wpernm: WperidDto[i]["wpernm"] ,  
                    handphone: WperidDto[i]["handphone"]   
                                                                     
                });
                cnt++;
            }  
            return data03                                          
        } 

        function pickOne(items) {
                return items[randBetween(0, items.length - 1)];
        }
        function randBetween(min, max) {
            return Math.floor(Math.random() * (max - min + 1) + min);
        }         
 





 

        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
        //popup data selectde 
        function getData_wlist(arg){   
            var wactnm_data = []; 
            var cnt = 1;
            switch(arg){
                case "01": 
                    // 현장검색 데이터 수집
                    for (var i = 0; i < 12; i++) {
                        wactnm_data.push({
                            id: i, 
                            index: cnt,
                            actnm: "",
                            telno: "",
                            addr: "", 
                        });
                        cnt++;
                      }                        
                    break;
                case "02":                 
                    // 고장내용검색 데이터 수집
                    for (var i = 0; i < 12; i++) {
                        wactnm_data.push({
                            id: i, 
                            index: cnt,
                            contcd: "",
                            contnm: "", 
                        });
                        cnt++;
                    }                        
                    break;
                case "03":
                    // 접수자검색 데이터 수집
                    for (var i = 0; i < 12; i++) {
                        wactnm_data.push({
                            id: i, 
                            index: cnt,
                            reperid: "",
                            repernm: "", 
                        });
                        cnt++;
                    }      
                    break;                    
                case "04":
                    // 통보자검색 데이터 수집
                    for (var i = 0; i < 12; i++) {
                        wactnm_data.push({
                            id: i, 
                            index: cnt,
                            perid: "",
                            pernm: "", 
                        });
                        cnt++;
                    }      
                    break;                    
                case "05":
                    // 호기검색 데이터 수집
                    for (var i = 0; i < 12; i++) {
                        wactnm_data.push({
                            id: i, 
                            index: cnt,
                            equpcd: "",
                            equpnm: "", 
                        });
                        cnt++;
                    }      
                    break;                     
                case "06":
                    // 문자전송내역 데이터 수집
                    for (var i = 0; i < 12; i++) {
                        wactnm_data.push({
                            id: i, 
                            index: cnt,
                            result: "",
                            recedate: "", 
                            recetime: "", 
                            pernm: "", 
                            sms_tel: "", 
                            flag: "", 
                            sms_text: "", 
                        });
                        cnt++;
                    }   
                    break;                        
                case "07":
                    // 콜백리스트
                    for (var i = 0; i < 12; i++) {
                        wactnm_data.push({
                            id: i, 
                            index: cnt,
                            seq: "",
                            callbackflag: "", 
                            callbacktime: "", 
                            callbackmemo: "", 
                            callnm: "", 
                            callnum: "", 
                            calldate: "", 
                            calltime: "", 
                            callmemo: "", 
                        });
                        cnt++;
                    }   
                    break;                          
                case "08":
                    // 전화번호부
                    for (var i = 0; i < 12; i++) {
                        wactnm_data.push({
                            id: i, 
                            index: cnt,
                            actcd: "",
                            seq: "", 
                            actmail: "", 
                            tel: "", 
                            remark: "", 
                        });
                        cnt++;
                    }   
                    break;                    
                default:
                    break;    

            }
            return wactnm_data;                                      
        } 
    }


    
    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    //단건문자발송
    function smsshot_rtn(){
        
 
        var ls_smscaller  = document.getElementById('smscaller').value; 
        var ls_smstel  = document.getElementById('smstel').value; 
        var ls_smschk  = document.getElementById('smschk').value; 
        var ls_smsrepernm  = document.getElementById('smsrepernm').value; 
        var ls_smspernm  = document.getElementById('smspernm').value; 
        var ls_smssubject  = document.getElementById('smssubject').value; 
        var ls_smsmsg  = document.getElementById('smsmsg').value; 
        var ls_recedate  = document.getElementById('actrecedatez').value; 
        var ls_recenum  = document.getElementById('actrecenumz').value;  
        var ls_actactcdz  = document.getElementById('actactcdz').value; 
        var ls_actequpcdz  = document.getElementById('actequpcdz').value; 
        var ls_actrecetimez  = document.getElementById('actrecetimez').value; 
        
        

        if(ls_smscaller == null || ls_smscaller.length == 0 || ls_smscaller == ""){
           alert("발신번호를 ERP 환경설정에 등록하세요");
           return
        }        
        if(ls_smstel == null || ls_smstel.length == 0 || ls_smstel == ""){
           alert("수신번호를 등록하세요");
           return
        }        
        if(ls_smsrepernm == null || ls_smsrepernm.length == 0 || ls_smsrepernm == ""){
           alert("발신자를 등록하세요");
           return
        }        
        if(ls_smspernm == null || ls_smspernm.length == 0 || ls_smspernm == ""){
           alert("수신자를 등록하세요");
           return
        }        
        if(ls_smsmsg == null || ls_smsmsg.length == 0 || ls_smsmsg == ""){
           alert("발송내용을 등록하세요");
           return
        }    
        if(ls_actrecetimez != null && ls_smsmsg.length > 0 && ls_smsmsg != ""){
            ls_actrecetimez = ls_actrecetimez.substr(0,2) + ls_actrecetimez.substr(3,2);
        }else{
            ls_actrecetimez = " ";
        }            
        // 본문 data    
        var inputdata = {   
                "smscaller"    : ls_smscaller ,
                "smstel"    : ls_smstel ,
                "smschk"    : ls_smschk ,
                "smsrepernm"  : ls_smsrepernm,
                "smspernm"      : ls_smspernm , 
                "smssubject"   :  ls_smssubject   , 
                "smsmsg"   :  ls_smsmsg,  
                "recedate" : ls_recedate, 
                "recenum" : ls_recenum, 
                "actactcdz" : ls_actactcdz, 
                "actequpcdz" : ls_actequpcdz, 
                "actrecetimez" : ls_actrecetimez
                
            }  
            formSMSData.delete("smsdata");   
        // 본문 data formdata 에 추가
        formSMSData.append("smsdata", new Blob([ JSON.stringify(inputdata) ], {type : "application/json"}));   
        $.ajax({
            url: '/app01mod/savesms01',
            processData : false,                //  processData : false로 선언 시 formData를 string으로 변환하지 않음
            contentType : false,                // contentType : false 로 선언 시 content-type 헤더가 multipart/form-data로 전송되게
            enctype : 'multipart/form-data',
            type: "POST",
            data: formSMSData,
            async:false,
            success:function(data){
                // console.log("등록OK", data);
                if(data == "success"){
                    alert("전송되었습니다.")      
                    searchwSMS_rtn()                
                    $("#wsmsmodal_btn").trigger("click");  
                }else{
                    console.log(data);
                    alert("전송중 오류가 발생했습니다. 관리자에게 문의하세요.")
                }

            },error:function(e){
                console.log('error',e);
            }
        }).done(function(fragment){

        })  
        return ;


    }
    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    //고장접수등록
    function saveE401_rtn(){
        var ls_actrecedatez  = document.getElementById('actrecedatez').value; 
        var ls_actrecenumz   = document.getElementById('actrecenumz').value; 
        var ls_actrecetimez  = document.getElementById('actrecetimez').value;  
        var ls_acthitchdatez = document.getElementById('acthitchdatez').value; 
        var ls_acthitchhourz = document.getElementById('acthitchhourz').value; 
        var ls_actactcdz    = document.getElementById('actactcdz').value; 
        var ls_actequpcdz   = document.getElementById('actequpcdz').value; 
        var ls_actreperidz  = document.getElementById('actreperidz').value; 
        var ls_actperidz    = document.getElementById('actperidz').value; 
        var ls_actcontcdz   = document.getElementById('actcontcdz').value; 
        var ls_actcontentsz = document.getElementById('actcontentsz').value; 
        var ls_actremarkz   = document.getElementById('actremarkz').value;    
        
        if(ls_actrecedatez == null || ls_actrecedatez.length == 0 || ls_actrecedatez == ""){
           alert("접수일자를 등록하세요");
           return
        }       
        if(ls_actrecetimez == null || ls_actrecetimez.length == 0 || ls_actrecetimez == ""){
           alert("접수시간을 등록하세요");
           return
        }else{
            ls_actrecetimez = ls_actrecetimez.substr(0,2) + ls_actrecetimez.substr(3,2);
        }       
        if(ls_acthitchhourz == null || ls_acthitchhourz.length == 0 || ls_acthitchhourz == ""){
           alert("고장시간을 등록하세요");
           return
        }else{
            ls_acthitchhourz = ls_acthitchhourz.substr(0,2) + ls_acthitchhourz.substr(3,2);
        }    
        if(ls_actactcdz == null || ls_actactcdz.length == 0 || ls_actactcdz == ""){
           alert("보수현장을 등록하세요");
           return
        }       
        if(ls_actequpcdz == null || ls_actequpcdz.length == 0 || ls_actequpcdz == ""){
           alert("호기를 등록하세요");
           return
        }      
        if(ls_actreperidz == null || ls_actreperidz.length == 0 || ls_actreperidz == ""){
           alert("접수자를 등록하세요");
           return
        }      
        if(ls_actperidz == null || ls_actperidz.length == 0 || ls_actperidz == ""){
           alert("통보자를 등록하세요");
           return
        }       
        if(ls_actcontcdz == null || ls_actcontcdz.length == 0 || ls_actcontcdz == ""){
           alert("고장내용을 등록하세요");
           return
        }            


        // 본문 data    
        var inputdata = {   
                "actrecedatez"    : ls_actrecedatez ,
                "actrecenumz"    : ls_actrecenumz ,
                "actrecetimez"    : ls_actrecetimez ,
                "acthitchdatez"  : ls_acthitchdatez,
                "acthitchhourz"      : ls_acthitchhourz , 
                "actactcdz"   :  ls_actactcdz   ,
                "actequpcdz"   :  ls_actequpcdz, 
                "actperidz"   :  ls_actperidz, 
                "actreperidz"   :  ls_actreperidz, 
                "actcontcdz"   :  ls_actcontcdz, 
                "actcontentsz"   :  ls_actcontentsz, 
                "actremarkz"   :  ls_actremarkz, 
                
            }  
        formData.delete("key");    
        // 본문 data formdata 에 추가
        formData.append("key", new Blob([ JSON.stringify(inputdata) ], {type : "application/json"})); 

        $.ajax({
            url: '/app01mod/savee401',
            processData : false,                //  processData : false로 선언 시 formData를 string으로 변환하지 않음
            contentType : false,                // contentType : false 로 선언 시 content-type 헤더가 multipart/form-data로 전송되게
            enctype : 'multipart/form-data',
            type: "POST",
            data: formData,
            async:false,
            success:function(data){
                // console.log("등록OK", data);
                if(data == "success"){
                    alert("저장되었습니다.") 
                    search_rtn();
                }else{
                    console.log(data);
                    alert("저장중 오류가 발생했습니다. 관리자에게 문의하세요.")
                }

            },error:function(e){
                console.log('error',e);
            }
        }).done(function(fragment){

        })  
        return ;
    }

    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    //고장접수삭제
    function delE401_rtn(){
        if (!confirm(" 접수내용을 삭제하시겠습니까?")) {
        return ;
        }
        var ls_actrecedatez  = document.getElementById('actrecedatez').value; 
        var ls_actrecenumz   = document.getElementById('actrecenumz').value;  
        
        if(ls_actrecedatez == null || ls_actrecedatez.length == 0 || ls_actrecedatez == ""){
           alert("접수일자를 등록하세요");
           return
        }       
        if(ls_actrecenumz == null || ls_actrecenumz.length == 0 || ls_actrecenumz == ""){
           alert("왼쪽 고장접수현장을 선택하세요.");
           return
        }          
 
        $.ajax({
        url: '/app01mod/deletee401',
        type:"POST",
        data: {
            "actrecedatez"     : ls_actrecedatez ,
            "actrecenumz"      : ls_actrecenumz 
        },
        async:false,
        success:function(data){
            if(data == "success"){ 
                alert("삭제되었습니다.")     
                search_rtn();     
                new_rtn()      
            }else{
                console.log('error',e);
                alert("삭제중 오류가 발생했습니다. 관리자에게 문의하세요.")
            }
        },error:function(e){
            console.log('error',e);
        }
        }).done(function(fragment){

        }) 

        return ;
    }

    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    //통화메모등록
    function saveCall_rtn(){
        var ls_actcalldatez  = document.getElementById('actcalldatez').value; 
        var ls_actcalltimez   = document.getElementById('actcalltimez').value; 
        var ls_actseqz  = document.getElementById('actseqz').value;  
        var ls_actcallnmz = document.getElementById('actcallnmz').value; 
        var ls_actcallnumz = document.getElementById('actcallnumz').value;  
        var ls_actcallbacktimez   = document.getElementById('actcallbacktimez').value; 
        var ls_actcallbackmemoz  = document.getElementById('actcallbackmemoz').value; 
        var ls_actcallmemoz    = document.getElementById('actcallmemoz').value;  
        var ls_actcallendmemoz    = document.getElementById('actcallendmemoz').value;  
        
        const callbackflag = document.getElementById('callbackflag'); 
        const is_checked = callbackflag.checked;
        console.log(is_checked);
        if (is_checked){
            ls_callbackflag = "1"
        }else{
            ls_callbackflag = "0"
        }
        console.log(ls_callbackflag);
        if(ls_actcalldatez == null || ls_actcalldatez.length == 0 || ls_actcalldatez == ""){
           alert("수신일자를 등록하세요");
           return
        }       
        if(ls_actcalltimez == null || ls_actcalltimez.length == 0 || ls_actcalltimez == ""){
           alert("수신시간을 등록하세요");
           return
        }else{
            ls_actcalltimez = ls_actcalltimez.substr(0,2) + ls_actcalltimez.substr(3,2);
        }  
        if(ls_callbackflag == "1" ){     
            if(ls_actcallbacktimez == null || ls_actcallbacktimez.length == 0 || ls_actcallbacktimez == ""){
                alert("콜백시간을 등록하세요");
                return
            }else{
                ls_actcallbacktimez = ls_actcallbacktimez.substr(0,2) + ls_actcallbacktimez.substr(3,2);
            }    
        }else{
            ls_actcallbacktimez = "";
        }             


        // 본문 data    
        var inputdata = {   
                "actcalldatez"    : ls_actcalldatez ,
                "actcalltimez"    : ls_actcalltimez ,
                "actseqz"    : ls_actseqz ,
                "actcallnmz"  : ls_actcallnmz,
                "actcallnumz"      : ls_actcallnumz , 
                "callbackflag"   :  ls_callbackflag   ,
                "actcallbacktimez"   :  ls_actcallbacktimez, 
                "actcallbackmemoz"   :  ls_actcallbackmemoz, 
                "actcallmemoz"   :  ls_actcallmemoz,  
                "actcallendmemoz"   :  ls_actcallendmemoz,  
                
            }  
        formData.delete("key");    
        // 본문 data formdata 에 추가
        formData.append("key", new Blob([ JSON.stringify(inputdata) ], {type : "application/json"}));
        console.log(inputdata); 

        $.ajax({
            url: '/app01mod/savecall',
            processData : false,                //  processData : false로 선언 시 formData를 string으로 변환하지 않음
            contentType : false,                // contentType : false 로 선언 시 content-type 헤더가 multipart/form-data로 전송되게
            enctype : 'multipart/form-data',
            type: "POST",
            data: formData,
            async:false,
            success:function(data){
                // console.log("등록OK", data);
                if(data == "success"){
                    alert("저장되었습니다.") 
                    searchtel_rtn();
                }else{
                    console.log(data);
                    alert("저장중 오류가 발생했습니다. 관리자에게 문의하세요.")
                }

            },error:function(e){
                console.log('error',e);
            }
        }).done(function(fragment){

        })  
        return ;
    }
    

    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    //통화메모삭제
    function delCall_rtn(){
        if (!confirm(" 수신내용을 삭제하시겠습니까?")) {
        return ;
        }
        var ls_actseqz  = document.getElementById('actseqz').value;   
        
        if(ls_actseqz == null || ls_actseqz.length == 0 || ls_actseqz == ""){
           alert("하단 리스트를 선택하세요");
           return
        }           
 
        $.ajax({
        url: '/app01mod/deletecall',
        type:"POST",
        data: {
            "actseqz"     : ls_actseqz 
        },
        async:false,
        success:function(data){
            if(data == "success"){ 
                alert("삭제되었습니다.")     
                search_rtn();     
                newcall_rtn()      
            }else{
                console.log('error',e);
                alert("삭제중 오류가 발생했습니다. 관리자에게 문의하세요.")
            }
        },error:function(e){
            console.log('error',e);
        }
        }).done(function(fragment){

        }) 

        return ;
    }

    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    //현장 검색   
    document.getElementById("actactnmz").addEventListener("click",function(){ 
        document.getElementById("actnmbtn").click();
    }); 
    document.getElementById("wactcdlistBtn").addEventListener("click",function(){ 
        document.getElementById("actnmbtn").click();
    });
    
    //고장내용 검색   
    document.getElementById("actcontnmz").addEventListener("click",function(){ 
        document.getElementById("contnmbtn").click();
    });
    //사원내용 검색   
    document.getElementById("actrepernmz").addEventListener("click",function(){ 
        document.getElementById("repernmbtn").click();
    });
    //사원2내용 검색   
    document.getElementById("actpernmz").addEventListener("click",function(){ 
        document.getElementById("pernmbtn").click();
    });
    //호기내용 검색   
    document.getElementById("actequpnmz").addEventListener("click",function(){ 
        document.getElementById("equpnmbtn").click();
    });
    //SMS 검색   
    document.getElementById("wsmsBtn").addEventListener("click",function(){ 
        document.getElementById("smsbtn").click();
    });
    //콜백리스트
    document.getElementById("wcallbackBtn").addEventListener("click",function(){ 
        document.getElementById("callbackbtn").click();
    }); 
    //전화번호부리스트
    document.getElementById("wphonebookBtn").addEventListener("click",function(){ 
        document.getElementById("phonebookbtn").click();
    });  
    //전화번호부 신규
    document.getElementById("wphonebookNewBtn").addEventListener("click",function(){ 
        newphonebook_rtn()
    });  
    //전화번호부 저장
    document.getElementById("wphonebookSaveBtn").addEventListener("click",function(){ 
        newphonebooksave_rtn()
    });  
    //전화번호부 삭제
    document.getElementById("wphonebookDelBtn").addEventListener("click",function(){ 
        newphonebookdel_rtn()
    });  

    
    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    // 현장 검색   
    document.getElementById("wactnmBtn").addEventListener("click",function(){ 
        searchwactnm_rtn();
    })                            
    // 고장내용 검색   
    document.getElementById("wcontnmBtn").addEventListener("click",function(){ 
        searchwcontnm_rtn();
    })                        
    // 사원내용 검색   
    document.getElementById("wrepernmBtn").addEventListener("click",function(){ 
        searchwrepernm_rtn();
    })                        
    // 사원2내용 검색   
    document.getElementById("wpernmBtn").addEventListener("click",function(){ 
        searchwpernm_rtn();
    })                        
    // 호기내용 검색   
    document.getElementById("wequpnmBtn").addEventListener("click",function(){ 
        searchwequpnm_rtn();
    })                      
    // 호기내용 검색   
    document.getElementById("wcallbkBtn").addEventListener("click",function(){ 
        searchwcallbk_rtn();
    })

    function searchwactnm_rtn(){
        let searchText = '';  
        searchText = document.getElementById('searchwactnm').value;  
        let lsConflag = document.getElementById('conflag').value;  
        if(searchText == null || searchText.length == 0 || searchText == ""){
            searchText = "%";
        }            
        $.ajax({
            url: '/pop01/wactnm',  
            type:"POST",
            data: { 
                "actnmz"      : searchText,  
                "conflag"      : lsConflag  
            }, 
            success:function(data){ 
                var wactnmDto  = data;    
                var wactnm_data = [];
                var cnt = 1;
                for (var i = 0; i < wactnmDto.length; i++) {
                    wactnm_data.push({
                        id: i, 
                        index: cnt,
                        actnm:wactnmDto[i]["actnm"],
                        actcd: wactnmDto[i]["actcd"], 
                        telno: wactnmDto[i]["telno"]  , 
                        addr: wactnmDto[i]["addr"]                                                  
                    });
                    cnt++;
                }   
                // console.log("wactnm_data",wactnm_data) 
                wactnmGrid.columns.clear();  
                wactnmGrid.autoGenerateColumns = false; 
                view_actnmpage.sourceCollection  = wactnm_data;
                var cols = new wijmo.grid.Column(); 
                cols.binding = 'actcd';
                cols.header = '코드';
                cols.align = "center";
                cols.width = '*';
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.actcd}</b>',
                    click: (e, ctx) => {
                        wactnmChk_2(ctx.item.actcd, ctx.item.actnm, '',  "01");
                    }
                });
                wactnmGrid.columns.push(cols);    
                // console.log("cols", cols);  
                cols = new wijmo.grid.Column(); 
                cols.binding = 'actnm';
                cols.header = '현장명';
                cols.align = "left";
                cols.width = '*'; 
                wactnmGrid.columns.push(cols);  
                cols = new wijmo.grid.Column(); 
                cols.binding = 'telno';
                cols.header = '전화번호';
                cols.align = "center";
                cols.width = '*';
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.telno}</b>',
                    click: (e, ctx) => {
                        wactnmChk_2(ctx.item.actcd, ctx.item.actnm, '',  "01");
                    }
                });
                wactnmGrid.columns.push(cols);  
                cols = new wijmo.grid.Column(); 
                cols.binding = 'addr';
                cols.header = '주소';
                cols.align = "left";
                cols.width = '*'; 
                wactnmGrid.columns.push(cols);  
            },error:function(e){
                alert(data.code);
                alert(data.message);
            }
        }).done(function(fragment){           

        }) 
    }


    function searchwcontnm_rtn(){
            let searchText = '';  
            searchText = document.getElementById('searchwcontnm').value;   
            if(searchText == null || searchText.length == 0 || searchText == ""){
                searchText = "%";
            }
            // console.log('ls_cltcd-->' + ls_cltcd);
            $.ajax({
                url: '/pop01/wcontnm',  
                type:"POST",
                data: { 
                    "contnmz"      : searchText, 
                }, 
                success:function(data){  
                    var wcontnmDto  = data;    
                    var wcontnm_data = [];
                    var cnt = 1;
                    for (var i = 0; i < wcontnmDto.length; i++) {
                        wcontnm_data.push({
                            id: i, 
                            index: cnt,
                            contnm:wcontnmDto[i]["contnm"],
                            contcd: wcontnmDto[i]["contcd"],                                             
                        });
                        cnt++;
                    }   
                    // console.log("wcontnm_data",wcontnm_data) 
                    wcontnmGrid.columns.clear();  
                    wcontnmGrid.autoGenerateColumns = false; 
                    view_contnmpage.sourceCollection  = wcontnm_data;
                    var cols = new wijmo.grid.Column(); 
                    cols.binding = 'contcd';
                    cols.header = '코드';
                    cols.align = "center";
                    cols.width = '*';
                    cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                        text: '<b>${item.contcd}</b>',
                        click: (e, ctx) => {
                            wactnmChk_2(ctx.item.contcd, ctx.item.contnm,  '',  '02');
                        }
                    });
                    wcontnmGrid.columns.push(cols);    
                    // console.log("cols", cols);  
                    cols = new wijmo.grid.Column(); 
                    cols.binding = 'contnm';
                    cols.header = '고장내용';
                    cols.align = "left";
                    cols.width = '*'; 
                    wcontnmGrid.columns.push(cols);    
                },error:function(e){
                    alert(data.code);
                    alert(data.message);
                }
            }).done(function(fragment){           

            })  

    }

    function searchwrepernm_rtn(){
        let searchText = '';  
        searchText = document.getElementById('searchwrepernm').value;   
        if(searchText == null || searchText.length == 0 || searchText == ""){
            searchText = "%";
        }
        // console.log('ls_cltcd-->' + ls_cltcd);
        $.ajax({
            url: '/pop01/wpernm',  
            type:"POST",
            data: { 
                "actpernmz"      : searchText, 
            }, 
            success:function(data){ 
                
                var wcontnmDto  = data;    
                var wcontnm_data = [];
                var cnt = 1;
                for (var i = 0; i < wcontnmDto.length; i++) {
                    wcontnm_data.push({
                        id: i, 
                        index: cnt,
                        reperid:wcontnmDto[i]["perid"],
                        repernm: wcontnmDto[i]["pernm"]                                          
                    });
                    cnt++;
                }   
                // console.log("wcontnm_data",wcontnm_data)  
                wrepernmGrid.columns.clear();  
                wrepernmGrid.autoGenerateColumns = false; 
                view_repernmpage.sourceCollection  = wcontnm_data;
                var cols = new wijmo.grid.Column(); 
                cols.binding = 'reperid';
                cols.header = '코드';
                cols.align = "center";
                cols.width = '*';
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.reperid}</b>',
                    click: (e, ctx) => {
                        wactnmChk_2(ctx.item.reperid, ctx.item.repernm, '' , '03');
                    }
                });
                wrepernmGrid.columns.push(cols);    
                // console.log("cols", cols);  
                cols = new wijmo.grid.Column(); 
                cols.binding = 'repernm';
                cols.header = '접수자';
                cols.align = "center";
                cols.width = '*'; 
                wrepernmGrid.columns.push(cols);    
            },error:function(e){
                alert(data.code);
                alert(data.message);
            }
        }).done(function(fragment){           

        })  

    }


    function searchwpernm_rtn(){
        let searchText = '';  
        searchText = document.getElementById('searchwpernm').value;   
        if(searchText == null || searchText.length == 0 || searchText == ""){
            searchText = "%";
        }
        // console.log('ls_cltcd-->' + ls_cltcd);
        $.ajax({
            url: '/pop01/wpernm',  
            type:"POST",
            data: { 
                "actpernmz"      : searchText, 
            }, 
            success:function(data){ 
                
                var wcontnmDto  = data;    
                var wcontnm_data = [];
                var cnt = 1;
                for (var i = 0; i < wcontnmDto.length; i++) {
                    wcontnm_data.push({
                        id: i, 
                        index: cnt,
                        perid:wcontnmDto[i]["perid"],
                        pernm: wcontnmDto[i]["pernm"],
                        handphone: wcontnmDto[i]["handphone"]                                         
                    });
                    cnt++;
                }   
                console.log("wcontnm_data",wcontnm_data)  
                wpernmGrid.columns.clear();  
                wpernmGrid.autoGenerateColumns = false; 
                view_pernmpage.sourceCollection  = wcontnm_data;
                var cols = new wijmo.grid.Column(); 
                cols.binding = 'perid';
                cols.header = '코드';
                cols.align = "center";
                cols.width = '*';
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.perid}</b>',
                    click: (e, ctx) => {
                        wactnmChk_2(ctx.item.perid, ctx.item.pernm, ctx.item.handphone, '04');
                    }
                });
                wpernmGrid.columns.push(cols);    
                // console.log("cols", cols);  
                cols = new wijmo.grid.Column(); 
                cols.binding = 'pernm';
                cols.header = '통보자';
                cols.align = "center";
                cols.width = '*'; 
                wpernmGrid.columns.push(cols);    
            },error:function(e){
                alert(data.code);
                alert(data.message);
            }
        }).done(function(fragment){           

        })  

    }

    function searchwequpnm_rtn(){
        let searchText = '';    
        let ls_actcd = '';    
        ls_actcd = document.getElementById('actactcdz').value;  
        searchText = document.getElementById('searchwequpnm').value;   
        if(ls_actcd == null || ls_actcd.length == 0 || ls_actcd == ""){
           alert("현장을 먼저 선택하세요");
           return 
        }        
        if(searchText == null || searchText.length == 0 || searchText == ""){
            searchText = "%";
        }
        // console.log('ls_cltcd-->' + ls_cltcd);
        $.ajax({
            url: '/pop01/wequpcd',  
            type:"POST",
            data: { 
                "actcdz"         : ls_actcd,
                "equpcdz"      : searchText, 
            }, 
            success:function(data){ 
                
                var wcontnmDto  = data;    
                var wcontnm_data = [];
                var cnt = 1;
                for (var i = 0; i < wcontnmDto.length; i++) {
                    wcontnm_data.push({
                        id: i, 
                        index: cnt,
                        equpcd:wcontnmDto[i]["equpcd"],
                        equpnm: wcontnmDto[i]["equpnm"],                                             
                    });
                    cnt++;
                }   
                // console.log("wcontnm_data",wcontnm_data)  
                wequpnmGrid.columns.clear();  
                wequpnmGrid.autoGenerateColumns = false; 
                view_equpnmpage.sourceCollection  = wcontnm_data;
                var cols = new wijmo.grid.Column(); 
                cols.binding = 'equpcd';
                cols.header = '코드';
                cols.align = "center";
                cols.width = '*';
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.equpcd}</b>',
                    click: (e, ctx) => {
                        wactnmChk_2(ctx.item.equpcd, ctx.item.equpnm, '', '05');
                    }
                });
                wequpnmGrid.columns.push(cols);    
                // console.log("cols", cols);  
                cols = new wijmo.grid.Column(); 
                cols.binding = 'equpnm';
                cols.header = '호기명';
                cols.align = "center";
                cols.width = '*'; 
                wequpnmGrid.columns.push(cols);    
            },error:function(e){
                alert(data.code);
                alert(data.message);
            }
        }).done(function(fragment){           

        })  

    }    

    
    function searchwSMS_rtn(){
        let searchText = '';    
        let ls_actcd = '';     
        $.ajax({
            url: '/pop01/wsmslist',  
            type:"POST",
            data: { 
                "wpernm"         : ""
            },  
            success:function(data){ 
                var wSMSDto  = data;    
                var wsms_data = [];
                var cnt = 1;
                for (var i = 0; i < wSMSDto.length; i++) {
                    wsms_data.push({
                        id: i, 
                        index: cnt,
                        recedate:wSMSDto[i]["recedate"],
                        recetime: wSMSDto[i]["recetime"],  
                        pernm: wSMSDto[i]["pernm"],  
                        sms_tel: wSMSDto[i]["sms_tel"],  
                        sms_caller: wSMSDto[i]["sms_caller"],  
                        sms_text: wSMSDto[i]["sms_text"],  
                        result: wSMSDto[i]["result"],      
                        flag: wSMSDto[i]["flag"],                                             
                    });
                    cnt++;
                }   
                wsmsGrid.columns.clear();  
                wsmsGrid.autoGenerateColumns = false; 
                view_wsmspage.sourceCollection  = wsms_data;
                var cols = new wijmo.grid.Column(); 
                cols.binding = 'result';
                cols.header = '결과';
                cols.align = "center";
                cols.width = 60;
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.result}</b>',
                    click: (e, ctx) => {
                        // wactnmChk_2(ctx.item.equpcd, ctx.item.equpnm, '', '05');
                    }
                });
                wsmsGrid.columns.push(cols);    
                // console.log("cols", cols);  
                cols = new wijmo.grid.Column(); 
                cols.binding = 'recedate';
                cols.header = '일자';
                cols.align = "center";
                cols.width = 80; 
                wsmsGrid.columns.push(cols);     
                cols = new wijmo.grid.Column(); 
                cols.binding = 'recetime';
                cols.header = '시간';
                cols.align = "center";
                cols.width = 100; 
                wsmsGrid.columns.push(cols);   
                cols = new wijmo.grid.Column(); 
                cols.binding = 'pernm';
                cols.header = '수신자명';
                cols.align = "center";
                cols.width = 120; 
                wsmsGrid.columns.push(cols);       
                cols = new wijmo.grid.Column(); 
                cols.binding = 'sms_tel';
                cols.header = '수신번호';
                cols.align = "center";
                cols.width = 120; 
                wsmsGrid.columns.push(cols);  
                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'repernm';
                // cols.header = '발신자명';
                // cols.align = "center";
                // cols.width = '*'; 
                // wsmsGrid.columns.push(cols);     
                cols = new wijmo.grid.Column(); 
                cols.binding = 'sms_caller';
                cols.header = '발신번호';
                cols.align = "center";
                cols.width = 120; 
                wsmsGrid.columns.push(cols);    
                cols = new wijmo.grid.Column(); 
                cols.binding = 'flag';
                cols.header = '수신';
                cols.align = "center";
                cols.width = 60;; 
                wsmsGrid.columns.push(cols);     
                cols = new wijmo.grid.Column(); 
                cols.binding = 'sms_text';
                cols.header = '내용';
                cols.align = "left";
                cols.width = '*'; 
                wsmsGrid.columns.push(cols);        
            },error:function(e){
                alert(data.code);
                alert(data.message);
            }
        }).done(function(fragment){           

        })  

    }    


    function searchwcallbk_rtn(){
        let searchText = '';    
        let ls_flag = '';     
        searchText = document.getElementById('ddcallflag').value;    
        if(searchText == null || searchText.length == 0 || searchText == ""){
            searchText = "%";
        } 
        $.ajax({
            url: '/app01mod/wcallbacklist',  
            type:"POST",
            data: {  
                "searchtxt"      : searchText, 
            }, 
            success:function(data){  
                var wcontnmDto  = data;    
                var wcontnm_data = [];
                var cnt = 1; 
                for (var i = 0; i < wcontnmDto.length; i++) {
                    if(wcontnmDto[i]["callbackflag"] == "1") {
                     ls_flag = "미처리"   
                    }else{
                     ls_flag = "처리"   
                    }
                    wcontnm_data.push({
                        id: i, 
                        index: cnt,
                        seq:wcontnmDto[i]["seq"],
                        callbackflag: wcontnmDto[i]["callbackflag"],   
                        callbacktime: wcontnmDto[i]["callbacktime"],   
                        callbackmemo: wcontnmDto[i]["callbackmemo"],   
                        callnm: wcontnmDto[i]["callnm"],   
                        callnum: wcontnmDto[i]["callnum"],   
                        calldate: wcontnmDto[i]["calldate"],   
                        calltime: wcontnmDto[i]["calltime"],   
                        callmemo: wcontnmDto[i]["callmemo"],   
                        flag: ls_flag,                                               
                    });
                    cnt++;
                }   
                // // console.log("wcontnm_data",wcontnm_data)  
                wcallbkGrid.columns.clear();  
                wcallbkGrid.autoGenerateColumns = false; 
                view_callbackpage.sourceCollection  = wcontnm_data;
                var cols = new wijmo.grid.Column(); 
                cols.binding = 'flag';
                cols.header = '구분';
                cols.align = "center";
                cols.width = 60; 
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.flag}</b>',
                    click: (e, ctx) => {
                        wactnmChk_2(ctx.item.seq, '','',  '06');
                    }
                });
                wcallbkGrid.columns.push(cols);    
                // console.log("cols", cols);    
                cols = new wijmo.grid.Column(); 
                cols.binding = 'calldate';
                cols.header = '상담일자';
                cols.align = "center";
                cols.width = 90; 
                wcallbkGrid.columns.push(cols);  
                cols = new wijmo.grid.Column(); 
                cols.binding = 'callbacktime';
                cols.header = '예약시간';
                cols.align = "center";
                cols.width = 80; 
                wcallbkGrid.columns.push(cols);   
                cols = new wijmo.grid.Column(); 
                cols.binding = 'callbackmemo';
                cols.header = '콜백메모';
                cols.align = "left";
                cols.width = 150; 
                wcallbkGrid.columns.push(cols);   
                cols = new wijmo.grid.Column(); 
                cols.binding = 'callnm';
                cols.header = '고객명';
                cols.align = "left";
                cols.width = 100; 
                wcallbkGrid.columns.push(cols);   
                cols = new wijmo.grid.Column(); 
                cols.binding = 'callnum';
                cols.header = '연락처';
                cols.align = "center";
                cols.width = 150; 
                wcallbkGrid.columns.push(cols);    
                cols = new wijmo.grid.Column(); 
                cols.binding = 'calltime';
                cols.header = '상담시간';
                cols.align = "center";
                cols.width = 90; 
                wcallbkGrid.columns.push(cols);   
                cols = new wijmo.grid.Column();   
                cols.binding = 'callmemo';
                cols.header = '상담내용';
                cols.align = "left";
                cols.width = 100; 
                wcallbkGrid.columns.push(cols);   
                 
            },error:function(e){
                alert(data.code);
                alert(data.message);
            }
        }).done(function(fragment){           

        })  

    }    



    function searchwphonebook_rtn(){
        let searchText = '';    
        let ls_flag = '';     
        searchText = document.getElementById('searchText').value;    
        if(searchText == null || searchText.length == 0 || searchText == ""){
            searchText = "%";
        } 
        $.ajax({
            url: '/app01mod/wpbooklist',  
            type:"POST",
            data: {  
                "searchtxt"      : searchText, 
            }, 
            success:function(data){  
                var wcontnmDto  = data;    
                var wcontnm_data = [];
                var cnt = 1; 
                
                for (var i = 0; i < wcontnmDto.length; i++) { 
                    wcontnm_data.push({
                        id: i, 
                        index: cnt,
                        actcd:wcontnmDto[i]["actcd"],
                        seq:wcontnmDto[i]["seq"],
                        actmail: wcontnmDto[i]["actmail"],   
                        tel: wcontnmDto[i]["tel"],   
                        remark: wcontnmDto[i]["remark"],                         
                    });
                    cnt++;
                }   
                // // console.log("wcontnm_data",wcontnm_data)  
                wphbookGrid.columns.clear();  
                wphbookGrid.autoGenerateColumns = false; 
                view_phonebookpage.sourceCollection  = wcontnm_data;
                var cols = new wijmo.grid.Column(); 
                cols.binding = 'actcd';
                cols.header = '코드';
                cols.align = "center";
                cols.width = 60; 
                wphbookGrid.columns.push(cols);    
                // console.log("cols", cols);    
                cols = new wijmo.grid.Column(); 
                cols.binding = 'seq';
                cols.header = '순번';
                cols.align = "center";
                cols.width = 50; 
                wphbookGrid.columns.push(cols);  
                cols = new wijmo.grid.Column(); 
                cols.binding = 'actmail';
                cols.header = '고객명';
                cols.align = "left";
                cols.width = 150; 
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.actmail}</b>',
                    click: (e, ctx) => {
                        wactnmChk_3(ctx.item.actcd, ctx.item.seq, ctx.item.actmail, ctx.item.tel,ctx.item.remark,);
                    }
                });
                wphbookGrid.columns.push(cols);   
                cols = new wijmo.grid.Column(); 
                cols.binding = 'tel';
                cols.header = '전화번호';
                cols.align = "left";
                cols.width = "*";  
                wphbookGrid.columns.push(cols);   
                cols = new wijmo.grid.Column(); 
                cols.binding = 'remark';
                cols.header = '비고';
                cols.align = "left";
                cols.width = "*"; 
                wphbookGrid.columns.push(cols);   
                 
            },error:function(e){
                alert(data.code);
                alert(data.message);
            }
        }).done(function(fragment){           

        })  

    }    
    

   
    function newphonebooksave_rtn(){  
        let searchText = '';    
        let ls_flag = '';     
        ls_actactmailz = document.getElementById('actactmailz').value; 
        ls_actactcdz = document.getElementById('actactcdz').value; 
        ls_actseqz = document.getElementById('actseqz').value; 
        ls_acttelz = document.getElementById('acttelz').value; 
        ls_actremarkz = document.getElementById('actpbookremarkz').value;     
        $.ajax({
            url: '/app01mod/updatepbook',  
            type:"POST",
            data: {  
                "actactmailz"      : ls_actactmailz, 
                "actactcdz"      : ls_actactcdz, 
                "actseqz"      : ls_actseqz, 
                "acttelz"      : ls_acttelz, 
                "actremarkz"      : ls_actremarkz, 
            }, 
            success:function(data){   
                 alert("저장되었습니다.")
                 searchwphonebook_rtn()
            },error:function(e){
                alert(data.code);
                alert(data.message);
            }
        }).done(function(fragment){           

        })  
    }  
    

   
    function newphonebookdel_rtn(){ 
        let searchText = '';    
        let ls_flag = '';      
        ls_actactcdz = document.getElementById('actactcdz').value; 
        ls_actseqz = document.getElementById('actseqz').value;      
        ls_actactmailz = document.getElementById('actactmailz').value;                           
        if (!confirm(ls_actactmailz + " : 삭제 하시겠습니까?")) {
            return ;
        }
        $.ajax({
            url: '/app01mod/deletepbook',  
            type:"POST",
            data: {   
                "actactcdz"      : ls_actactcdz, 
                "actseqz"      : ls_actseqz,  
            }, 
            success:function(data){  
                 alert("삭제되었습니다.")  
                 searchwphonebook_rtn()
            },error:function(e){
                alert(data.code);
                alert(data.message);
            }
        }).done(function(fragment){           

        })  
    }  
        
    

    function wactnmChk_2(arg1, arg2, arg3, flag){
        // console.log(flag);
            switch(flag){
                case "01": 
                    // 현장검색 데이터 수집
                    document.getElementById('actactcdz').value = arg1; 
                    document.getElementById('actactnmz').value = arg2;   
                    $("#wactnmmodal_btn").trigger("click");      
                    break;
                case "02":                 
                    // 고장내용검색 데이터 수집  
                    document.getElementById('actcontcdz').value = arg1; 
                    document.getElementById('actcontnmz').value = arg2;   
                    $("#wcontnmmodal_btn").trigger("click"); 
                    break;
                case "03":
                    // 접수자검색 데이터 수집 
                    document.getElementById('actreperidz').value = arg1; 
                    document.getElementById('actrepernmz').value = arg2;  
                    document.getElementById('smsrepernm').value = arg2;   
                    $("#wrepernmmodal_btn").trigger("click"); 
                    break;                    
                case "04":
                    // 통보자검색 데이터 수집  
                    console.log('arg3');
                    console.log(arg3);
                    document.getElementById('actperidz').value = arg1; 
                    document.getElementById('actpernmz').value = arg2;  
                    document.getElementById('smstel').value = arg3;    
                    document.getElementById('smspernm').value = arg2;   
                    $("#wpernmmodal_btn").trigger("click"); 
                    break;                    
                case "05":
                    // 호기검색 데이터 수집  
                    document.getElementById('actequpcdz').value = arg1; 
                    document.getElementById('actequpnmz').value = arg2;                       
                    $("#wequpnmmodal_btn").trigger("click");  
                    wequpnmGrid.columns.clear();  
                    break;                     
                case "06":
                    // 콜백처리                      
                    if (!confirm("처리로 상태를 변경하시겠습니까?")) {
                        return ;
                    }
                    $.ajax({
                        url: '/app01mod/wcallbackflag',
                        type:"POST",
                        data: {
                            "seq"     : arg1  
                        },
                        async:false,
                        success:function(data){
                            if(data == "success"){ 
                                alert("처리되었습니다.")
                                searchwcallbk_rtn();       
                                $("#wcallbkmodal_btn").trigger("click"); 
                            }else{
                                console.log('error');
                                alert("치리중 오류가 발생했습니다. 관리자에게 문의하세요.")
                            }
                        },error:function(e){
                            console.log('error',e);
                        }
                    }).done(function(fragment){

                    }) 
                    break;                 
                default:
                    break;    

            }

    }
    function wactnmChk_3(arg1, arg2, arg3, arg4, arg5){
        document.getElementById('actactcdz').value = arg1; 
        document.getElementById('actseqz').value = arg2; 
        document.getElementById('actactmailz').value = arg3; 
        document.getElementById('acttelz').value = arg4; 
        document.getElementById('actpbookremarkz').value = arg5;    

    }


    function new_rtn(){         
        fn_egov_init_date()
        document.getElementById('actrecenumz').value = "";
        document.getElementById('actactcdz').value = "";
        document.getElementById('actactnmz').value = "";
        document.getElementById('actequpcdz').value = "";
        document.getElementById('actequpnmz').value = "";
        document.getElementById('actreperidz').value = "";
        document.getElementById('actrepernmz').value = "";
        document.getElementById('actperidz').value = "";
        document.getElementById('actpernmz').value = ""; 
        document.getElementById('actcontcdz').value = ""; 
        document.getElementById('actcontnmz').value = ""; 
        document.getElementById('actcontentsz').value = ""; 
        document.getElementById('actremarkz').value = ""; 
         
        wequpnmGrid.columns.clear();  
        return 
    }
    function newcall_rtn(){         
        fn_egov_init_date()
        document.getElementById('actcallnmz').value = "";
        document.getElementById('actcallnumz').value = ""; 
        document.getElementById('actcallmemoz').value = "";
        document.getElementById('actcallbackmemoz').value = "";
        document.getElementById('callbackflag').value = "0";
        document.getElementById('actseqz').value = ""; 
          
        return 
    }    
    function newphonebook_rtn(){  
        document.getElementById('actactmailz').value = "";
        document.getElementById('actactcdz').value = ""; 
        document.getElementById('actseqz').value = "";
        document.getElementById('acttelz').value = "";
        document.getElementById('actpbookremarkz').value = "";
          
        return 
    }    
    function mod_fnc(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10, arg11, arg12, arg13, arg14, arg15, arg16, arg17, arg18){
        // new_rtn()
        document.getElementById('actrecedatez').value = arg1;
        document.getElementById('actrecenumz').value = arg2;
        document.getElementById('actrecetimez').value = arg3;
        document.getElementById('acthitchdatez').value = arg4;
        document.getElementById('acthitchhourz').value = arg5;
        document.getElementById('actactcdz').value = arg6;
        document.getElementById('actactnmz').value = arg7;
        document.getElementById('actequpcdz').value = arg8;
        document.getElementById('actequpnmz').value = arg9;
        document.getElementById('actreperidz').value = arg10;
        document.getElementById('actrepernmz').value = arg11;
        document.getElementById('actperidz').value = arg12;
        document.getElementById('actpernmz').value = arg13; 
        document.getElementById('actcontcdz').value = arg14; 
        document.getElementById('actcontnmz').value = arg15; 
        document.getElementById('actcontentsz').value = arg16; 
        document.getElementById('actremarkz').value = arg17;  
        document.getElementById('smsmsg').value =   arg3 + " " + arg15 + '/' + arg16;  
        document.getElementById('smsrepernm').value = arg11;  
        document.getElementById('smspernm').value = arg13;    
        document.getElementById('smstel').value = arg18;     
        document.getElementById('smssubject').value = arg7 + '(' + arg9 + ')';  
        
        
    }
    
    function modtel_fnc(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10){
        // newcall_rtn() 
        if(arg6 == null || arg6.length == 0 || arg6 == ""){
            arg6 = "";
        }
        if(arg7 == null || arg7.length == 0 || arg7 == ""){
            arg7 = "0";
        }
        if(arg9 == null || arg9.length == 0 || arg9 == ""){
            arg9 = "";
        }
        if(arg8 == null || arg8.length == 0 || arg8 == ""){
            arg8 = "00:00";
        }else{
            arg8 = arg8.substr(0,2) + ":" + arg8.substr(2,2)
        } 
        document.getElementById('actseqz').value = arg1;            //seq
        document.getElementById('actcalldatez').value = arg2;       //calldate
        document.getElementById('actcalltimez').value = arg3;       //calltime
        document.getElementById('actcallnumz').value = arg4;        //callnum
        document.getElementById('actcallnmz').value = arg5;         // callnm   
        document.getElementById('actcallmemoz').value = arg6;       //callmemo      
        // document.getElementById('callbackflag').value = arg7;       //callbackflag
        document.getElementById('actcallbacktimez').value = arg8;   //callbacktime
        document.getElementById('actcallbackmemoz').value = arg9;   //callbackmemo
        document.getElementById('actcallendmemoz').value = arg10;   //callendmemo  
        
         
        const callbackflag = document.getElementById('callbackflag'); 
        if(arg7 == "1"){
            callbackflag.checked = true; 
        }else{
            callbackflag.checked = false  
        } 


    }
 
    function search_rtn(){
        var ls_actnmz = document.getElementById('searchactnmz').value; 
        let ls_frdate = document.getElementById('frdate').value; 
        let ls_todate = document.getElementById('todate').value;             
        if(ls_actnmz == null || ls_actnmz.length == 0 || ls_actnmz == "" || ls_actnmz == "%"){ 
            ls_actnmz = "%";
        }  
        if(ls_frdate == null || ls_frdate.length == 0 || ls_frdate == "" || ls_frdate == "%"){ 
            //alert("시작 일자를 입력하세요")
            //return 
        }  
        if(ls_todate == null || ls_todate.length == 0 || ls_todate == "" || ls_todate == "%"){ 
            //alert("종료 일자를 입력하세요")
           // return 
        }  
        // console.log("ls_actnmz 2222: " + ls_actnmz);
        $.ajax({
                url: '/app01/emconlist',  
                type:"POST",
                data: {   
                    "frdate"      : ls_frdate,  
                    "todate"      : ls_todate ,  
                    "actnmz"      : ls_actnmz ,
                    "page"        : "appkt" 
                }, 
                async:false,
                success:function(data){   
                    // console.log(data);                        
                    $("#ktretrieveDiv").replaceWith(data);  
                },error:function(e){
                    console.log("error"); 
                }
            }).done(function(fragment){           

            })       
    }  

    function searchtel_rtn(){
        let today = new Date();    
        var ls_callnm = document.getElementById('searchcallnmz').value; 
        let ls_frdate = document.getElementById('callfrdate').value;           
        if(ls_callnm == null || ls_callnm.length == 0 || ls_callnm == "" || ls_callnm == "%"){ 
            ls_callnm = "%";
        }  
        if(ls_frdate == null || ls_frdate.length == 0 || ls_frdate == "" || ls_frdate == "%"){ 
            //alert("일자를 입력하세요")
           // return 
        }   
        //  console.log("kkkkkkkkkkkk");
        $.ajax({
                url: '/app01/emtellist',  
                type:"POST",
                data: { 
                    "frdate"      : ls_frdate,    
                    "callnm"      : ls_callnm  
                }, 
                async:false,
                success:function(data){   
                    // console.log(data);                        
                    $("#ktretrieveDiv02").replaceWith(data);  
                },error:function(e){
                    console.log("error"); 
                }
            }).done(function(fragment){           

            })       
    }  


    function search_sms_rtn(){
        var ls_actnmz = document.getElementById('searchactnmz').value; 
        let ls_frdate = document.getElementById('frdate').value; 
        let ls_todate = document.getElementById('todate').value;             
        if(ls_actnmz == null || ls_actnmz.length == 0 || ls_actnmz == "" || ls_actnmz == "%"){ 
            ls_actnmz = "%";
        }  
        if(ls_frdate == null || ls_frdate.length == 0 || ls_frdate == "" || ls_frdate == "%"){ 
            //alert("시작 일자를 입력하세요")
            //return 
        }  
        if(ls_todate == null || ls_todate.length == 0 || ls_todate == "" || ls_todate == "%"){ 
            //alert("종료 일자를 입력하세요")
           // return 
        }  
        // console.log("ls_actnmz 2222: " + ls_actnmz);
        $.ajax({
                url: '/app01/emconlist',  
                type:"POST",
                data: {   
                    "frdate"      : ls_frdate,  
                    "todate"      : ls_todate ,  
                    "actnmz"      : ls_actnmz ,
                    "page"        : "appkt" 
                }, 
                async:false,
                success:function(data){   
                    // console.log(data);                        
                    $("#ktretrieveDiv").replaceWith(data);  
                },error:function(e){
                    console.log("error"); 
                }
            }).done(function(fragment){           

            })       
    }  


    function getElvnum(){

        
        let ls_elvnum = document.getElementById('elvnum').value;  
        const fileDivs = $('div[data-name="fileDiv"]');
        fileDivs.remove(); 
        if( ls_elvnum == null || ls_elvnum.length == 0 || ls_elvnum == "" ){
            alert("승강기 번호를 입력한 후 조회하세요")
            return 
        }

            $.ajax({
                url: '/app01mod/getelvinfo',  
                type:"POST",
                data: { 
                    "elvnum"      : ls_elvnum 
                }, 
                async:false,
                success:function(data){    
                    var GeoDto  = JSON.parse(data); 
                    // console.log("GeoDto");
                    // console.log(GeoDto.response.body.items.item[0])
                    // console.log(data.length)
                    let ls_buldNm = GeoDto.response.body.items.item[0].buldNm;
                    let ls_addr1  = GeoDto.response.body.items.item[0].address1;    
                    let ls_addr2  = GeoDto.response.body.items.item[0].address2;    
                    if( ls_addr2 == null || ls_addr2.length == 0 || ls_addr2 == "" ){
                        ls_addr2 = "";
                    }
                    let ls_elevatorNo = GeoDto.response.body.items.item[0].elevatorNo;    
                    let ls_elvtrDetailForm = GeoDto.response.body.items.item[0].elvtrDetailForm;    
                    let ls_elvtrDivNm = GeoDto.response.body.items.item[0].elvtrDivNm;    
                    let ls_elvtrForm = GeoDto.response.body.items.item[0].elvtrForm;    
                    let ls_elvtrKindNm = GeoDto.response.body.items.item[0].elvtrKindNm;    
                    let ls_elvtrSttsNm = GeoDto.response.body.items.item[0].elvtrSttsNm;    
                    let ls_frstInstallationDe = GeoDto.response.body.items.item[0].frstInstallationDe;    
                    let ls_sigunguNm = GeoDto.response.body.items.item[0].sigunguNm;    
                    let ls_installationPlace = GeoDto.response.body.items.item[0].installationPlace;    
                    const fileHtml = `
                            <div data-name="fileDiv" class="modal-body p-0"  >  
                                <div class="bg-light rounded-top-lg py-3 ps-4 pe-6">
                                    <h4 class="mb-1" id="tooltippopoversLabel">` + ls_buldNm + `( ` + ls_installationPlace + ` )</h4>
                                </div>
                                <div class="p-4 pb-0">
                                    <div class="row">
                                        <div class="col">
                                        <h5><span class="badge me-1 py-2 badge-soft-success">` + ls_addr1 + ls_addr2 + `</span></h5>
                                        <p> 
                                            <ul class="list-group list-group-flush">
                                                <li class="list-group-item">` + ls_elvtrDivNm + `</li>
                                                <li class="list-group-item">` + ls_elvtrKindNm + `</li>
                                                <li class="list-group-item">` + ls_frstInstallationDe + `</li>
                                                <li class="list-group-item">` + ls_sigunguNm + `</li>
                                            </ul>                                                 
                                        </p>
                                     </div>
                                    </div>
                                </div> 
                            </div>  ` ;


                     $('#btnDiv').before(fileHtml);

                     document.getElementById("elvnumbtn").click();
                },error:function(e){
                    console.log("error"); 
                }
            }).done(function(fragment){           

            })  

    }   

    function logout(){   
            if (!confirm("로그아웃하시겠습니까?") ){
             return    
            }
            location.href = "/" ;
        }  
    // function menu01_btn(){  
    //             var win = window.open("/app01/ktcall",   "codetab"); 
    //     }  

    $(document).ready(function() {  
        getToday()
        fn_egov_init_date()
        search_rtn()
        searchtel_rtn() 
        // searchwSMS_rtn()
        // searchwactnm_rtn()
        // searchwcontnm_rtn()
        // searchwrepernm_rtn()
        // searchwpernm_rtn()
        // setTimeout(searchtel_rtn, 10000);  //10초
        setInterval(() => searchtel_rtn(), 2000);  //2초 
        // $('datetimepicker').datetimepicker({
            
        // });  
        $("#frdate").change(function(e){ 
            // console.log("달력클릭");
            // console.log(convert_time(e.timestamp));
        })
        $("#todate").change(function(e){ 
            // console.log("달력클릭");
            // console.log(convert_time(e.timestamp));
        })
        $("#actrecedatez").change(function(e){ 
            // console.log("달력클릭");
            // console.log(convert_time(e.timestamp));
        })
        $("#acthitchdatez").change(function(e){ 
            // console.log("달력클릭");
            // console.log(convert_time(e.timestamp));
        })
    })


    function getToday(){
        let today = new Date();   

        let year = today.getFullYear(); // 년도
        let month = today.getMonth() + 1;  // 월
        let date = today.getDate();  // 날짜
        let day = today.getDay();  // 요일
        if(month > 0 && month < 10) {month = "0" + month};
        if(date > 0 && date < 10) {date = "0" + date};
        let ls_frday = year + '-' + month + '-01' 
        let ls_today = year + '-' + month + '-' + date 
        document.getElementById('frdate').value = ls_frday;
        document.getElementById('todate').value = ls_today;
        document.getElementById('actrecedatez').value = ls_today;
        document.getElementById('acthitchdatez').value = ls_today;
        document.getElementById('actcalldatez').value = ls_today;
        document.getElementById('callfrdate').value = ls_today;
        
    }

    function convert_time(timestamp){ 
        //현재시간
        var date = new Date(timestamp); 
        var year = date.getFullYear(); 
        var month = ("0" + (1 + date.getMonth())).slice(-2); 
        var day = ("0" + date.getDate()).slice(-2); 
        var hh = date.getHours();  
        var min = ('0' + date.getMinutes()).slice(-2) 
        time = year +  month +  day   ;
        return time;  
    }

    function fn_egov_init_date(){
        var $frdate = $('#frdate');
        var $todate = $('#todate');
        var $actrecedatez = $('#actrecedatez');
        var $acthitchdatez = $('#acthitchdatez'); 
        var $actcalldatez = $('#actcalldatez'); 
        var $callfrdate = $('#callfrdate'); 
        
        
        var today = new Date();   
        var hours = ('0' + today.getHours()).slice(-2); 
        var minutes = ('0' + today.getMinutes()).slice(-2);
        // console.log(hours + ':' + minutes);
        document.getElementById('actrecetimez').value = hours + ':' + minutes;
        document.getElementById('acthitchhourz').value = hours + ':' + minutes; 
        document.getElementById('actcalltimez').value = hours + ':' + minutes; 
        document.getElementById('actcallbacktimez').value = hours + ':' + minutes; 
    

        // $frdate.datetimepicker({
        //     timepicker: false,
        //     lang: 'ko',
        //     format: 'Y-m-d',
        //     scrollMonth: false,
        //     scrollInput: false,
        //     onShow: function (ct) {                              
        //         this.setOptions({
        //             // maxDate: $frdate.val() ? $frdate.val() : false
        //         })
        //     },
        // });

        // $todate.datetimepicker({
        //     timepicker: false,
        //     lang: 'ko',
        //     format: 'Y-m-d',    //'Y-m-d H:i',
        //     scrollMonth: false,
        //     scrollInput: false,
        //     onShow: function (ct) {
        //         this.setOptions({
        //             // minDate: $todate.val() ? $todate.val() : false
        //         })
        //     }
        // });

        // $actrecedatez.datetimepicker({
        //     timepicker: false,
        //     lang: 'ko',
        //     format: 'Y-m-d',    //'Y-m-d H:i',
        //     scrollMonth: false,
        //     scrollInput: false,
        //     onShow: function (ct) {
        //         this.setOptions({
        //             // minDate: $todate.val() ? $todate.val() : false
        //         })
        //     }
        // });

        // $acthitchdatez.datetimepicker({
        //     timepicker: false,
        //     lang: 'ko',
        //     format: 'Y-m-d',    //'Y-m-d H:i',
        //     scrollMonth: false,
        //     scrollInput: false,
        //     onShow: function (ct) {
        //         this.setOptions({
        //             // minDate: $todate.val() ? $todate.val() : false
        //         })
        //     }
        // });

        // $actcalldatez.datetimepicker({
        //     timepicker: false,
        //     lang: 'ko',
        //     format: 'Y-m-d',    //'Y-m-d H:i',
        //     scrollMonth: false,
        //     scrollInput: false,
        //     onShow: function (ct) {
        //         this.setOptions({
        //             // minDate: $todate.val() ? $todate.val() : false
        //         })
        //     }
        // });  

        // $callfrdate.datetimepicker({
        //     timepicker: false,
        //     lang: 'ko',
        //     format: 'Y-m-d',    //'Y-m-d H:i',
        //     scrollMonth: false,
        //     scrollInput: false,
        //     onShow: function (ct) {
        //         this.setOptions({
        //             // minDate: $todate.val() ? $todate.val() : false
        //         })
        //     }
        // });        
        
    }      

</script>

</body>
<!------footer ------>
<footer th:replace="layouts/APPHeader/appfooter :: footerFragment"></footer> 

</html>