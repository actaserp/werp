<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" >
<th:block layout:fragment="css" >
  <style>
    .fieldError{
      color: #bd2130;
    }
  </style>
</th:block> 

<body>
    
    <div th:fragment="mainContents">
    <!-- ===============================================-->
    <!--    Main Content-->
    <!-- ===============================================-->
    <main class="main" id="top">
        <div class="container-fluid">
          
          <div class="row min-vh-100 bg-100">
            <div class="col-6 d-none d-lg-block position-relative"> 
              <!--/.bg-holder-->
  
            </div>
            <div class="col-sm-10 col-md-6 px-sm-0 align-self-center mx-auto py-5">
              <div class="row justify-content-center g-0">
                <div class="col-lg-9 col-xl-8 col-xxl-6">
                  <div class="card">
                    <div class="card-header bg-circle-shape bg-shape text-center p-2"><a class="font-sans-serif fw-bolder fs-4 z-index-1 position-relative link-light light" th:href="@{/}">ActasERP</a></div>
                    <div class="card-body p-4">
                      <div class="row flex-between-center">
                        <div class="col-auto">
                          <h3>보수업체사용자등록</h3>
                        </div>
                        <div class="col-auto fs--1 text-600"><span class="mb-0 fw-semi-bold">사용자 등록이 되어있나요?</span> <span><a th:href="@{/members/loginForm}">Login</a></span></div>
                      </div>
                      <form th:action="@{/auth/save}" role="form" method="post"  th:object="${userFormDto}" >
                        <div class="mb-3">
                          <label class="form-label" for="split-name">사업자번호</label>
                          <input class="form-control" type="text" autocomplete="on" id="saupnum" name="saupnum"  th:field="*{saupnum}" />
                          <input class="form-control" type="text" id="flag" name="flag"  th:field="*{flag}" th:value="${flag}" />
                          <div th:if="${#fields.hasErrors('saupnum')}"  th:errors="*{saupnum}"  class="alert alert-warning border-2 d-flex align-items-center" role="alert">
                            <div class="bg-warning me-3 icon-item"><span class="fas fa-exclamation-circle text-white fs-3"></span></div>
                            <p class="mb-0 flex-1">Incorrent data</p> 
                          </div> 

                        <div class="mb-3">
                          <label class="form-label" for="split-name">사용자아이디</label>
                          <input class="form-control" type="text" autocomplete="on" id="userid" name="userid"  th:field="*{userid}" />
                          <div th:if="${#fields.hasErrors('userid')}"  th:errors="*{userid}"  class="alert alert-warning border-2 d-flex align-items-center" role="alert">
                            <div class="bg-warning me-3 icon-item"><span class="fas fa-exclamation-circle text-white fs-3"></span></div>
                            <p class="mb-0 flex-1">Incorrent data</p> 
                          </div> 
                        <div class="mb-3">
                          <label class="form-label" for="split-name">사용자명*</label>
                          <input class="form-control" type="text" autocomplete="on" id="username" name="username"   th:field="*{username}"  /> 
                          <div th:if="${#fields.hasErrors('username')}"  th:errors="*{username}"  class="alert alert-warning border-2 d-flex align-items-center" role="alert">
                            <div class="bg-warning me-3 icon-item"><span class="fas fa-exclamation-circle text-white fs-3"></span></div>
                            <p class="mb-0 flex-1">Incorrent data</p> 
                          </div>                           
                        </div>
                        <div class="row gx-2">
                          <div class="mb-3 col-sm-6">
                            <label class="form-label" for="split-password">Password</label>
                            <input class="form-control" type="passwd1" autocomplete="on" id="passwd1" name="passwd1"  th:field="*{passwd1}"  />
                          </div>
                          <div class="mb-3 col-sm-6">
                            <label class="form-label" for="split-confirm-password">Confirm Password</label>
                            <input class="form-control" type="password" autocomplete="on" id="passwd2" name="passwd2"   th:field="*{passwd2}"  />
                            <!-- <p th:if="${#fields.hasErrors('passwd2')}" th:errors="*{passwd2}" class="fieldError">Incorrent data</p> -->
                          </div>
                        </div>
                        <div class="mb-3">
                          <label class="form-label" for="split-name">핸드폰번호</label>
                          <input class="form-control" type="text" autocomplete="on" id="phone" name="phone"  th:field="*{phone}" />
                          <div th:if="${#fields.hasErrors('phone')}"  th:errors="*{phone}"  class="alert alert-warning border-2 d-flex align-items-center" role="alert">
                            <div class="bg-warning me-3 icon-item"><span class="fas fa-exclamation-circle text-white fs-3"></span></div>
                            <p class="mb-0 flex-1">Incorrent data</p> 
                          </div> 

                        <div class="mb-3">
                          <div th:if="${#fields.hasErrors('password')}"  th:errors="*{password}"  class="alert alert-warning border-2 d-flex align-items-center" role="alert">
                            <div class="bg-warning me-3 icon-item"><span class="fas fa-exclamation-circle text-white fs-3"></span></div>
                            <p class="mb-0 flex-1">Incorrent data</p> 
                          </div>                                                       
                        </div>                        
                        <!-- <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="cover-register-checkbox" />
                          <label class="form-label" for="cover-register-checkbox">I accept the <a href="#!">terms </a>and <a href="#!">privacy policy</a></label>
                        </div> -->
                        <div class="mb-3">
                          <button class="btn btn-primary d-block w-100 mt-3" type="button" name="save_btn" id="save_btn" >사용자등록</button>                          
                        </div>
                        
                        <div class="col-auto">
                          <div id="statusdis01"></div>
                      </div> 
                        <!-- <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"></input> -->
                      </form>
                      <!-- <div class="position-relative mt-4">
                        <hr class="bg-300" />
                        <div class="divider-content-center">or register with</div>
                      </div>
                      <div class="row g-2 mt-2">
                        <div class="col-sm-6"><a class="btn btn-outline-google-plus btn-sm d-block w-100" href="#"><span class="fab fa-google-plus-g me-2" data-fa-transform="grow-8"></span> google</a></div>
                        <div class="col-sm-6"><a class="btn btn-outline-facebook btn-sm d-block w-100" href="#"><span class="fab fa-facebook-square me-2" data-fa-transform="grow-8"></span> facebook</a></div>
                      </div> -->
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>


        <script>
          var btn_obj = document.getElementById('save_btn');
          btn_obj.addEventListener("click",function(){ 
            alert("save");
              //TB_FPLAN_WORK TB_FPLAN_W010  SAVE    
              var ls_saupnum   = document.getElementById('saupnum').value; 
              var ls_userid = document.getElementById('userid').value; 
              var ls_username = document.getElementById('username').value; 
              var ls_flag   = document.getElementById('flag').value;  
              var ls_passwd1   = document.getElementById('passwd1').value; 
              var ls_passwd2   = document.getElementById('passwd2').value; 
              var ls_phone   = document.getElementById('phone').value; 
              
              $.ajax({
                  url: '/authcrud/save',   
                  type:"POST", 
                  data: {
                      "saupnum"    : ls_saupnum ,
                      "userid"  : ls_userid,
                      "username"  : ls_username,
                      "flag"      : ls_flag , 
                      "passwd1"   : ls_passwd1   ,
                      "passwd2"   : ls_passwd2 ,
                      "phone"    : ls_phone, 
                      "actcd"    : '', 
                      "actnm"    : ''
                  },
                  async:false,
                  success:function(data){
                      console.log("등록OK", data); 
                      const statusdis_div = document.getElementById('statusdis01'); 
                      if(data == "success"){
                          alert("등록 되었습니다.");
                          var ls_text = "<div style='color:red'><span class='badge badge-soft-danger'>가입되었습니다.</span></div>";                                        
                      }else{
                          alert("등록오류");
                          var ls_text = "<div style='color:red'><span class='badge badge-soft-info'>가입실패</span></div>";                                        
                      } 
                      statusdis_div.innerHTML  = ls_text;   

                    
                  },error:function(e){
                      console.log('error',e);
                  }
              }).done(function(fragment){           

              }) 

         })
         
    </script>
      </main>
      <!-- ===============================================-->
      <!--    End of Main Content-->
      <!-- ===============================================--> 
    </div>
         
</body>


<script  type="text/javascript" th:inline="javascript">

</script>

</html>