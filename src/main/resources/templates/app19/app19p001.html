<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head th:replace="layouts/APPHeader/apphead :: headFragment" />

<body style="background: #f5f9fa;">
<header>

</header>
<div class="content flex">
  <div class="header on">
    <div class="left">
      <div class="ham">
        <button type="button"><img th:src="@{/assets/images/ham.png}" alt=""></button>
      </div>
      <div class="nav_bg"></div>
      <!-- ################################ -->
      <!-- ## Left navigator include -->
      <th:block th:include="layouts/APPHeader/appLeftNav" />
    </div>
    <div class="right">
    </div>
  </div>
  <div class="con">
    <div class="header_top">
      <ul class="left">
        <li>
          <div class="logo">
            <a href="">
              <img th:src="@{/assets/images/logo.png}" alt="">
            </a>
          </div>
        </li>
        <li class="home">
          <a><img th:src="@{/assets/images/i_home.png}" alt=""></a>
          <a><img th:src="@{/assets/images/i_home_on.png}" alt=""></a>
        </li>
        <li>
          종합유지관리서비스
        </li>
        <li class="on">
          승강기고장통계
        </li>
      </ul>
      <ul class="right">
        <li>
          <a href="">
            <img th:src="@{/assets/images/i_call.png}" alt="">
          </a>
        </li>
        <li>
          <a href="">
            <img th:src="@{/assets/images/i_bell.png}" alt="">
          </a>
        </li>
        <li>
          <a href="">
            <img th:src="@{/assets/images/i_menu.png}" alt="">
          </a>
        </li>
        <li>
          <a href="">
            <img th:src="@{/assets/images/i_que.png}" alt="">
          </a>
        </li>
        <li>
          <a href="">
            <img th:src="@{/assets/images/i_user.png}" alt="">
          </a>
        </li>
      </ul>
    </div>
    <div class="infor_bar type2">
      <ul class="right" style="visibility: hidden; opacity: 0;">
        <li>
          <button type="button" class="color2">
            <i><img th:src="@{/assets/images/i_search.png}" alt=""></i>조회
          </button>
        </li>
        <li>
          <button type="button" class="color5">
            <i><img th:src="@{/assets/images/i_print.png}" alt=""></i>프린트
          </button>
        </li>
      </ul>
      <div class="left">
        승강기고장통계
      </div>
      <ul class="right">
        <li>
          <button type="button" class="color2" id="retrieveBtn">
            <i><img th:src="@{/assets/images/i_search.png}" alt=""></i>조회
          </button>
        </li>
        <!-- <li>
            <button type="button" class="color5">
                <i><img th:src="@{/assets/images/i_print.png}" alt=""></i>프린트
            </button>
        </li> -->
      </ul>

    </div>
    <div class="section">
      <div class="sec_con" style="width: 100%;">
        <div class="box_wrap">
          <ul class="search_box">
            <li>
              <div class="input-group mb-3"><span class="input-group-text" id="basic-addon1">기간</span>
                <input type="text"  class="form-control datetimepicker" id="frdate" autocomplete="off"  placeholder="Y-m-d"     >
                <!-- <span>-</span> -->
                <input type="text"  class="form-control datetimepicker" id="todate" autocomplete="off"  placeholder="Y-m-d"     >
              </div>
            </li>


            <!--<li>
              <div class="input-group mb-3">
                <input class="form-control" type="hidden" placeholder="현장명을 입력하세요" id="actnmz" name="actnmz" aria-label="actnmz" aria-describedby="basic-addon1" />
                <input class="form-control form-control-sm"  type="hidden"  id="actcdz"  />
              </div>
            </li>-->

          </ul>
        </div>
      </div>
    </div>
    <div class="section status">
      <div class="sec_con" style="width: 100%;">
        <div class="box_wrap">
          <div class="table table_style2">
            <div class="card-body bg-light">
              <ul class="nav nav-tabs">
                <li class="nav-item">
                  <a class="nav-link active" data-toggle="tab" href="#step01" onclick="tabchk_rtn('A')">기간별고장내용</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#step02"  onclick="tabchk_rtn('B')">현장별고장내용</a>
                </li>
                <!--<li class="nav-item">
                  <a class="nav-link" data-toggle="tab" href="#step03"  onclick="tabchk_rtn('C')">호기별고장내용</a>
                </li>-->
                <input type="hidden" id="tabvalue" value="A">
              </ul>
              <div class="tab-content">
                <div class="tab-pane fade show active" id="step01">
                  <div class="container-fluid">
                    <div id="theGrid" class="animated"></div>
                    <div id="tab01Pager"></div>
                  </div>
                </div>
                <div class="tab-pane fade" id="step02">
                  <div class="container-fluid">
                    <div id="chartTabB"></div>
                  </div>
                </div>
                <div class="tab-pane fade" id="step03">
                  <div class="container-fluid">
                    <select id="typeMenu">
                      <option value="0" selected="selected">사분면(Squarified)</option>
                      <option value="1">수평(Horizontal)</option>
                      <option value="2">수직(Vertical)</option>
                    </select>
                    <div id="chartTabC"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>



  <!--------------------------------------------------------------------------------------->

  <!--*************************************************************************************************************************-->
  <script type="text/javascript" th:inline="javascript">
    var view_p01tab01page;
    var view_actnmpage;
    var view_contnmpage;
    var wtab01Grid;
    var wactnmGrid;
    var wcontnmGrid;
    var typeMenu;
    var treemap;
    let barchart;
    let ani;
    var wseries_data = [0];
    var view_equpnmpage;
    var wequpnmGrid;
    var theGrid;
    var wgreginmGrid;
    var view_greginmpage;
    var view_remonmpage;
    var wremonmGrid;
    var wresunmGrid;
    var view_resunmpage;

    window.onload = function() {
      //localStorage.setItem("setpage", "app19p001");

      //tab02 차트그리기
      // Tab02Chartinit()

      //tab03 차트그리기
      /*Tab03Chartinit()*/




      view_p01tab01page = new wijmo.collections.CollectionView(getData_tab01(), {
        pageSize: 12
      });

      new wijmo.input.CollectionViewNavigator('#tab01Pager', {
        byPage: true,
        headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
        cv: view_p01tab01page
      });

      // 열 그룹 옵션
      let colGroups1 = getColumnGroups();

      // 열 그룹을 가진 그리드 생성
      theGrid = new wijmo.grid.FlexGrid("#theGrid", {
        allowSorting: 'MultiColumn',
        headersVisibility: "Column",
        alternatingRowStep: 0,
        showMarquee: true,
        showSelectedHeaders: "All",
        autoGenerateColumns: false,
        columnGroups: colGroups1,
        itemsSource:  view_p01tab01page//getData()
      });

      new FlexGridContextMenu(theGrid);






      function getColumnGroups() {

        return [
          {binding: "compyear", header: "년도", width: 100, align: "center"},
          {binding: "actnm", header: "현장명", width: 150, align: "center"},
          {binding: "equpnm", header: "동·호기", width: 100, align: "center"},

          {

            header: "1월",
            align: "center",

            columns: [
              {
                binding: "1월.mon1",
                header: "처리",
                format: "a0",
                width: 80,
                cssClass: "main-column",
                align: "center",
              },
            ]
          },
          {
            header: "2월",
            align: "center",

            columns: [
              {binding: "2월.mon2", header: "처리", format: "a0", width: 80, align: "center"},

            ]
          },
          {
            header: "3월",
            align: "center",

            columns: [
              {binding: "3월.mon3", header: "처리", format: "a0", width: 80, align: "center"},

            ]
          },
          {
            header: "4월",
            align: "center",

            columns: [
              {binding: "4월.mon4", header: "처리", format: "a0", width: 80, align: "center"},

            ]
          },
          {
            header: "5월",
            align: "center",

            columns: [
              {binding: "5월.mon5", header: "처리", format: "a0", width: 80, align: "center"},

            ]
          },
          {
            header: "6월",
            align: "center",

            columns: [
              {binding: "6월.mon6", header: "처리", format: "a0", width: 80, align: "center"},

            ]
          },
          {
            header: "7월",
            align: "center",

            columns: [
              {binding: "7월.mon7", header: "처리", format: "a0", width: 80, align: "center"},

            ]
          },
          {
            header: "8월",
            align: "center",

            columns: [
              {binding: "8월.mon8", header: "처리", format: "a0", width: 80, align: "center"},

            ]
          },
          {
            header: "9월",
            align: "center",

            columns: [
              {binding: "9월.mon9", header: "처리", format: "a0", width: 80, align: "center"},

            ]
          },
          {
            header: "10월",
            align: "center",

            columns: [
              {binding: "10월.mon10", header: "처리", format: "a0", width: 80, align: "center"},

            ]
          },
          {
            header: "11월",
            align: "center",

            columns: [
              {binding: "11월.mon11", header: "처리", format: "a0", width: 80, align: "center"},

            ]
          },
          {
            header: "12월",
            align: "center",

            columns: [
              {
                binding: "12월.mon12", header: "처리", format: "a0", width: 80, align: "center"
              },

            ]
          },
          {
            header: "전체고장수",
            align: "center",

            columns: [
              {
                binding: "전체고장수.totalcnt", header: "처리", format: "a0", width: 80, align: "center"
              },

            ]
          },
          {
            header: "전체고장수합",
            align: "center",

            columns: [
              {
                binding: "전체고장수합.allcnt", header: "처리", format: "a0", width: 280, align: "center"
              },

            ]
          }


        ];
      }



      //검색 데이터 수집
      function getData_tab01() {
        return [
          {
            actnm: "",
            compyear: "",
            equpnm: "",

            "1월": {
              mon1: "",

            },
            "2월": {
              mon2: "",

            },
            "3월": {
              mon3: "",

            },
            "4월": {
              mon4: "",

            },
            "5월": {
              mon5: "",

            },
            "6월": {
              mon6: "",

            },
            "7월": {
              mon7: "",

            },
            "8월": {
              mon8: "",

            },
            "9월": {
              mon9: "",

            },
            "10월": {
              mon10: "",

            },
            "11월": {
              mon11: "",

            },
            "12월": {
              mon12: "",

            },
            "전체고장수": {
              totalcnt: "",

            },
            "전체고장수합": {
              allcnt: "",

            },
          },

        ];

      }




      // TAB02 차트 init
           function Tab02Chartinit() {
               barchart = new wijmo.chart.FlexChart('#chartTabB', {
                   header: '현장별고장내용',
                   legend: {
                       position: wijmo.chart.Position.Bottom
                   },
                   bindingX: 'contnm',
                   series: wseries_data,
                   selectionMode: wijmo.chart.SelectionMode.Point,
                   itemsSource: [0],
                   palette: ['#0288D1',
                       '#FFC107',
                       '#FF7043',
                       "#EF5350"]
               });
               //
               ani = new wijmo.chart.animation.ChartAnimation(barchart);
           }


    }


    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    //선택한 탭 체크
    function tabchk_rtn(arg){
      document.getElementById('tabvalue').value = arg;
    }
    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

    // tab01 검색
    document.getElementById("retrieveBtn").addEventListener("click",function(){

      var ls_tab = document.getElementById('tabvalue').value;
      let ls_frdate = document.getElementById('frdate').value;
      let ls_todate = document.getElementById('todate').value;
      /*let ls_actcdz = document.getElementById('actcdz').value;
      let ls_actnmz = document.getElementById('actnmz').value;
      */
     /* if(ls_actnmz == null || ls_actnmz.length == 0 || ls_actnmz == ""){
        ls_actcdz = "%";
        document.getElementById('actcdz').value = "";
      }

      if(ls_actcdz == null || ls_actcdz.length == 0 || ls_actcdz == ""){
        ls_actcdz = "%";
      }*/

      searchList_rtn(ls_tab, ls_frdate, ls_todate);
    })

    function searchList_rtn(arg1, arg2, arg3){
      switch(arg1){

        case 'A':
          $.ajax({
            url: '/app19/p001tab01',
            type:"POST",
            data: {
              "frdate"      : arg2,
              "todate"      : arg3 ,
             // "actcdz"      : arg4 ,

            },
            async:false,
            success:function(data){
              tabA_grid(data);
            },error:function(e){
              console.log("error");
              // alert(data.code);
              // alert(data.message);
            }
          }).done(function(fragment){

          })
          break;

        case 'B':
          if(barchart !== undefined){
            wijmo.Control.refreshAll(barchart);
          }
          barChartInit01(arg1, arg2, arg3)
          break;

        default:
          break;
      }


    }

    function tabA_grid(data){
      var wtab01Dto = data;
      var wtab01_data = [];
      var cnt = 1;
      for(var i=0; i<wtab01Dto.length; i++){
        wtab01_data.push({
          id: i,
          index: cnt,
          compyear: wtab01Dto[i]["compyear"],
          actnm: wtab01Dto[i]["actnm"],
          equpnm: wtab01Dto[i]["equpnm"],
          "1월" : {
            mon1: wtab01Dto[i]["mon1"]},
          "2월" : {
            mon2: wtab01Dto[i]["mon2"]},
          "3월" : {
            mon3: wtab01Dto[i]["mon3"]},
          "4월" : {
            mon4: wtab01Dto[i]["mon4"]},
          "5월" : {
            mon5: wtab01Dto[i]["mon5"]},
          "6월" : {
            mon6: wtab01Dto[i]["mon6"]},
          "7월" : {
            mon7: wtab01Dto[i]["mon7"]},
          "8월" : {
            mon8: wtab01Dto[i]["mon8"]},
          "9월" : {
            mon9: wtab01Dto[i]["mon9"]},
          "10월" : {
            mon10: wtab01Dto[i]["mon10"]},
          "11월" : {
            mon11: wtab01Dto[i]["mon11"]},
          "12월" : {
            mon12: wtab01Dto[i]["mon12"]},
          "전체고장수" : {
            totalcnt: wtab01Dto[i]["totalcnt"]},
          "전체고장수합" : {
            allcnt: wtab01Dto[i]["allcnt"]}
        });
        cnt++;
      }
      console.log("wtab01_data, check", )

      theGrid.columns.clear();
      theGrid.autoGenerateColumns = false;


      view_p01tab01page.sourceCollection = wtab01_data;


      let gridFormat =[
        {binding: "compyear", header: "년도", width: 100},
        {binding: "actnm", header: "현장명", width: 150},
        {binding: "equpnm", header: "동·호기", width: 100},

        {
          header: "1월",
          align: "center",
          columns: [

            { binding: "1월.mon1", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        },
        {
          header: "2월",
          align: "center",
          columns: [
            { binding: "2월.mon2", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        },
        {
          header: "3월",
          align: "center",
          columns: [
            { binding: "3월.mon3", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        },
        {
          header: "4월",
          align: "center",
          columns: [
            { binding: "4월.mon4", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        }
        ,
        {
          header: "5월",
          align: "center",
          columns: [
            { binding: "5월.mon5", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        },
        {
          header: "6월",
          align: "center",
          columns: [
            { binding: "6월.mon6", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        }
        ,
        {
          header: "7월",
          align: "center",
          columns: [
            { binding: "7월.mon7", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        }
        ,
        {
          header: "8월",
          align: "center",
          columns: [
            { binding: "8월.mon8", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        },
        {
          header: "9월",
          align: "center",
          columns: [
            { binding: "9월.mon9", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        },
        {
          header: "10월",
          align: "center",
          columns: [
            { binding: "10월.mon10", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        },
        {
          header: "11월",
          align: "center",
          columns: [
            { binding: "11월.mon11", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        },
        {
          header: "12월",
          align: "center",
          columns: [
            { binding: "12월.mon12", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        },
        {
          header: "전체고장수",
          align: "center",
          columns: [
            { binding: "전체고장수.totalcnt", align: "center", header: "처리", format: "a0", width: 80 },
          ]
        },
        {
          header: "전체고장수합",
          align: "center",
          columns: [
            { binding: "전체고장수합.allcnt", align: "center", header: "처리", format: "a0", width: 280 },
          ]
        }
      ]

      theGrid.columnGroups = gridFormat;
      theGrid.itemsSource = view_p01tab01page;
    }






    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    const barChartInit01 = (arg1, arg2, arg3) => {

      var tab02_data = getDataTabB(arg2, arg3);
      // // console.log(tab02_data);
      // // console.log(wseries_data);
      // barchart.series =  wseries_data;
      // barchart.itemsSource =  tab02_data;
      barchart = new wijmo.chart.FlexChart('#chartTabB', {
        header: '현장별고장내용',
        legend: {
          position: wijmo.chart.Position.Bottom
        },
        bindingX: 'equpnm',
        series: wseries_data,
        selectionMode: wijmo.chart.SelectionMode.Point,
        itemsSource: tab02_data,
        palette: ['#0288D1',
          '#FFC107',
          '#FF7043',
          "#EF5350"]
      });

      ani = new wijmo.chart.animation.ChartAnimation(barchart);
    }

    function getDataTabB(arg2, arg3) {
      /*if(arg4 == null || arg4.length == 0 || arg4 == "" || arg4 == "%"){
        alert("현장을 선택하세요")
        return
      }*/
      var wtab02_data = [];
      $.ajax({
        url: '/app19/p001tab02',
        type:"POST",
        data: {
          "frdate"      : arg2,
          "todate"      : arg3 ,
         // "actcdz"      : arg4

        },
        async:false,
        success:function(data){
          var wtab02Dto  = data;
          var cnt = 1;
          var ls_tmpchk;
          for (var i = 0; i < wtab02Dto.length; i++) {
            let yyyymm = wtab02Dto[i]["compdate"];
            wtab02_data.push({
              id: i,
              index: cnt,
              equpnm: wtab02Dto[i]["equpnm"],
              [yyyymm]: wtab02Dto[i]["cnt"],
              compdate: wtab02Dto[i]["compdate"],

            });
            if (ls_tmpchk !== yyyymm){
              wseries_data.push({
                binding: wtab02Dto[i]["compdate"],
                name: wtab02Dto[i]["compdate"]
              });
            }
            ls_tmpchk = yyyymm;
            cnt++;

          }
          return wtab02_data;
        },error:function(e){
          console.log("error");
          // alert(data.code);
          // alert(data.message);
        }

      }).done(function(fragment){

      })

      // wtab02_data ='[' + wtab02_data + ']';
      var ls_arr = []
      ls_arr = wtab02_data
      // console.log(ls_arr);
      // console.log(wseries_data);
      return ls_arr;

    };
    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  </script>



  <script>


    $(document).ready(function() {
      getToday()
      fn_egov_init_date()
      $('datetimepicker').datetimepicker({

      });

      $("#frdate").change(function(e){
        // console.log("달력클릭");
        // console.log(convert_time(e.timestamp));
      })
      $("#todate").change(function(e){
        // console.log("달력클릭");
        // console.log(convert_time(e.timestamp));
      })
    })
    function test_rtn(arg1){
      console.log(arg1);
      const disHtml = `
                <div class="tab-pane fade show active" id=${arg1} role="tabpanel" aria-labelledby="profile-tab">${arg1}</div>`
      $('#btnDiv02').before(disHtml);
    }


    function getToday(){
      let today = new Date();

      let year = today.getFullYear(); // 년도
      let month = today.getMonth() + 1;  // 월
      let date = today.getDate();  // 날짜
      let day = today.getDay();  // 요일
      if(month> 0 && month < 10) {month = "0" + month;}
      if(date > 0 && date < 10) {date = "0" + date};
      let ls_frday = year + '-' + month + '-01'
      let ls_today = year + '-' + month + '-' + date
      document.getElementById('frdate').value = ls_frday;
      document.getElementById('todate').value = ls_today;
    }



    function fn_egov_init_date(){
      var $frdate = $('#frdate');
      var $todate = $('#todate');
      $frdate.datetimepicker({
        timepicker: false,
        lang: 'ko',
        format: 'Y-m-d',
        scrollMonth: false,
        scrollInput: false,
        onShow: function (ct) {
          this.setOptions({
            // maxDate: $frdate.val() ? $frdate.val() : false
          })
        },
      });

      $todate.datetimepicker({
        timepicker: false,
        lang: 'ko',
        format: 'Y-m-d',    //'Y-m-d H:i',
        scrollMonth: false,
        scrollInput: false,
        onShow: function (ct) {
          this.setOptions({
            // minDate: $todate.val() ? $todate.val() : false
          })
        }
      });

    }


    class FlexGridContextMenu {
      constructor(grid) {
        let host = grid.hostElement, menu = this._buildMenu(grid);
        host.addEventListener('contextmenu', (e) => {
          // 클릭된 셀/열 선택
          let sel = grid.selection, ht = grid.hitTest(e), row = ht.getRow();

          switch (ht.panel) {
            case grid.cells:
              let colIndex = ht.col;
              // 만약 그룹 헤더이면, 그룹 열 선택
              if (row instanceof wijmo.grid.GroupRow && row.dataItem instanceof wijmo.collections.CollectionViewGroup) {
                let gd = row.dataItem.groupDescription;
                if (gd instanceof wijmo.collections.PropertyGroupDescription) {
                  let col = grid.getColumn(gd.propertyName);
                  if (col && col.index > -1) {
                    colIndex = col.index;
                  }
                }
              }
              grid.select(ht.row, colIndex);
              break;
            case grid.columnHeaders:
              grid.select(sel.row, ht.col);
              break;
            case grid.rowHeaders:
              grid.select(ht.row, sel.col);
              break;
            default:
              return; // 유효하지 않는 패널
          }
          // 현재 열에 대한 메뉴 표시
          if (grid.selection.col > -1) {
            e.preventDefault(); // 브라우저의 기본 메뉴 취소
            menu.show(e); // Wijmo 메뉴 표시
          }
        }, true);
      }
      _buildMenu(grid) {
        let menu = new wijmo.input.Menu(document.createElement('div'), {
          owner: grid.hostElement,
          displayMemberPath: 'header',
          subItemsPath: 'items',
          commandParameterPath: 'cmd',
          dropDownCssClass: 'ctx-menu',
          openOnHover: true,
          closeOnLeave: true,
          itemsSource: [
            {
              header: '정렬', items: [
                { header: 'Ascending', cmd: 'SRT_ASC' },
                { header: 'Descending', cmd: 'SRT_DESC' },
                { header: 'No Sort', cmd: 'SRT_NONE' },
                { header: '-' },
                { header: 'Clear All Sorts', cmd: 'SRT_CLR' }
              ]
            },
            { header: '-' },
            { header: 'Pin/Unpin', cmd: 'PIN' },
            { header: '-' },
            { header: 'AutoSize', cmd: 'ASZ' },
            { header: 'AutoSize All', cmd: 'ASZ_ALL' },
            { header: '-' },
            { header: 'Group/Ungroup', cmd: 'GRP' },
            { header: 'Clear All Groups', cmd: 'GRP_CLR' },
            { header: '-' },
            {
              header: '내려받기', items: [
                { header: 'CSV', cmd: 'X_CSV' },
                { header: 'XLSX', cmd: 'X_XLSX' },
                { header: 'PDF', cmd: 'X_PDF' },
              ]
            }
          ],
          command: {
            // 메뉴 명령 활성화/비활성화
            canExecuteCommand: (cmd) => {
              let view = grid.collectionView, col = grid.columns[grid.selection.col];
              switch (cmd) {
                case 'SRT_ASC':
                  return col.currentSort != '+';
                case 'SRT_DESC':
                  return col.currentSort != '-';
                case 'SRT_NONE':
                  return col.currentSort != null;
                case 'SRT_CLR':
                  return view.sortDescriptions.length > 0;
                case 'PIN':
                  return true; // toggle pin
                case 'ASZ':
                case 'ASZ_ALL':
                  return true;
                case 'GRP':
                  return col.dataType != wijmo.DataType.Number; // don't group numbers
                case 'GRP_CLR':
                  return view.groupDescriptions.length > 0;
              }
              return true;
            },
            // 메뉴 명령 실행
            executeCommand: (cmd) => {
              let view = grid.collectionView, cols = grid.columns, col = cols[grid.selection.col], sd = view.sortDescriptions, gd = view.groupDescriptions;
              switch (cmd) {
                case 'SRT_ASC':
                case 'SRT_DESC':
                case 'SRT_NONE':
                  if (grid.allowSorting != wijmo.grid.AllowSorting.MultiColumn) {
                    sd.clear();
                  }
                  else {
                    for (let i = 0; i < sd.length; i++) {
                      if (sd[i].property == col.binding) {
                        sd.removeAt(i);
                        break;
                      }
                    }
                  }
                  if (cmd != 'SRT_NONE') {
                    sd.push(new wijmo.collections.SortDescription(col.binding, cmd == 'SRT_ASC'));
                  }
                  break;
                case 'SRT_CLR':
                  sd.clear();
                  break;
                case 'PIN':
                  let fCols = grid.frozenColumns;
                  if (col.index >= fCols) { // pinning
                    cols.moveElement(col.index, fCols, false);
                    cols.frozen++;
                  }
                  else { // unpinning
                    cols.moveElement(col.index, fCols - 1, false);
                    cols.frozen--;
                  }
                  break;
                case 'ASZ':
                  grid.autoSizeColumn(col.index);
                  break;
                case 'ASZ_ALL':
                  grid.autoSizeColumns(0, grid.columns.length - 1);
                  break;
                case 'GRP':
                  // 그룹 삭제
                  for (let i = 0; i < gd.length; i++) {
                    if (gd[i].propertyName == col.binding) {
                      gd.removeAt(i);
                      return; // we're done
                    }
                  }
                  // 그룹 추가
                  gd.push(new wijmo.collections.PropertyGroupDescription(col.binding));
                  break;
                case 'GRP_CLR':
                  gd.clear();
                  break;
                      // 내보내기
                case 'X_CSV':
                  let rng = new wijmo.grid.CellRange(0, 0, grid.rows.length - 1, grid.columns.length - 1), csv = grid.getClipString(rng, wijmo.grid.ClipStringOptions.CSV, true, false);
                  wijmo.saveFile(csv, 'FlexGrid.csv');
                  break;
                case 'X_XLSX':
                  wijmo.grid.xlsx.FlexGridXlsxConverter.saveAsync(grid, null, 'FlexGrid.xlsx');
                  break;
                case 'X_PDF':
                  wijmo.grid.pdf.FlexGridPdfConverter.export(grid, 'FlexGrid.pdf', {
                    maxPages: 10,
                    scaleMode: wijmo.grid.pdf.ScaleMode.PageWidth,
                    documentOptions: {
                      compress: true,
                      header: { declarative: { text: '\t&[Page] of &[Pages]' } },
                      footer: { declarative: { text: '\t&[Page] of &[Pages]' } },
                      info: { author: 'GrapeCity', title: 'FlexGrid' }
                    },
                    styles: {
                      cellStyle: { backgroundColor: '#ffffff', borderColor: '#c6c6c6' },
                      altCellStyle: { backgroundColor: '#f9f9f9' },
                      groupCellStyle: { backgroundColor: '#dddddd' },
                      headerCellStyle: { backgroundColor: '#eaeaea' }
                    }
                  });
                  break;
              }
              // 활성화 그리드 셀에 포커스 복원
              grid.refresh();
              let sel = grid.selection, cell = grid.cells.getCellElement(sel.row, sel.col);
              if (cell) {
                cell.focus();
              }
            }
          }
        });
        // 완료
        return menu;
      }
    }
  </script>


  <!------footer ------>
  <footer th:replace="layouts/APPHeader/appfooter :: footerFragment"></footer>

  <!-- modal -->
  <!-- class="modal_step_open" modal_step="1" -->

  <div class="modal modal modal_step modal_step1 hidden">
    <div class="modal_overlay">
    </div>
    <div class="modal_content modal_sm scrollbar">
      <div class="layoutCont">
        <div class="modalContWrap">
          <!-- <div class="modal_close cancerButton">
            <img th:src="@{/assets/images/modal_close.png}" alt="모달 닫기버튼">
          </div>                       -->
          <div class="modal_head">
          </div>
          <div class="modal_con scrollbar">
            모든 정보를 입력하세요.
          </div>

        </div>
        <div class="modal_btn">
          <button class="cancerButton " type="button">확인</button>
        </div>
        <!-- <div class="modal_btn flex">
            <button class="cancerButton " type="button">확인</button>
            <button class="cancerButton " type="button">확인</button>
        </div> -->
      </div>
    </div>
  </div>

</body>
</html>