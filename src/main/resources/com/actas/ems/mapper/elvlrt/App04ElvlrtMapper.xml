<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- mapper >> interface 매핑 : id 값 중요 (interface 메소드) -->
<mapper namespace="com.actas.ems.Mapper.Elvlrt.App04ElvlrtMapper">
    <select id="GetMManulList"  parameterType="com.actas.ems.DTO.Elvlrt.App04ElvlrtDto" resultType="com.actas.ems.DTO.Elvlrt.App04ElvlrtDto">
        select mseq, minputdate, mgourpcd, msubject, mfilename, mpernm, memo, mflag, (select com_cnam from tb_ca510 where com_cls = '750' and com_code=mgourpcd) as cnam
        from tb_mmanual WITH (NOLOCK)
        Where 1 = 1
<!--        <if test="msubject != null">-->
<!--            and msubject like '%' + #{msubject} + '%'-->
<!--        </if>-->
<!--        <if test="memo != null">-->
<!--            and memo like '%' + #{memo} + '%'-->
<!--        </if>-->
    </select>

    <select id="GetMManulBlankList"  resultType="com.actas.ems.DTO.Elvlrt.App04ElvlrtDto">
        select '' as mseq, '' as minputdate, '' as mgourpcd, '' as msubject, '' as mfilename, '' as mpernm, '' as memo, '' as mflag
        from dual
        <!--        <if test="msubject != null">-->
        <!--            and msubject like '%' + #{msubject} + '%'-->
        <!--        </if>-->
        <!--        <if test="memo != null">-->
        <!--            and memo like '%' + #{memo} + '%'-->
        <!--        </if>-->
    </select>
    <select id="getMManualMaxSeq"  parameterType="string" resultType="java.lang.String">
        select max(mseq) from tb_mmanual  where Left(mseq,6) = #{mseq}
    </select>


    <select id="GetMManulView" parameterType="com.actas.ems.DTO.Elvlrt.App04ElvlrtDto"  resultType="com.actas.ems.DTO.Elvlrt.App04ElvlrtDto">
        select mseq, minputdate, mgourpcd, msubject, mfilename, mpernm, memo, mflag
        from tb_mmanual where mseq = #{mseq}
    </select>

    <insert id="InsertMManul" parameterType="com.actas.ems.DTO.Elvlrt.App04ElvlrtDto">
        insert into tb_mmanual (custcd, spjangcd, mseq, minputdate, mgourpcd, msubject, memo, mpernm, mflag) values (#{custcd}, #{spjangcd}, #{mseq}, #{minputdate}, #{mgourpcd}, #{msubject}, #{memo}, #{mpernm}, #{mflag})
    </insert>

    <update id="UpdateMManul" parameterType="com.actas.ems.DTO.Elvlrt.App04ElvlrtDto">
        update tb_mmanual set
        mgourpcd = #{mgourpcd}
        <if test="msubject != null ">,</if>
        <if test="msubject != null">msubject=#{msubject}</if>
        <if test="mfilename != null ">,</if>
        <if test="mfilename != null">mfilename=#{mfilename}</if>
        <if test="memo != null ">,</if>
        <if test="memo != null">memo=#{memo}</if>
        <if test="minputdate != null ">,</if>
        <if test="minputdate != null">minputdate=#{minputdate}</if>
        <if test="mpernm != null ">,</if>
        <if test="mpernm != null">mpernm=#{mpernm}</if>
        <if test="mflag != null ">,</if>
        <if test="mflag != null">mflag=#{mflag}</if>
        where mseq = #{mseq}
    </update>


    <delete id="DeleteMManul" parameterType="com.actas.ems.DTO.Elvlrt.App04ElvlrtDto">
        delete from tb_mmanual where mseq = #{mseq}
    </delete>


    <select id="GetComm750List"  resultType="com.actas.ems.DTO.CommonDto">
        <![CDATA[
            SELECT  com_code AS code, com_cnam AS cnam
            FROM     dbo.tb_ca510 WITH (NOLOCK)
            WHERE  (com_cls = '750') AND (com_code <> '00')
         ]]>
    </select>
    <select id="GetComm750BlankList"  resultType="com.actas.ems.DTO.CommonDto">
        <![CDATA[
        SELECT  '' AS code, '' AS cnam
        FROM     dual
        ]]>
    </select>

</mapper>
