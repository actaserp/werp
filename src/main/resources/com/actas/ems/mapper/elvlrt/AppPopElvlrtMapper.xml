<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- mapper >> interface 매핑 : id 값 중요 (interface 메소드) -->
<mapper namespace="com.actas.ems.Mapper.Elvlrt.AppPopElvlrtMapper">
    <select id="GetActnmList"   parameterType="com.actas.ems.DTO.Popup.PopupDto"  resultType="com.actas.ems.DTO.Popup.PopupDto">
        <![CDATA[
        SELECT a.actcd    actcd  ,
               a.actnm    actnm,
               a.actpernm actpernm,
               a.tel      telno,
               a.hp       hpno,
             isnull(a.address,'') + ' ' + isnull(a.address2, '')  addr,
             cltnm  as cltnm
           FROM TB_E601 a WITH(NOLOCK)
           LEFT OUTER JOIN (SELECT distinct a.custcd, a.spjangcd, a.actcd, a.contg, dbo.df_nm_rtn('tb_xclient', a.custcd, a.cltcd, '', '') AS cltnm 
                                      FROM tb_e101 a WITH(NOLOCK), (select custcd, spjangcd, actcd, max(contdate) as contdate from tb_e101 WITH(NOLOCK)
                                      group by custcd, spjangcd, actcd) b 
                                   WHERE a.custcd = b.custcd AND a.spjangcd = b.spjangcd AND a.actcd = b.actcd AND a.contdate = b.contdate) b
             ON (a.custcd = b.custcd AND a.spjangcd = b.spjangcd AND a.actcd = b.actcd)
            WHERE 1 = 1
            AND (   isnull(actnm , '') Like concat('%',#{actnm},'%') )
            AND  isnull(b.contg, '01') <> '04'

         ]]>
    </select>

    <!-- 고장내용 -->
    <select id="GetContnmList"   parameterType="com.actas.ems.DTO.Popup.PopupDto"  resultType="com.actas.ems.DTO.Popup.PopupDto">
        <![CDATA[
        SELECT a.contcd    contcd  ,
               a.contnm    contnm
        FROM TB_E010 a WITH(NOLOCK)
        WHERE 1 = 1
          AND (   isnull(contnm , '') Like concat('%',#{contnm},'%') )
          AND A.useyn = '1'
        ]]>
    </select>

    <!-- 고장요인 -->
    <select id="GetRemonmList" parameterType="com.actas.ems.DTO.Popup.PopupDto" resultType="com.actas.ems.DTO.Popup.PopupDto">
        <![CDATA[
        SELECT a.remocd    remocd  ,
               a.remonm    remonm
        FROM TB_E011 a WITH(NOLOCK)
        WHERE 1 = 1
          AND (   isnull(remonm , '') Like concat('%',#{remonm},'%') )
          AND A.useyn = '1'
        ]]>
    </select>

    <!-- 고장원인 -->
    <select id="GetFacnmList" parameterType="com.actas.ems.DTO.Popup.PopupDto" resultType="com.actas.ems.DTO.Popup.PopupDto">
        <![CDATA[
        SELECT a.faccd    faccd  ,
               a.facnm    facnm
        FROM TB_E019 a WITH(NOLOCK)
        WHERE 1 = 1
          AND (   isnull(facnm , '') Like concat('%',#{facnm},'%') )
          AND A.useyn = '1'
        ]]>
    </select>

    <!-- 처리내용 -->
    <select id="GetResunmList" parameterType="com.actas.ems.DTO.Popup.PopupDto" resultType="com.actas.ems.DTO.Popup.PopupDto">
        <![CDATA[
        SELECT a.resucd    resucd  ,
               a.resunm    resunm
        FROM TB_E012 a WITH(NOLOCK)
        WHERE 1 = 1
          AND (   isnull(resunm , '') Like concat('%',#{resunm},'%') )
          AND A.useyn = '1'
        ]]>
    </select>

    <!-- 고장부위 -->
    <select id="GetGreginmList" parameterType="com.actas.ems.DTO.Popup.PopupDto" resultType="com.actas.ems.DTO.Popup.PopupDto">
        <![CDATA[
        SELECT a.gregicd    gregicd  ,
               a.greginm    greginm
        FROM TB_E013 a WITH(NOLOCK)
        WHERE 1 = 1
          AND (   isnull(greginm , '') Like concat('%',#{greginm},'%') )
          AND A.useyn = '1'
        ]]>
    </select>

    <!-- 처리방법 -->
    <select id="GetResultnmList" parameterType="com.actas.ems.DTO.Popup.PopupDto" resultType="com.actas.ems.DTO.Popup.PopupDto">
        <![CDATA[
        SELECT a.resultcd    resultcd  ,
               a.resultnm    resultnm
        FROM TB_E015 a WITH(NOLOCK)
        WHERE 1 = 1
          AND (   isnull(resultnm , '') Like concat('%',#{resultnm},'%') )
          AND A.useyn = '1'
        ]]>
    </select>

    <!-- 담당부서 -->
    <select id="GetDivinmList" parameterType="com.actas.ems.DTO.Popup.PopupDto" resultType="com.actas.ems.DTO.Popup.PopupDto">
        <![CDATA[
        SELECT a.divicd    divicd  ,
               a.divinm    divinm
        FROM TB_JC002 a WITH(NOLOCK)
        WHERE 1 = 1
          AND (   isnull(divinm , '') Like concat('%',#{divinm},'%') )
          AND A.useyn = '1'
        ]]>
    </select>

    <!-- 담당자 -->
    <select id="GetPernmList" parameterType="com.actas.ems.DTO.Popup.PopupDto" resultType="com.actas.ems.DTO.Popup.PopupDto">
        <![CDATA[
        SELECT a.perid    perid  ,
               a.pernm    pernm
        FROM TB_JA001 a WITH(NOLOCK)
        WHERE 1 = 1
          AND (   isnull(pernm , '') Like concat('%',#{pernm},'%') )
        ]]>
    </select>

    <!-- 담당자2 -->
    <select id="GetPernm2List" parameterType="com.actas.ems.DTO.Popup.PopupDto" resultType="com.actas.ems.DTO.Popup.PopupDto">
        <![CDATA[
        SELECT a.actperid    actperid  ,
               a.actpernm    actpernm
        FROM TB_E601 a WITH(NOLOCK)
        WHERE 1 = 1
          AND (   isnull(actpernm , '') Like concat('%',#{actpernm},'%') )
        ]]>
    </select>
</mapper>
